<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="庄亮亮、吴温慧">

<title>退化过程模型综述</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#介绍" id="toc-介绍" class="nav-link active" data-scroll-target="#介绍">1. 介绍</a></li>
  <li><a href="#退化轨道模型" id="toc-退化轨道模型" class="nav-link" data-scroll-target="#退化轨道模型">2. 退化轨道模型</a></li>
  <li><a href="#wiener-退化过程模型" id="toc-wiener-退化过程模型" class="nav-link" data-scroll-target="#wiener-退化过程模型">3. Wiener 退化过程模型</a>
  <ul>
  <li><a href="#带漂移的-wiener-过程" id="toc-带漂移的-wiener-过程" class="nav-link" data-scroll-target="#带漂移的-wiener-过程">3.1 带漂移的 Wiener 过程</a>
  <ul>
  <li><a href="#数据模拟产生" id="toc-数据模拟产生" class="nav-link" data-scroll-target="#数据模拟产生">3.1.1 数据模拟产生</a></li>
  <li><a href="#统计推断" id="toc-统计推断" class="nav-link" data-scroll-target="#统计推断">3.1.2 统计推断</a>
  <ul class="collapse">
  <li><a href="#极大似然估计" id="toc-极大似然估计" class="nav-link" data-scroll-target="#极大似然估计">3.1.2.1 极大似然估计</a></li>
  <li><a href="#客观贝叶斯分析" id="toc-客观贝叶斯分析" class="nav-link" data-scroll-target="#客观贝叶斯分析">3.1.2.2 客观贝叶斯分析</a></li>
  <li><a href="#广义推断方法" id="toc-广义推断方法" class="nav-link" data-scroll-target="#广义推断方法">3.1.2.3 广义推断方法</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#多应力和动态环境情形" id="toc-多应力和动态环境情形" class="nav-link" data-scroll-target="#多应力和动态环境情形">3.2 多应力和动态环境情形</a></li>
  <li><a href="#含随机效应情形" id="toc-含随机效应情形" class="nav-link" data-scroll-target="#含随机效应情形">3.3 含随机效应情形</a></li>
  <li><a href="#有测量误差情形" id="toc-有测量误差情形" class="nav-link" data-scroll-target="#有测量误差情形">3.4 有测量误差情形</a></li>
  <li><a href="#案例分析" id="toc-案例分析" class="nav-link" data-scroll-target="#案例分析">3.3 案例分析</a>
  <ul>
  <li><a href="#nasa-锂电池数据" id="toc-nasa-锂电池数据" class="nav-link" data-scroll-target="#nasa-锂电池数据">3.3.1 NASA 锂电池数据</a></li>
  <li><a href="#激光器件-laser-数据集" id="toc-激光器件-laser-数据集" class="nav-link" data-scroll-target="#激光器件-laser-数据集">3.3.2 激光器件 Laser 数据集</a></li>
  <li><a href="#炭膜电阻器-carbon-film-resistors" id="toc-炭膜电阻器-carbon-film-resistors" class="nav-link" data-scroll-target="#炭膜电阻器-carbon-film-resistors">3.3.3 炭膜电阻器 carbon-film resistors</a></li>
  <li><a href="#惯导平台-interial-navigition-数据" id="toc-惯导平台-interial-navigition-数据" class="nav-link" data-scroll-target="#惯导平台-interial-navigition-数据">3.3.4 惯导平台 interial navigition 数据</a></li>
  <li><a href="#铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" id="toc-铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" class="nav-link" data-scroll-target="#铝合金疲劳裂纹长度-2017-t4-aluminum-alloy">3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#gamma退化过程模型" id="toc-gamma退化过程模型" class="nav-link" data-scroll-target="#gamma退化过程模型">4. Gamma退化过程模型</a>
  <ul>
  <li><a href="#经典-gamma-过程" id="toc-经典-gamma-过程" class="nav-link" data-scroll-target="#经典-gamma-过程">4.1 经典 Gamma 过程</a>
  <ul>
  <li><a href="#似然函数" id="toc-似然函数" class="nav-link" data-scroll-target="#似然函数">似然函数</a></li>
  <li><a href="#产品寿命" id="toc-产品寿命" class="nav-link" data-scroll-target="#产品寿命">产品寿命</a></li>
  <li><a href="#剩余寿命" id="toc-剩余寿命" class="nav-link" data-scroll-target="#剩余寿命">剩余寿命</a></li>
  <li><a href="#数据模拟产生-1" id="toc-数据模拟产生-1" class="nav-link" data-scroll-target="#数据模拟产生-1">数据模拟产生</a>
  <ul class="collapse">
  <li><a href="#绘制退化路径图" id="toc-绘制退化路径图" class="nav-link" data-scroll-target="#绘制退化路径图">绘制退化路径图</a></li>
  </ul></li>
  <li><a href="#参数估计" id="toc-参数估计" class="nav-link" data-scroll-target="#参数估计">参数估计</a>
  <ul class="collapse">
  <li><a href="#矩估计" id="toc-矩估计" class="nav-link" data-scroll-target="#矩估计">矩估计</a></li>
  <li><a href="#极大似然估计-1" id="toc-极大似然估计-1" class="nav-link" data-scroll-target="#极大似然估计-1">极大似然估计</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#案例分析-1" id="toc-案例分析-1" class="nav-link" data-scroll-target="#案例分析-1">4.2 案例分析</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">退化过程模型综述</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>庄亮亮、吴温慧 </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="介绍" class="level2">
<h2 class="anchored" data-anchor-id="介绍">1. 介绍</h2>
<p>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在<strong>基于退化的可靠性模型</strong>方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</p>
<ol type="1">
<li><p>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</p></li>
<li><p>基于 Wiener 过程的模型</p></li>
<li><p>基于 Gamma 过程的模型</p></li>
<li><p>累积损伤模型(主要是基于混合 Poisson 过程的模型）</p></li>
<li><p>更为一般的纯跳过程模型（如Levy.过程模利）和扩散过程模型（如随机微分方程模型）等。</p></li>
</ol>
<p>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究<strong>矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法</strong>，以及<strong>非参数和半参数方法</strong>等，解决模型辨识和修正问题;</p>
<p>采用<strong>似然比检验、Bayes 因子分析</strong>等方法进行模型验证;</p>
<p>采用<strong>均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)</strong>等进行模型优良性检验。</p>
<p>在基于退化的可靠性技术应用方面，针对<strong>机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）</strong>等的退化失效过程，开展<strong>退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计</strong>：特别是加速退化试验方案设计的研究。</p>
</section>
<section id="退化轨道模型" class="level2">
<h2 class="anchored" data-anchor-id="退化轨道模型">2. 退化轨道模型</h2>
<blockquote class="blockquote">
<p>暂时不考虑</p>
</blockquote>
</section>
<section id="wiener-退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="wiener-退化过程模型">3. Wiener 退化过程模型</h2>
<p>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中 应用最为广泛的一种模型。</p>
<p>Wiener 退化过程的<strong>首达时间分布具有解析形式</strong>，便于对<strong>产品寿命</strong>和<strong>可靠度</strong>的分析和计算。</p>
<p>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</p>
<p>通过对经典 Wiener 过程的参数引入<strong>随机性</strong>，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</p>
<blockquote class="blockquote">
<p>对 Wiener 退化过程及其观测过程所构成的<strong>状态空间模型</strong>，可以采用 <strong>Kalman 滤波技术</strong>进行处理，为产品<strong>在线寿命预测、视情维修决策</strong>等提供了可行的算法和实现途径。</p>
</blockquote>
<section id="带漂移的-wiener-过程" class="level3">
<h3 class="anchored" data-anchor-id="带漂移的-wiener-过程">3.1 带漂移的 Wiener 过程</h3>
<p>称 <span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 是漂移参数为 <span class="math inline">\(\mu\)</span> 、扩散参数为 <span class="math inline">\(\sigma\)</span> 的 (一元) Wiener 过程, 若</p>
<ol type="1">
<li><p><span class="math inline">\(X(0)=0\)</span>。</p></li>
<li><p><span class="math inline">\(\{X(t), t \geqslant 0\}\)</span> 有平稳独立增量。</p></li>
<li><p><span class="math inline">\(X(t)\)</span> 服从均值为 <span class="math inline">\(\mu t\)</span>,方差为 <span class="math inline">\(\sigma^2 t\)</span> 的正态分布。</p></li>
</ol>
<p>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: <span class="math display">\[
X(t)=\mu t+\sigma B(t)
\]</span> 式中: <span class="math inline">\(\{B(t)\}, t \geqslant 0\)</span> 是标准 Wiener 过程或标准布朗运动过程。</p>
<p>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</p>
<p>（1）时刻 <span class="math inline">\(t \sim t+\Delta t\)</span> 之间的增量服从正态分布, 即 <span class="math inline">\(\Delta X=X(t+\Delta t)-X(t) \sim\)</span> <span class="math inline">\(N\left(\mu \Delta t, \sigma^2 \Delta t\right)\)</span> 。</p>
<ol start="2" type="1">
<li>对任意两个不相交的时间区间 <span class="math inline">\(\left[t_1, t_2\right],\left[t_3, t_4\right], t_1&lt;t_2 \leqslant t_3&lt;t_4\)</span>, 增量 <span class="math inline">\(X\left(t_4\right)-X\)</span> <span class="math inline">\(\left(t_3\right)\)</span> 与 <span class="math inline">\(X\left(t_2\right)-X\left(t_1\right)\)</span> 相互独立。</li>
</ol>
<p>如果产品的性能退化过程是一元 Wiener 过程,假设其运行到时刻 <span class="math inline">\(\tau\)</span> 仍末失效, 且 当前性能退化量为 <span class="math inline">\(x_\tau\left(x_\tau&lt;l\right)\)</span>, 则产品的剩余寿命 <span class="math inline">\(T_1\)</span> 可以表示为 <span class="math display">\[
T_1=\inf \left\{t \mid X(t+\tau) \geqslant l, X(\tau)=x_\tau, t \geqslant 0\right\}
\]</span> 由一元 Wiener 过程的独立增量性质和齐次马尔可夫性得到 <span class="math display">\[
\begin{aligned}
T_1 &amp;=\inf \left\{t \mid X(t+\tau)-X(\tau) \geqslant l-x_\tau, t \geqslant 0\right\} \\
&amp;=\inf \left\{t \mid X(t) \geqslant l-x_\tau, t \geqslant 0\right\}
\end{aligned}
\]</span> 可知剩余寿命 <span class="math inline">\(T_1\)</span> 也是逆 Gaussian 分布, 其密度函数只需将寿命 <span class="math inline">\(T\)</span> 密度函数中的失效阈值 <span class="math inline">\(l\)</span> 替换为 <span class="math inline">\(l-x_\tau\)</span>, 即 <span class="math display">\[f_{T_1}(t)=\frac{l-x_\tau}{\sqrt{2 \pi \sigma^2 t^3}} \exp \left[-\frac{\left(l-x_\tau-\mu t\right)^2}{2 \sigma^2 t}\right]\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="数据模拟产生" class="level4">
<h4 class="anchored" data-anchor-id="数据模拟产生">3.1.1 数据模拟产生</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)){</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="co"># para 指 mu,sigma</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb2-6"><a href="#cb2-6"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb2-7"><a href="#cb2-7"></a>  dat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb2-9"><a href="#cb2-9"></a>  dat_unit <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) dat_unit[j] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],<span class="fu">sqrt</span>(para[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_t[j]))</span>
<span id="cb2-12"><a href="#cb2-12"></a>    dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit)</span>
<span id="cb2-13"><a href="#cb2-13"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb2-15"><a href="#cb2-15"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb2-17"><a href="#cb2-17"></a>  <span class="fu">return</span>(dat1)</span>
<span id="cb2-18"><a href="#cb2-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>绘制退化路径图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="co"># 画图</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb3-5"><a href="#cb3-5"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb3-6"><a href="#cb3-6"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="fu">print</span>(p)</span>
<span id="cb3-14"><a href="#cb3-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb4-5"><a href="#cb4-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.9583703</td>
<td style="text-align: right;">2.706040</td>
<td style="text-align: right;">0.329122</td>
<td style="text-align: right;">0.1572964</td>
<td style="text-align: right;">2.178160</td>
<td style="text-align: right;">2.156934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.9129362</td>
<td style="text-align: right;">2.592465</td>
<td style="text-align: right;">1.885501</td>
<td style="text-align: right;">3.1099588</td>
<td style="text-align: right;">3.333849</td>
<td style="text-align: right;">3.715312</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3.5392579</td>
<td style="text-align: right;">3.689936</td>
<td style="text-align: right;">4.662535</td>
<td style="text-align: right;">4.3716365</td>
<td style="text-align: right;">5.214665</td>
<td style="text-align: right;">5.217226</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.9101119</td>
<td style="text-align: right;">5.256569</td>
<td style="text-align: right;">6.040563</td>
<td style="text-align: right;">5.0362169</td>
<td style="text-align: right;">4.845640</td>
<td style="text-align: right;">6.640881</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4.8175023</td>
<td style="text-align: right;">5.892682</td>
<td style="text-align: right;">6.787183</td>
<td style="text-align: right;">5.0891286</td>
<td style="text-align: right;">5.807875</td>
<td style="text-align: right;">8.834916</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">plot_path</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="统计推断" class="level4">
<h4 class="anchored" data-anchor-id="统计推断">3.1.2 统计推断</h4>
<p>假设共有 <span class="math inline">\(n\)</span> 个样品进行性能退化试验。样品 <span class="math inline">\(i\)</span> 初始时刻 <span class="math inline">\(t_{i 0}\)</span> 退化量取值为 <span class="math inline">\(X_{i 0}=0\)</span>, 在 时刻 <span class="math inline">\(t_{i 1}, \cdots, t_{i m_i}\)</span> 样品 <span class="math inline">\(i\)</span> 退化量为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span> 。记 <span class="math inline">\(\Delta X_{i j}=X_{i j}-X_{i, j-1}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{i, j-1} \sim t_{i j}\)</span> 之间的退化增量, <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span> 为各样品的测量间隔。</p>
<section id="极大似然估计" class="level5">
<h5 class="anchored" data-anchor-id="极大似然估计">3.1.2.1 极大似然估计</h5>
<p>在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。由 Wiener 过程的性质, 容易知道 <span class="math display">\[
\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)
\]</span></p>
<p>于是由退化数据 <span class="math inline">\(X_{i j}=x_{i j}\)</span> (等价的, <span class="math inline">\(\Delta X_{i j}=\Delta x_{i j}\)</span> ) <span class="math inline">\(, j=1,2, \cdots, m_i, i=1,2, \cdots, n\)</span>, 得到模型参数的似然函数为 <span class="math display">\[
L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left[-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right]
\]</span> 由式可以直接求得漂移参数 <span class="math inline">\(\mu\)</span> 和扩散参数 <span class="math inline">\(\sigma^2\)</span> 的极大似然估计如下: <span class="math display">\[
\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left[\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right]
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb6-4"><a href="#cb6-4"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb6-6"><a href="#cb6-6"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb6-7"><a href="#cb6-7"></a>  }</span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">return</span>(re)</span>
<span id="cb6-9"><a href="#cb6-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb7-5"><a href="#cb7-5"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb7-8"><a href="#cb7-8"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb7-14"><a href="#cb7-14"></a>}</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb7-17"><a href="#cb7-17"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># mle_re</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co"># 区间估计</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb7-22"><a href="#cb7-22"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb7-25"><a href="#cb7-25"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">low</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">up</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.955</td>
<td style="text-align: right;">1.011</td>
<td style="text-align: right;">1.068</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.953</td>
<td style="text-align: right;">0.993</td>
<td style="text-align: right;">1.033</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>为了得到产品可靠度的估计, 只要将 <span class="math inline">\(\hat{\mu} 、 \hat{\sigma}^2\)</span> 代人任务时间 <span class="math inline">\(t\)</span> 的可靠度的表达式, 即 可得到可靠度的点估计为 <span class="math display">\[
R(t)=1-F(t ; \hat{\mu}, \hat{\sigma})=\Phi\left(\frac{l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)-\exp \left(\frac{2 \hat{\mu} l}{\hat{\sigma}^2}\right) \Phi\left(\frac{-l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="do">## 可靠度计算</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb8-3"><a href="#cb8-3"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>par[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">return</span>(R)</span>
<span id="cb8-5"><a href="#cb8-5"></a>}</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># 给个简单例子</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="do">## [1] 0.9999996</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co"># 绘制带区间估计的可靠度函数（需要优化为 ggplot 绘制）</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="fu">plot</span>(<span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">ylab =</span> <span class="st">'Reliability'</span>,<span class="at">xlab =</span> <span class="st">"time"</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="fu">lines</span>(<span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up))</span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="fu">lines</span>(<span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>为什么 mle_up 绘制出来的结果这么奇怪？</p>
</blockquote>
</section>
<section id="客观贝叶斯分析" class="level5">
<h5 class="anchored" data-anchor-id="客观贝叶斯分析">3.1.2.2 客观贝叶斯分析</h5>
<p>来源于：He, L., et al.&nbsp;(2016). “Objective Bayesian analysis of degradation model with respect to a Wiener process.” Journal of Systems Science and Complexity 29(6): 1737-1751.</p>
<section id="先验确定" class="level6">
<h6 class="anchored" data-anchor-id="先验确定">先验确定</h6>
<p>The Fisher information matrix of the parameter <span class="math inline">\(\theta = (\mu,\sigma^2_\mu,\sigma^2_\omega)\)</span> is given by <span class="math display">\[
H(\theta)=\left(\begin{array}{ccc}
\frac{n t_m}{\frac{\sigma_\omega^2+m_m}{} \sigma_\mu^2} &amp; 0 &amp; 0 \\
0 &amp; \frac{n t_m^2}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2} &amp; \frac{n t_m}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2} \\
0 &amp; \frac{n t_m}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2} &amp; \frac{n(m-1)}{2 \sigma_\omega^4}+\frac{n}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2}
\end{array}\right).\]</span></p>
<p><strong>The Jeffreys prior</strong> for <span class="math inline">\(\theta\)</span> is given by <span class="math display">\[\pi_J(\theta) \propto \sigma_\omega^{-2}\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^{-\frac{3}{2}}.\]</span></p>
<p><strong>The reference priors</strong> in Table 1 can be rewritten in the unified form <span class="math display">\[\pi_{R_1}(\theta) \propto \sigma_\omega^{-p}\left(t_m \sigma_\mu^2+\sigma_\omega^2\right)^{-q}\]</span> or <span class="math display">\[\pi_{R_2}(\theta) \propto \sigma_\omega^{-r}\left(\frac{\sigma_\mu^2}{\sigma_\omega^2}\right)^{-t}\left(1+\frac{t_m \sigma_\mu^2}{\sigma_\omega^2}\right)^{-\frac{s}{2}} \psi\left(\frac{\sigma_\mu^2}{\sigma_\omega^2}\right)\]</span> for certain constants <span class="math inline">\(p, q, r\)</span> and <span class="math inline">\(t\)</span>, and <span class="math inline">\(s\)</span> is either 0 or 1.</p>
<p><img src="images/paste-344BAEA9.png" class="img-fluid"></p>
</section>
<section id="后验计算" class="level6">
<h6 class="anchored" data-anchor-id="后验计算">后验计算</h6>
<ol type="1">
<li>Under the priors <span class="math inline">\(\pi_{R_1}(\theta)\)</span></li>
</ol>
<p>the joint posterior densities of <span class="math inline">\(\left(\mu, \sigma_\mu^2, \sigma_\omega^2\right)\)</span> are given by <span class="math display">\[
\begin{aligned}
\pi_{R_1}\left(\mu, \sigma_\mu^2, \sigma_\omega^2 \mid y\right) \propto &amp;\left(\sigma_\omega^2\right)^{-\frac{m n-n+p}{2}}\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^{-\frac{n+2 q}{2}} \\
&amp; \cdot \exp \left\{-\frac{1}{2}\left[\frac{a}{\sigma_\omega^2}+\frac{b}{\sigma_\omega^2+t_m \sigma_\mu^2}+x^{\prime} \Lambda^{-1} x(\mu-\widehat{\mu})^2\right]\right\}
\end{aligned}
\]</span> where <span class="math display">\[
\begin{aligned}
&amp;a=\operatorname{tr}\left(Y^{\prime} \Psi^{-1} Y\right)-\frac{1}{t_m} \tau^{\prime} \Psi^{-1} Y Y^{\prime} \Psi^{-1} \tau \\
&amp;b=\frac{1}{t_m} \tau^{\prime} \Psi^{-1} Y Y^{\prime} \Psi^{-1} \tau-\frac{1}{n t_m} \tau^{\prime} \Psi^{-1} Y 1_n 1_n^{\prime} Y^{\prime} \Psi^{-1} \tau
\end{aligned}
\]</span></p>
<blockquote class="blockquote">
<p>Theorem 1 the priors <span class="math inline">\(\pi_{R1}(\theta)\)</span>, the posterior distributions <span class="math inline">\(\pi_{R_1}(\mu,\sigma^2_\mu, \sigma_\omegaω ^2|y)\)</span> are proper when <span class="math inline">\(m, n &gt; 1\)</span>.</p>
</blockquote>
<hr>
<ol start="2" type="1">
<li>Under the priors <span class="math inline">\(\pi_{R_2}(\theta)\)</span></li>
</ol>
<p>Denote <span class="math inline">\(\eta=\frac{\sigma_\mu^2}{\sigma_\omega^2}\)</span>, then the joint posterior density of <span class="math inline">\(\left(\mu, \sigma_\omega^2, \eta\right)\)</span> under the priors <span class="math inline">\(\pi_{R_2}(\theta)\)</span> can be written as <span class="math display">\[
\begin{aligned}
\pi_{R_2}\left(\mu, \sigma_\omega^2, \eta \mid y\right) \propto &amp;\left(\sigma_\omega^2\right)^{-\frac{m n+r-2}{2}} \eta^{-t}\left(1+\eta t_m\right)^{-\frac{n+s}{2}} \psi(\eta) \\
&amp; \cdot \exp \left\{-\frac{1}{2}\left[\frac{1}{\sigma_\omega^2}\left(a+\frac{b}{1+\eta t_m}\right)+x^{\prime} \Lambda^{-1} x(\mu-\widehat{\mu})^2\right]\right\} .
\end{aligned}
\]</span></p>
<blockquote class="blockquote">
<p>Theorem 2: when <span class="math inline">\(n&gt;3\)</span>, then the posterior distributions <span class="math inline">\(\pi_{R_2}\left(\mu, \sigma_\omega^2\right.\)</span>, <span class="math inline">\(\eta \mid y)\)</span> are proper.</p>
</blockquote>
<ol start="3" type="1">
<li>Under the priors <span class="math inline">\(\pi_{J}(\theta)\)</span></li>
</ol>
<blockquote class="blockquote">
<p>Corollary 3 For the model (1), under the Jefferys prior <span class="math inline">\(\pi_J(\theta)\)</span>, the posterior distribution is proper.</p>
</blockquote>
<ul>
<li>后验分布抽样</li>
</ul>
<ol type="1">
<li><span class="math inline">\(\pi_{R_1}(\theta)\)</span> 后验分布抽样</li>
</ol>
<p>A Monte Carlo (MC) simulation algorithm is employed to generate the samples from the joint posterior distribution. However, only the marginal density of <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span> can be written in analytic form, where <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span> are defined in (A.4). So a two-step rejection sampling procedure in [18] is used here, which is a straightforward strategy to generate samples for parameters <span class="math inline">\(\sigma_\mu^2\)</span> and <span class="math inline">\(\sigma_\omega^2\)</span>. The algorithm is summarized as follows:</p>
<p><strong>Step 1</strong>: Generate values of <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span> from two inverse gamma distributions, which are <span class="math display">\[
\begin{aligned}
&amp;{[\delta \mid y] \sim I G\left(\frac{m n-n+p-2}{2}, \frac{a}{2}\right)} \\
&amp;{[\gamma \mid y] \sim I G\left(\frac{n+2 q-3}{2}, \frac{b}{2}\right)}
\end{aligned}
\]</span></p>
<p><strong>Step 2</strong>: Retain those sets of values that obey the restricted parameter space of <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span>.</p>
<p><strong>Step 3</strong>: Generate a value of <span class="math inline">\(\mu\)</span> from the normal distribution <span class="math inline">\(N\left(\widehat{\mu}, \frac{\sigma_\omega^2+t_m \sigma_\mu^2}{n t_m}\right)\)</span> by using the values <span class="math inline">\(\sigma_\mu^2\)</span> and <span class="math inline">\(\sigma_\omega^2\)</span> obtained, where <span class="math inline">\(\widehat{\mu}\)</span> is defined in (5).</p>
<ul>
<li><span class="math inline">\(\pi_{R_2}(\theta)\)</span> 后验分布抽样</li>
</ul>
<p>It’s quite obvious that the conditional distributions for the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma_\omega^2\)</span> is easily simulated, since they are normal distribution and inverse-Gamma distribution respectively. However, due to the complexity of the conditional distribution of the parameter <span class="math inline">\(\eta\)</span>, we suggest taking the Metropolis-Hasting <span class="math inline">\({ }^{[19]}\)</span> sampling scheme for <span class="math inline">\(\eta\)</span>. The sampling process is as follows:</p>
<p><strong>Step 1</strong>: Under <span class="math inline">\(\pi_{R_2}\)</span>, the marginal posterior distribution of <span class="math inline">\(\eta, \pi(\eta \mid y)\)</span>, is proportional to <span class="math display">\[
\eta^{-t}\left(1+\eta t_m\right)^{-\frac{n+s-1}{2}} \psi(\eta)\left(a+\frac{b}{1+\eta t_m}\right)^{-\frac{m n+r-5}{2}} .
\]</span></p>
<p><strong>Step 2</strong>: For the current <span class="math inline">\(\eta\)</span>, sample a value of <span class="math inline">\(\sigma_\omega^2\)</span> from its conditional posterior distribution <span class="math inline">\(\pi_{R_2}\left(\sigma_\omega^2 \mid \eta, y\right)\)</span>, which is an inverse-Gamma distribution with the shape parameter <span class="math inline">\(\frac{m n+r-5}{2}\)</span> and the scale parameter <span class="math inline">\(\frac{1}{2}\left(a+\frac{b}{1+\eta t_m}\right)\)</span>.</p>
<p><strong>Step 3</strong>: Given <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\sigma_\omega^2\)</span>, generate a value of <span class="math inline">\(\mu\)</span> from its conditional posterior distribution <span class="math inline">\(\pi_{R_2}\left(\mu \mid \eta, \sigma_\omega^2, y\right)\)</span>, which is a normal distribution with the mean <span class="math inline">\(\widehat{\mu}\)</span> and the variance <span class="math inline">\(\frac{\sigma_\omega^2\left(1+\eta t_m\right)}{n t_m}\)</span>.</p>
<p>For Step 1, a random-walk Metropolis algorithm can be used to sample for <span class="math inline">\(\eta\)</span>. Considering the new candidate parameter value, labeled <span class="math inline">\(v\)</span>, which is drawn from a normal distribution <span class="math inline">\(N\left(\eta, \rho^2\right)\)</span> truncated on the interval <span class="math inline">\((0, \infty)\)</span>, where <span class="math inline">\(\rho^2\)</span> is a tuning parameter. Truncated normal random numbers can be readily generated by using the function rtnorm in the <span class="math inline">\(m s m\)</span> package of <span class="math inline">\(R\)</span> software. Then the candidate value is accepted with probability <span class="math display">\[
\min \left\{1, \frac{\pi_{R_2}(v \mid y) \Phi\left(\frac{\eta}{\rho}\right)}{\pi_{R_2}(\eta \mid y) \Phi\left(\frac{v}{\rho}\right)}\right\},
\]</span> where <span class="math inline">\(\Phi(\cdot)\)</span> is the cumulative distribution function of the standard normal.</p>
<p>Here, one may care about the choice of the tuning parameter <span class="math inline">\(\rho^2\)</span> in Step 1. Obviously, small values of <span class="math inline">\(\rho^2\)</span> will lead to large autocorrelations and result in high acceptance rates but slow convergence, while the opposite conclusion holds for high values of <span class="math inline">\(\rho^2\)</span>. Albert commented that the range of acceptance rates between <span class="math inline">\(25\%\)</span> and <span class="math inline">\(45\%\)</span> is good for random walk chains with normal proposal densities. Thus, one can try several values of <span class="math inline">\(\rho^2\)</span> until the desired acceptance rate is achieved in practice.</p>
</section>
</section>
<section id="广义推断方法" class="level5">
<h5 class="anchored" data-anchor-id="广义推断方法">3.1.2.3 广义推断方法</h5>
<p>暂时还未找到，最经典的维纳过程的广义推断方法论文。其他类似的论文整理如下：</p>
<ul>
<li>维纳（线性） + 随机效应：</li>
</ul>
<p>Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety 193.</p>
<ul>
<li>维纳（线性）+ 加速寿命试验 + 随机效应：</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2020). “Reliability analysis for accelerated degradation data based on the Wiener process with random effects.” Quality and Reliability Engineering International 36(6): 1969-1981.</p>
<p>Hong, L., et al.&nbsp;(2018). “Interval estimation for Wiener processes based on accelerated degradation test data.” IISE Transactions 50(12): 1043-1057.</p>
<ul>
<li>伽马 + 随机过程</li>
</ul>
<p>Wang, X. F., et al.&nbsp;(2021). “Degradation data analysis based on gamma process with random effects.” European Journal of Operational Research 292(3): 1200-1208.</p>
<ul>
<li>伽马 + 加速寿命试验</li>
</ul>
<p>Jiang, P. H., et al.&nbsp;(2019). “Inference for constant-stress accelerated degradation test based on Gamma process.” Applied Mathematical Modelling 67: 123-134.</p>
</section>
</section>
</section>
<section id="多应力和动态环境情形" class="level3">
<h3 class="anchored" data-anchor-id="多应力和动态环境情形">3.2 多应力和动态环境情形</h3>
<p><strong>1. 多应力情形</strong></p>
<p>某些产品的性能退化过程较慢, 要在较短时间获得较多性能退化数据较为困难,通 常需要提高试验应力加快其退化过程。下面给出基于加速退化试验数据的模型参数估计方法。</p>
<p>假设在不同应力下, 一元 Wiener 过程模型的参数是应力 <span class="math inline">\(S\)</span> 的函数 <span class="math display">\[
\mu=\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma=\sigma\left(S ; \boldsymbol{\theta}_\sigma\right)
\]</span> 式中: <span class="math inline">\(\theta_\mu 、 \theta_\sigma\)</span> 是末知参数向量。</p>
<p>对不同类型应力, <span class="math inline">\(\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma\left(S ; \boldsymbol{\theta}_\sigma\right)\)</span> 的形式和参数不同。比如对漂移参数 <span class="math inline">\(\mu\)</span>, 应力 为温度时通常采用阿伦尼斯模型进行描述 <span class="math display">\[
\mu(S)=a \mathrm{e}^{-b / S}
\]</span></p>
<p>如果应力是电压、功率等, 则通常采用幂律模型 <span class="math display">\[
\mu(S)=a S^b
\]</span></p>
<p>根据加速退化试验中应力的变化情况,加速退化试验又分别为<strong>恒定应力加速退化试验</strong>、<strong>步进应力加速退化试验</strong>和<strong>序进应力加速退化试验</strong>。</p>
<p>恒定应力加速退化试验是目前应用最广、研究最多的, 这里考虑由恒定应力加速退化试验得到的加速退化数据。</p>
<p>设产品在 <span class="math inline">\(S_0, S_1, \cdots, S_s\)</span> 共 <span class="math inline">\(s+1\)</span> 个应力下进行退化试验, 其中应力 <span class="math inline">\(S_0\)</span> 为正常工作应 力。应力 <span class="math inline">\(S_i\)</span> 下共得到 <span class="math inline">\(n_i\)</span> 个产品的性能退化数据, 其中对产品 <span class="math inline">\(j\)</span>, 初始时刻 <span class="math inline">\(t_{i j 0}\)</span> 的退化量 为 <span class="math inline">\(X_{i j 0}=0\)</span>, 分别在时刻 <span class="math inline">\(t_{i j 1}, \cdots, t_{i j m_{i j}}\)</span> 测量其性能退化量 <span class="math inline">\(X_{i j 1}, \cdots, X_{i j m_{i j}}\)</span>, 其中 <span class="math inline">\(i=0,1, \cdots, s, j=\)</span> <span class="math inline">\(1,2, \cdots, n_i\)</span> 记 <span class="math inline">\(\Delta t_{i j k}=t_{i j k}-t_{i j(k-1)}, \Delta X_{i j k}=X_{i j k}-X_{i j(k-1)}\)</span>, 其中 <span class="math inline">\(k=1,2, \cdots, m_{i j}\)</span> 。由各应力下 的退化数据 <span class="math inline">\(\left\{\Delta x_{i j k}\right\}\)</span> 得到模型参数的似然函数为 <span class="math display">\[
L\left(\boldsymbol{\theta}_\mu, \boldsymbol{\theta}_\sigma\right)=\prod_{i=0}^3 \prod_{j=1}^{n_i} \prod_{k=1}^{m_{i j}} \frac{1}{\sqrt{2 \pi \sigma^2\left(S_i\right) \Delta t_{i j k}}} \exp \left[-\frac{\left(\Delta x_{i j k}-\mu\left(S_i\right) \Delta t_{i j k}\right)^2}{2 \sigma^2\left(S_i\right) \Delta t_{i j k}}\right]
\]</span></p>
<p>则参数 <span class="math inline">\(\boldsymbol{\theta}_\mu 、 \boldsymbol{\theta}_\sigma\)</span> 的极大似然估计 <span class="math inline">\(\hat{\boldsymbol{\theta}}_\mu 、 \hat{\boldsymbol{\theta}}_\sigma\)</span> 可以采用数值方法求式 (3.49) 的极大值得到。则 常应力 <span class="math inline">\(S_0\)</span> 下参数 <span class="math inline">\(\mu 、 \sigma^2\)</span> 为 <span class="math display">\[
\mu=\mu\left(S_0 ; \hat{\boldsymbol{\theta}}_\mu\right), \sigma^2=\sigma^2\left(S_0 ; \hat{\boldsymbol{\theta}}_\sigma\right)
\]</span> 产品可靠度点估计可由式 (3.42)得到。</p>
<p><strong>2. 动态环境情形</strong></p>
<p>与基于失效的可靠性建模方法相比, 退化过程模型的优点在于可以直接描述应力 对产品退化过程 (如退化速率) 的影响, 为解释产品失效过程、利用各种可能的数据提 供了可能。下面考虑动态环境下的参数估计问题。设动态环境下的应力过程为 <span class="math inline">\(\{S\)</span> <span class="math inline">\((t), t \geqslant 0\}\)</span>, 并且假设应力对退化速率的影响函数为 <span class="math inline">\(\beta_0 \cdot h(S(t) ; b)\)</span>, 其中 <span class="math inline">\(\beta_0\)</span> 是基准应 力下的退化速率, 以 <span class="math inline">\(b\)</span> 为参数的函数 <span class="math inline">\(h(S(t) ; b)\)</span> 表示应力的影响, <span class="math inline">\(b\)</span> 是待估参数。认为 应力对退化速率的影响是立即发生的, 即没有时间延迟, 并且退化符合累计损伤规律, 则可知时刻 <span class="math inline">\(t\)</span> 产品退化量取值为 <span class="math display">\[
X(t \mid T(\tau), 0 \leqslant \tau \leqslant t)=\beta_0 \int_0^t h(S(\tau) ; b) \mathrm{d} \tau+\sigma_B B(t)
\]</span> 式中: <span class="math inline">\(\{S(\tau), 0 \leqslant \tau \leqslant t\}\)</span> 为 <span class="math inline">\([0, \tau]\)</span> 内的应力; <span class="math inline">\(\{B(t), t \geqslant 0\}\)</span> 为标准 Wiener 过程; 模型待估 参数为 <span class="math display">\[
\boldsymbol{\theta}=\left(\beta_0, b, \sigma_B^2\right)
\]</span></p>
<p>设有 <span class="math inline">\(n\)</span> 个产品进行退化试验, 不失一般性, 考虑规则型连续测量情形。对产品 <span class="math inline">\(i\)</span>, 设 时刻 <span class="math inline">\(t_{i k}\)</span> 观测到的退化量为 <span class="math inline">\(X_i\left(t_{i k}\right), k=0,1,2, \cdots, m\left(t_{i 0}=0\right)\)</span>; 对环境进行连续观测, 时刻 <span class="math inline">\(j\)</span> 观测到应力取值为 <span class="math inline">\(S_{i j}, j=1,2, \cdots\)</span> 。需要注意的是,退化量的测量间隔与环境监测时间 间隔可能是不同的,这里假设后者的监测更频繁。不失一般性, 假设环境监测间隔为 1 个时间单位, 则 <span class="math inline">\(t_{i k}-t_{i, k-1} \geqslant 1, k=1,2, \cdots\)</span> 。下面基于动态环境下的退化试验数据, 给出 模型参数的<strong>极大似然估计</strong>方法。</p>
<p>根据模型式 <span class="math inline">\((3.51)\)</span>, 记 <span class="math inline">\(\nu_{i k}=\sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)\)</span>, 对产品 <span class="math inline">\(i\)</span> 以及时刻 <span class="math inline">\(t_{i k}\)</span> 近似的有 <span class="math display">\[
X_i\left(t_{i k}\right)=\beta_0 \int_0^{t_{i k}} h\left(S_i(\tau) ; b\right) \mathrm{d} \tau+\sigma_B B\left(t_{i k}\right) \approx \beta_0 \sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)+\sigma_B B\left(t_{i k}\right)
\]</span> 且有 <span class="math display">\[
\begin{gathered}
E\left[X_i\left(t_{i k}\right)\right]=\beta_0 \nu_{i k} \\
\operatorname{Cov}\left[X_i\left(t_{i k_1}\right), X_i\left(t_{i i_2}\right)\right]=\sigma_B^2 \cdot \min \left\{t_{i k_1}, t_{i k_2}\right\}
\end{gathered}
\]</span> 如果考虑退化增量 <span class="math inline">\(\boldsymbol{Y}_i=\left(Y_i\left(t_{i 1}\right), \cdots, Y_i\left(t_{i m}\right)\right)\)</span>, 其中 <span class="math display">\[
Y_i\left(t_{i k}\right)=X_i\left(t_{i k}\right)-X_i\left(t_{i, k-1}\right), \quad k=1,2, \cdots, m
\]</span> 记 <span class="math inline">\(\Delta t_{i k}=t_{i k}-t_{i, k-1}, \Delta \nu_{i k}=\nu_{i k}-\nu_{i, k-1}\)</span> 。容易知道 <span class="math inline">\(\boldsymbol{Y}_i \sim N\left(\mu_i, \Sigma_i\right)\)</span>, 其中 <span class="math display">\[
\mu_i=\beta_0 \Delta \nu_i, \Sigma_i=\sigma_B^2 \cdot \operatorname{diag}\left(\Delta t_i\right)
\]</span></p>
<p>其中 <span class="math display">\[
\Delta \boldsymbol{\nu}_i=\left(\Delta \nu_{i 1}, \Delta \nu_{i 2}, \cdots, \Delta \nu_{i m}\right)^{\mathrm{T}}, \quad \Delta t_i=\left(\Delta t_{i 1}, \Delta t_{i 2}, \cdots, \Delta t_{i m}\right)^{\mathrm{T}}
\]</span> 设退化试验数据为 <span class="math inline">\(\boldsymbol{y}_i, i=1,2, \cdots, n\)</span>, 则似然函数为 <span class="math display">\[
L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)^{\mathrm{T}} \boldsymbol{\Sigma}_i^{-1}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)\right\}
\]</span> 对数似然函数为 <span class="math display">\[
l(\boldsymbol{\theta})=\text { Const }-n m \ln \sigma_B-\frac{1}{2 \sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}
\]</span> 取对数似然函数关 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\beta_0\)</span> 的一阶偏导数,得到 <span class="math display">\[
\frac{\partial}{\partial \sigma_B} l(\boldsymbol{\theta})=-n m \frac{1}{\sigma_B}+\frac{1}{\sigma_B^3} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}
\]</span> 与 <span class="math display">\[
\frac{\partial l(\boldsymbol{\theta})}{\partial \beta_0}=\frac{1}{\sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\Delta \nu_{i j}\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)}{\Delta t_{i j}}
\]</span> 这样, 对特定的 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\beta_0\)</span>, 置这两个导数为 0 , 得到 将其代人对数似然函数, 得到截面对数似然函数如下: <span class="math display">\[
l(b)=\text { Const }-n m \ln \hat{\sigma}_B-\frac{1}{2 \hat{\sigma}_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\hat{\beta}_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}
\]</span> 通过搜索得到 <span class="math inline">\(b\)</span> 的极大似然估计 <span class="math inline">\(\hat{b}\)</span>, 并将其代人式 (3.52) 或式 (3.53), 就得到 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\beta_0\)</span> 的极大似然估计。</p>
</section>
<section id="含随机效应情形" class="level3">
<h3 class="anchored" data-anchor-id="含随机效应情形">3.3 含随机效应情形</h3>
<p>考虑漂移参数和扩散参数服从正态 - 逆 Gamma 分布的情形, 利用 <span class="math inline">\(n\)</span> 个样品的退化 试验数据对随机效应的分布参数 <span class="math inline">\(\nu 、 \eta 、 \alpha 、 \beta\)</span> 进行估计。这里采用两阶段法, 即首先估计 个体产品的固定效应退化过程的参数, 再利用估计的参数值来得到随机效应分布参数 的估计。</p>
<p>对产品 <span class="math inline">\(i\)</span>, 分别在时刻 <span class="math inline">\(t_{i 0}=0, t_{i 1}, t_{i 2}, \cdots, t_{i m_i}\)</span> 对其进行 <span class="math inline">\(m_i+1\)</span> 次测量, <span class="math inline">\(i=1,2, \cdots, n\)</span>, 得 到的测量数据为 <span class="math inline">\(x_{i j}\)</span> 。记 <span class="math inline">\(\Delta x_{i j}=x_{i j}-x_{i, j-1}\)</span>, 即 <span class="math inline">\(\Delta x_{i j}\)</span> 为产品 <span class="math inline">\(i\)</span> 在 <span class="math inline">\(t_{i j-1}\)</span> 到 <span class="math inline">\(t_{i j}\)</span> 之间的退化量增量, 由式 (3.41), 给定试验数据 <span class="math inline">\(\Delta x_{i j}\)</span> 的情况下, 样品 <span class="math inline">\(i\)</span> 的退化过程模型参数 <span class="math inline">\(\mu_i, \sigma_i^2\)</span> 的极大似然估计为 <span class="math display">\[
\hat{\mu}_i=\frac{X_{i m_i}}{t_{i m_i}}, \hat{\sigma}_i^2=\frac{1}{m_i}\left[\sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{X_{i m_i}^2}{t_{i m_i}}\right]
\]</span> 式中 : <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i(j-1)}, j=1,2, \cdots, m_i\)</span> 。</p>
<p>由式 (3.56) 得到各产品的退化过程参数的估计 <span class="math inline">\(\hat{\mu}_i 、 \hat{\sigma}_i^2\)</span> 后, 可以拟合得到 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(D\)</span> 的 分布参数。令 <span class="math inline">\(\hat{D}_i=\hat{\sigma}_i^2\)</span>, 由于 <span class="math inline">\(D^{-1}\)</span> 服从参数为 <span class="math inline">\((\alpha, \beta)\)</span> 的 <span class="math inline">\(\mathrm{Gamma}\)</span> 分布, 则根据极大似然估 计, <span class="math inline">\(D\)</span> 的分布参数 <span class="math inline">\(\alpha \sqrt{ } \beta\)</span> 可以通过求解下面的方程组得到: <span class="math display">\[
\left\{\begin{array}{l}
\ln \beta-\psi(\beta)=\ln \frac{1}{n} \sum_{i=1}^n \frac{1}{\hat{D}_i}-\frac{1}{n} \ln \left(\prod_{i=1}^n \frac{1}{\hat{D}_i}\right) \\
\alpha=\frac{n \beta}{\sum_{i=1}^n \hat{D}_i^{-1}}
\end{array}\right.
\]</span> 式中: <span class="math inline">\(\psi(x)=\frac{\mathrm{d} \ln \Gamma(x)}{\mathrm{d} x}=\Gamma(x) / \Gamma^{\prime}(x)\)</span> 为 Digamma 函数, 文献 <span class="math inline">\([47]\)</span> 给出了其准确计算方法。</p>
<p>由于 <span class="math inline">\(\mu \sim N(\nu, \eta D)\)</span>, 对单元 <span class="math inline">\(i\)</span>, 近似认为参数 <span class="math inline">\(\nu 、 \eta\)</span> 的似然函数为 <span class="math display">\[
l\left(\nu, \eta \mid \hat{\mu}_i, \hat{D}_i\right)=\frac{1}{\sqrt{2 \pi \eta \hat{D}_i}} \exp \left(-\frac{\left(\hat{\mu}_i-\nu\right)^2}{2 \eta \hat{D}_i}\right)
\]</span> 于是总的似然函数为 <span class="math display">\[
l(\nu, \eta)=-\frac{n}{2} \ln 2 \pi-\frac{1}{2} \sum_{i=1}^n \hat{D}_i-\frac{n}{2} \ln \eta-\frac{1}{2 \eta}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)
\]</span> 由极大似然方法得到 <span class="math display">\[
\left\{\begin{array}{l}
-\frac{1}{\eta}\left(-\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+\mu \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 \\
-\frac{n}{2 \eta}+\frac{1}{2 \eta^2}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0
\end{array}\right.
\]</span> 解上面的方程组得到 <span class="math display">\[
\left\{\begin{array}{l}
\hat{\nu}=\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i} / \sum_{i=1}^n \frac{1}{\hat{D}_i} \\
\hat{\eta}=\frac{1}{n}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-\left(\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}\right)^2 / \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)
\end{array}\right.
\]</span></p>
</section>
<section id="有测量误差情形" class="level3">
<h3 class="anchored" data-anchor-id="有测量误差情形">3.4 有测量误差情形</h3>
<p>假设 <span class="math inline">\(Y(t)\)</span> 和 <span class="math inline">\(X(t)\)</span> 分别表示观测的退化过程和真实退化过程在时刻 <span class="math inline">\(t, t \geqslant 0\)</span> 的退化水平, <span class="math inline">\(X(t)\)</span> 和 <span class="math inline">\(Y(t)\)</span> 可用下面的模型描述: <span class="math display">\[
\left\{\begin{array}{l}
X(t)=\beta \cdot t+\sigma_B \cdot B(t) \\
Y(t)=X(t)+\sigma_R \cdot \varepsilon(t)
\end{array}\right.
\]</span> 式中: <span class="math inline">\(\beta\)</span> 对个体产品是恒定不变的退化强度即退化速率: 假设不同个体平均退化速率存 在差异, 并可用正态分布描述, 即 <span class="math inline">\(\beta \sim N\left(\mu_\beta, \sigma_\beta^2\right) ; B(t)\)</span> 是标准 Wiener 过程, <span class="math inline">\(\sigma_B\)</span> 为扩散参 数; <span class="math inline">\(\varepsilon(t)\)</span> 表示测量误差, 是均值为 0 、方差为 1 的 Gaussian 白噪声。</p>
<p>因此, 式 (3.61) 模型共有 4 个待估参数, 即 <span class="math display">\[
\boldsymbol{\theta}=\left(\mu_\beta, \sigma_\beta, \sigma_B^2, \sigma_R^2\right)^{\mathrm{T}}
\]</span></p>
<p>假设对 <span class="math inline">\(n\)</span> 个产品进行退化试验。对单元 <span class="math inline">\(i(i=1, \cdots, n)\)</span> 进行 <span class="math inline">\(m_i\)</span> 次测量, 时刻 <span class="math inline">\(t_{i j}\)</span> 的测量值为 <span class="math display">\[
Y_i\left(t_{i j}\right)=X_i\left(t_{i j}\right)+\sigma_e \varepsilon\left(t_{i j}\right)=\beta_i t_{i j}+\sigma_B B\left(t_{i j}\right)+\sigma_R \varepsilon\left(t_{i j}\right), j=1, \cdots, m_i
\]</span> 式中 : <span class="math inline">\(\beta_i\)</span> 是单元 <span class="math inline">\(i\)</span> 的平均退化速率, 对单元 <span class="math inline">\(i\)</span> 的所有测量是恒定不变的。</p>
<p>定义时间间隔 <span class="math inline">\(\Delta t_{i j}=t_{i j}-t_{i j-1}\)</span>, 观测的退化增量为 <span class="math inline">\(\Delta Y_{i j}=Y_i\left(t_{i j}\right)-Y_i\left(t_{i j-1}\right), j=1\)</span>, <span class="math inline">\(2, \cdots, m_i\)</span>; 根据 Wiener 过程定义, <span class="math inline">\(t_{i 0}=0, Y_i\left(t_{i 0}\right)=0\)</span> 。为叙述方便, 令 <span class="math display">\[
\Delta t_i=\left(\Delta t_{i 1}, \cdots, \Delta t_{i m_i}\right)^{\mathrm{T}}, \Delta \boldsymbol{Y}_i=\left(\Delta Y_{i 1}, \cdots, \Delta Y_{i m_i}\right)^{\mathrm{T}}
\]</span></p>
<p>根据 Wiener 过程的独立增量性质, 得到 <span class="math display">\[
\begin{gathered}
E\left[\Delta \boldsymbol{Y}_i\right]=\mu_\beta \Delta \boldsymbol{t}_i \\
\operatorname{Cov}\left(\Delta \boldsymbol{Y}_i\right) \triangleq \Sigma_i=\sigma_\beta^2 \Delta \boldsymbol{t}_i \Delta t_i^{\mathrm{T}}+\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i \\
\end{gathered}
\]</span> 其中， <span class="math display">\[
\boldsymbol{K}_i=\operatorname{diag}\left(\Delta \boldsymbol{t}_i\right), \boldsymbol{P}_i=\left[\begin{array}{ccccc}
2 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp; \cdots &amp; 0 \\
0 &amp; -1 &amp; 2 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2
\end{array}\right]
\]</span></p>
<p>设退化数据为 <span class="math inline">\(\Delta \boldsymbol{Y}_i=\Delta \boldsymbol{y}_i, i=1,2, \cdots, n\)</span>, 则参数 <span class="math inline">\(\boldsymbol{\theta}\)</span> 的似然函数为 <span class="math display">\[
L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m_i}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left\{-\frac{1}{2}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \Sigma_i^{-1}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)\right\}
\]</span> 令 <span class="math inline">\(\Sigma_i=\sigma_\beta^2 \Delta t_i \Delta t_i^{\mathrm{T}}+\boldsymbol{\Omega}_i\)</span>, 其中 <span class="math inline">\(\boldsymbol{\Omega}_i=\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i\)</span> 定义 <span class="math display">\[
\phi_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{y}_i, \rho_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta t_i
\]</span> 取对数似然函数关于 <span class="math inline">\(\mu_\beta\)</span> 和 <span class="math inline">\(\sigma_\beta^2\)</span> 的一阶偏导数, 并利用下面的公式 <span class="math display">\[
\begin{aligned}
\left|\boldsymbol{\Sigma}_i\right| &amp;=\left|\boldsymbol{\Omega}_i\right|\left(1+\sigma_\beta^2 \Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i\right)=\left(\boldsymbol{\Omega}_i \mid\left(1+\sigma_\beta^2 \rho_i\right)\right.\\
\boldsymbol{\Sigma}_i^{-1} &amp;=\boldsymbol{\Omega}_i^{-1}-\frac{\sigma_\beta^2}{1+\sigma_\beta^2 \rho_i} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i \Delta \boldsymbol{t}_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}(\text { Woodbury 公式 })
\end{aligned}
\]</span></p>
<p>得到 <span class="math display">\[
\frac{\partial}{\partial \mu_\beta} l(\boldsymbol{\theta})=\sum_{i=1}^n \frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}
\]</span> 和 <span class="math display">\[
\frac{\partial}{\partial \sigma_\beta^2} l(\boldsymbol{\theta})=\sum_{i=1}^n\left(\frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\sigma_\beta^2 \rho_i}
\]</span> 于是, 对特定的 <span class="math inline">\(\left(\sigma_B, \sigma_R\right)\)</span> 取值, 置式 (3.62) 和式 (3.63) 等于 0 , 得到 <span class="math inline">\(\mu_\beta\)</span> 和 <span class="math inline">\(\sigma_\beta\)</span> 的如下限制极大似然估计: <span class="math display">\[
\left\{\begin{array}{l}
\hat{\mu}_\beta=\sum_{i=1}^n \frac{\phi_i}{1+\hat{\sigma}_\beta^2 \rho_i} / \sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i} \\
\sum_{i=1}^n\left(\frac{\phi_i-\hat{\mu}_\beta \rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}=0
\end{array}\right.
\]</span> 将上式代人 <span class="math inline">\(\theta\)</span> 的对数似然函数,则得到如下的截面似然函数: <span class="math display">\[
\begin{aligned}
l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{1}{2} \sum_{i=1}^n m_i \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^n \ln \left|\boldsymbol{\Omega}_i\right|-\frac{1}{2} \sum_{i=1}^n \ln \left(1+\hat{\sigma}_\beta^2 \rho_i\right) \\
&amp;-\frac{1}{2} \sum_{i=1}^n\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right) \\
&amp;+\frac{1}{2} \sum_{i=1}^n \frac{\hat{\sigma}_\beta^2\left(\phi_i-\hat{\mu}_\beta \rho_i\right)^2}{1+\hat{\sigma}_\beta^2 \rho_i}
\end{aligned}
\]</span> 通过最大化上述截面似然函数, 得到 <span class="math inline">\(\sigma_B\)</span> 和 <span class="math inline">\(\sigma_R\)</span> 的极大似然估计 <span class="math inline">\(\left(\hat{\sigma}_B, \hat{\sigma}_R\right)\)</span>, 这可通过 2 维搜索算法实现。最后将 <span class="math inline">\(\left(\hat{\sigma}_B, \hat{\sigma}_R\right)\)</span> 代人式 (3.64), 得到 <span class="math inline">\(\mu_\beta\)</span> 和 <span class="math inline">\(\sigma_\beta\)</span> 的极大似然估计。</p>
<p>当所有观测时间相同时, 诸 <span class="math inline">\(\rho_i\)</span> 相同, 记为 <span class="math inline">\(\rho\)</span>, 可以得到 <span class="math inline">\(\hat{\mu}_\beta\)</span> 和 <span class="math inline">\(\hat{\sigma}_\beta^2\)</span> 的解析形式, 即 <span class="math display">\[
\begin{gathered}
\hat{\mu}_\beta=\frac{1}{n \rho} \sum_{i=1}^n \phi_i=\frac{1}{n} \sum_{i=1}^n \frac{\phi_i}{\rho} \triangleq \frac{1}{n} \sum_{i=1}^n \hat{\mu}_{\beta, i} \\
\hat{\sigma}_\beta^2=\frac{1}{n \rho^2} \sum_{i=1}^n\left(\phi_i-\hat{\mu}_\beta \rho\right)^2-\frac{1}{\rho}=\frac{1}{n} \sum_{i=1}^n\left(\hat{\mu}_{\beta, i}-\hat{\mu}_\beta\right)^2-\frac{1}{\rho}
\end{gathered}
\]</span> 容易看出, <span class="math inline">\(\hat{\mu}_{\beta, i}\)</span> 实际上是单元 <span class="math inline">\(i\)</span> 的退化速率的加权最小二乘估计, <span class="math inline">\(\hat{\sigma}_\beta^2\)</span> 的第一项是估 计的退化速率的方差。此时, 可以得到截面似然函数的比较简单的形式, 如下所示: <span class="math display">\[
\begin{aligned}
l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{n m}{2} \ln (2 \pi)-\frac{n}{2}-\frac{n}{2} \ln |\boldsymbol{\Omega}| \\
&amp;-\frac{1}{2}\left\{\sum_{i=1}^n \Delta \boldsymbol{y}_i^{\mathrm{T}} \boldsymbol{\Omega}^{-1} \Delta \boldsymbol{y}_i-\frac{1}{\rho} \sum_{i=1}^n \phi_i^2\right\} \\
&amp;-\frac{n}{2} \ln \left(\frac{1}{n \rho} \sum_{i=1}^n \phi_i^2-\frac{1}{n^2 \rho}\left(\sum_{i=1}^n \phi_i\right)^2\right)
\end{aligned}
\]</span></p>
</section>
<section id="案例分析" class="level3">
<h3 class="anchored" data-anchor-id="案例分析">3.3 案例分析</h3>
<section id="nasa-锂电池数据" class="level4">
<h4 class="anchored" data-anchor-id="nasa-锂电池数据">3.3.1 NASA 锂电池数据</h4>
<blockquote class="blockquote">
<p>数据来源于<a href="https://c3.ndc.nasa.gov/dashlink/resources/133/">NASA Ames Prognostics Center of Excellence (PCoE)</a>，但是找不到数据下载。最后是通过 <a href="https://github.com/psanabriaUC/BatteryDatasetImplementation">Github</a> 获得。</p>
</blockquote>
<p>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即<strong>充电</strong>、<strong>放电</strong>和<strong>测量 EIS</strong>。</p>
<p>充电是以<strong>恒流模</strong>式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以<strong>恒压模式</strong>(CV)继续充电直到电流降到 20mA。</p>
<p>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</p>
<p>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Voltage_measured</th>
<th style="text-align: right;">Current_measured</th>
<th style="text-align: right;">Temperature_measured</th>
<th style="text-align: right;">Current_charge</th>
<th style="text-align: right;">Voltage_charge</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Capacity</th>
<th style="text-align: right;">id_cycle</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">ambient_temperature</th>
<th style="text-align: right;">time</th>
<th style="text-align: left;">Battery</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.974871</td>
<td style="text-align: right;">-2.012528</td>
<td style="text-align: right;">24.38909</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.062</td>
<td style="text-align: right;">35.703</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.951717</td>
<td style="text-align: right;">-2.013979</td>
<td style="text-align: right;">24.54475</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.030</td>
<td style="text-align: right;">53.781</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.934353</td>
<td style="text-align: right;">-2.011144</td>
<td style="text-align: right;">24.73139</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">3.011</td>
<td style="text-align: right;">71.922</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.920058</td>
<td style="text-align: right;">-2.013007</td>
<td style="text-align: right;">24.90982</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.991</td>
<td style="text-align: right;">90.094</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.907904</td>
<td style="text-align: right;">-2.014400</td>
<td style="text-align: right;">25.10588</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.977</td>
<td style="text-align: right;">108.281</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.897036</td>
<td style="text-align: right;">-2.011603</td>
<td style="text-align: right;">25.31702</td>
<td style="text-align: right;">1.9982</td>
<td style="text-align: right;">2.967</td>
<td style="text-align: right;">126.453</td>
<td style="text-align: right;">1.856487</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">discharge</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2008</td>
<td style="text-align: left;">B0005</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb12-2"><a href="#cb12-2"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb14-2"><a href="#cb14-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb14-4"><a href="#cb14-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003751909 0.017612386</code></pre>
</div>
</div>
<p>计算可靠度并绘图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6778098 0.9301711 0.7446791 0.6747844</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb18-5"><a href="#cb18-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb18-6"><a href="#cb18-6"></a>}</span>
<span id="cb18-7"><a href="#cb18-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb18-8"><a href="#cb18-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb18-10"><a href="#cb18-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb18-11"><a href="#cb18-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb18-12"><a href="#cb18-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="激光器件-laser-数据集" class="level4">
<h4 class="anchored" data-anchor-id="激光器件-laser-数据集">3.3.2 激光器件 Laser 数据集</h4>
<blockquote class="blockquote">
<p>数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</p>
</blockquote>
<p>激光器件的质量特征是其<strong>工作电流</strong>。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: right;">Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4741</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9255</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1147</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.7168</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.5110</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1250</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb22-3"><a href="#cb22-3"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb23-2"><a href="#cb23-2"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb23-4"><a href="#cb23-4"></a>mle_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00203768 0.01268431</code></pre>
</div>
</div>
<p>计算可靠度并绘图，阈值设置参考 Wang, X., et al.&nbsp;(2020). “Accurate reliability inference based on Wiener process with random effects for degradation data.” Reliability Engineering &amp; System Safety <strong>193</strong>. 第6节案例分析</p>
<p>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</p>
<blockquote class="blockquote">
<p>可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4168139</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb27-5"><a href="#cb27-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb27-6"><a href="#cb27-6"></a>}</span>
<span id="cb27-7"><a href="#cb27-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb27-8"><a href="#cb27-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb27-10"><a href="#cb27-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb27-11"><a href="#cb27-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb27-12"><a href="#cb27-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="炭膜电阻器-carbon-film-resistors" class="level4">
<h4 class="anchored" data-anchor-id="炭膜电阻器-carbon-film-resistors">3.3.3 炭膜电阻器 carbon-film resistors</h4>
<blockquote class="blockquote">
<p>退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</p>
</blockquote>
<p>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</p>
<p>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Percent.Increase</th>
<th style="text-align: left;">Resistor.ID</th>
<th style="text-align: right;">DegreesC</th>
<th style="text-align: right;">Thousands.of.Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.28</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.32</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.38</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">4.341</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">R1</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">8.084</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.22</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">R2</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">1.030</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb30-2"><a href="#cb30-2"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb30-6"><a href="#cb30-6"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>后续参数估计和可靠度估计就先不做了。</p>
<p>类似的数据集还包括：</p>
</section>
<section id="惯导平台-interial-navigition-数据" class="level4">
<h4 class="anchored" data-anchor-id="惯导平台-interial-navigition-数据">3.3.4 惯导平台 interial navigition 数据</h4>
<blockquote class="blockquote">
<p>数据来自于文献：Si, X. S., et al.&nbsp;(2012). “Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process.” IEEE Transactions on Reliability <strong>61</strong>(1): 50-67.</p>
</blockquote>
<p>惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。</p>
<p>下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。</p>
<p>图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。</p>
<p><img src="images/paste-40CEA295.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>interial_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/interial_navigition.csv"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(interial_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">Item1</th>
<th style="text-align: right;">Item2</th>
<th style="text-align: right;">Item3</th>
<th style="text-align: right;">Item4</th>
<th style="text-align: right;">Item5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.0507</td>
<td style="text-align: right;">0.1300</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.1052</td>
<td style="text-align: right;">0.0928</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">0.1789</td>
<td style="text-align: right;">0.2554</td>
<td style="text-align: right;">0.0309</td>
<td style="text-align: right;">0.1996</td>
<td style="text-align: right;">0.2633</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0.2059</td>
<td style="text-align: right;">0.3153</td>
<td style="text-align: right;">0.0077</td>
<td style="text-align: right;">0.2927</td>
<td style="text-align: right;">0.3010</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">0.2548</td>
<td style="text-align: right;">0.3966</td>
<td style="text-align: right;">0.1510</td>
<td style="text-align: right;">0.3060</td>
<td style="text-align: right;">0.3515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">0.3117</td>
<td style="text-align: right;">0.2424</td>
<td style="text-align: right;">0.1162</td>
<td style="text-align: right;">0.2860</td>
<td style="text-align: right;">0.2818</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">0.5236</td>
<td style="text-align: right;">0.3473</td>
<td style="text-align: right;">0.0237</td>
<td style="text-align: right;">0.2918</td>
<td style="text-align: right;">0.4375</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>interial_new <span class="ot">=</span> interial_dat <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item5</span><span class="st">`</span>, </span>
<span id="cb32-3"><a href="#cb32-3"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a></span>
<span id="cb32-6"><a href="#cb32-6"></a>interial_new <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,Value)) <span class="sc">+</span> </span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-16"><a href="#cb32-16"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="铝合金疲劳裂纹长度-2017-t4-aluminum-alloy" class="level4">
<h4 class="anchored" data-anchor-id="铝合金疲劳裂纹长度-2017-t4-aluminum-alloy">3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</h4>
<blockquote class="blockquote">
<p>数据来自： (Si, X. S., et al.&nbsp;(2012). “Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process.” IEEE Transactions on Reliability 61(1): 50-67).</p>
</blockquote>
<p>它是飞机上常用的金属材料，这种材料的完整性通过<strong>疲劳裂纹的长度</strong>来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。</p>
<p>对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。<strong>退化过程存在非线性</strong>。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>Alloy_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/2017-T4 Aluminum Alloy.csv"</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Alloy_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Cycle</th>
<th style="text-align: right;">Item1</th>
<th style="text-align: right;">Item2</th>
<th style="text-align: right;">Item3</th>
<th style="text-align: right;">Item4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">1.25</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>Alloy_new <span class="ot">=</span> Alloy_dat <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item4</span><span class="st">`</span>, </span>
<span id="cb34-3"><a href="#cb34-3"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a>Alloy_new <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cycle,Value)) <span class="sc">+</span> </span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb34-10"><a href="#cb34-10"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb34-12"><a href="#cb34-12"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb34-14"><a href="#cb34-14"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-15"><a href="#cb34-15"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="gamma退化过程模型" class="level2">
<h2 class="anchored" data-anchor-id="gamma退化过程模型">4. Gamma退化过程模型</h2>
<p>Gamma 过程描述的退化过程是严格单调非负的，并且Gamma 过程是纯跳过程，其样本路径不连续，既可描述连续的微小冲击导致的缓慢退化，也可以描述大的冲击导致的大的损伤。</p>
<section id="经典-gamma-过程" class="level3">
<h3 class="anchored" data-anchor-id="经典-gamma-过程">4.1 经典 Gamma 过程</h3>
<section id="似然函数" class="level4">
<h4 class="anchored" data-anchor-id="似然函数">似然函数</h4>
<p>假设共有 <span class="math inline">\(\mathrm{n}\)</span> 个样品进行性能退化试验. 对于样品 <span class="math inline">\(i\)</span>, 初始时刻 <span class="math inline">\(t_0\)</span> 性 能退化量为 <span class="math inline">\(X_{i 0}=0\)</span>, 在时刻 <span class="math inline">\(t_1, \cdots, t_{m_i}\)</span> 测量产品的性能退化量, 得到 其测量值为 <span class="math inline">\(X_{i 1}, \cdots, X_{i m_i}\)</span>. 记 <span class="math inline">\(\Delta x_{i j}=X_{i j}-X_{i(j-1)}\)</span> 是样品 <span class="math inline">\(i\)</span> 在时刻 <span class="math inline">\(t_{j-1}\)</span> 和 <span class="math inline">\(t_j\)</span> 之间的性能退化量, 由 Gamma 过程的独立增量性得到<span class="math inline">\(\Delta X(t) \sim Ga(\alpha \Delta t_{ij},\beta)\)</span>。则似然函数为</p>
<p><span class="math display">\[
l(\alpha, \beta)=\sum_{i=1}^n\left(\sum_{j=1}^{m_i}\left(\alpha \Delta t_{i j}-1\right) \ln \Delta x_{i j}-\alpha t_{i m_i} \ln \beta-\sum_{j=1}^{m_i} \ln \Gamma\left(\alpha \Delta t_{i j}\right)-\frac{x_{i m_i}}{\beta}\right)
\]</span></p>
</section>
<section id="产品寿命" class="level4">
<h4 class="anchored" data-anchor-id="产品寿命">产品寿命</h4>
<p>因为Gamma 过程的退化是单调递增的，即<span class="math inline">\(X(t) \sim Ga(\alpha t,\beta)\)</span> ,因此<strong>产品寿命</strong>的分布可以通过退化量的转变关系获得。当给定产品退化失效阈值 <span class="math inline">\(\ell\)</span> 时，产品寿命 <span class="math inline">\(T\)</span> 的CDF和PDF为</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{F}_{\mathrm{T}}(t) &amp;=\mathrm{P}(\mathrm{T} \leqslant \mathrm{t})=\mathrm{P}(\mathrm{X}(\mathrm{t}) \geqslant \ell) \\
&amp;=\int_{\ell}^{\infty} \frac{1}{\Gamma(\alpha \mathrm{t}) \beta^{\alpha \mathrm{t}}} \mathrm{x}^{\alpha \mathrm{t}-1} \mathrm{e}^{-\frac{\mathrm{x}}{\beta}} \mathrm{dx} \\
&amp;=\frac{1}{\Gamma(\alpha \mathrm{t})} \int_{\frac{\ell}{\beta}}^{\infty} \xi^{\alpha \mathrm{t}-1} \mathrm{e}^{-\xi} \mathrm{d} \xi ,\\
\mathrm{f}_{\mathrm{T}}(t) &amp;=\frac{\mathrm{d}}{\mathrm{dt}} \frac{\Gamma(\alpha \mathrm{t}, 1 / \beta)}{\Gamma(\alpha \mathrm{t})} \\
&amp;=\frac{\alpha}{\Gamma(\alpha \mathrm{t})} \int_0^{\nu / \beta}\left[\ln (\xi)-\frac{\Gamma^{\prime}(\alpha \mathrm{t})}{\Gamma(\alpha \mathrm{t})}\right] \xi^{\alpha \mathrm{t}-1} \mathrm{e}^{-\xi} \mathrm{d} \xi.
\end{aligned}
\]</span></p>
<p>由于<span class="math inline">\(\mathrm{f}_{\mathrm{T}}(\mathrm{t})\)</span> 相当复杂，因此一般用B-S分布来逼近：</p>
<p><span class="math display">\[
\mathrm{F}(t ; \ell)=\Phi\left[\frac{1}{\mathrm{v}}\left(\sqrt{\frac{\mathrm{t}}{\mathrm{u}}}-\sqrt{\frac{\mathrm{u}}{\mathrm{t}}}\right)\right], \quad \mathrm{t}&gt;0
\]</span> 其中, <span class="math inline">\(\Phi(\cdot)\)</span> 为标准正态分布, <span class="math inline">\(v=\sqrt{\frac{\beta}{\ell}}, u=\frac{\ell}{\beta \alpha}\)</span>. 相应的 PDF 为 <span class="math display">\[
\mathrm{f}(t ; \ell)=\frac{1}{2 \sqrt{2 \pi} \mathrm{uv}}\left[\left(\frac{\mathrm{u}}{\mathrm{t}}\right)^{\frac{1}{2}}+\left(\frac{\mathrm{u}}{\mathrm{t}}\right)^{\frac{3}{2}}\right] \exp \left[-\frac{1}{2 \mathrm{v}^2}\left(\frac{\mathrm{t}}{\mathrm{u}}-2+\frac{\mathrm{u}}{\mathrm{t}}\right)\right], \mathrm{t}&gt;0
\]</span></p>
</section>
<section id="剩余寿命" class="level4">
<h4 class="anchored" data-anchor-id="剩余寿命">剩余寿命</h4>
<p>根据Gamma 过程的增量独立性，可以得到剩余寿命的分布 <span class="math display">\[
\begin{aligned}
\mathrm{F}(t \mid s) &amp;=\mathrm{P}\left(\mathrm{T} \leqslant t \mid \mathrm{X}(s)=\mathrm{x}_{s}\right) \\
&amp;=\mathrm{P}\left(X(t)-X(s) \geqslant \ell-x_{s}\right) \\
&amp;=\frac{\Gamma\left(\alpha(t-s),\left(\ell-x_{s}\right) / \beta\right)}{\Gamma(\alpha(t-s))} .
\end{aligned}
\]</span> 这与将失效阈值由 <span class="math inline">\(\ell\)</span> 变为 <span class="math inline">\(\ell-{x_s}\)</span> 、时间 <span class="math inline">\(t\)</span> 变为 <span class="math inline">\(t-s\)</span> 情形的寿命分 布是一样的. 因此, 在给定当前状态情况下, 可以按照类似的途径更新剩余寿命.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="fu">library</span>(viridis)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="数据模拟产生-1" class="level4">
<h4 class="anchored" data-anchor-id="数据模拟产生-1">数据模拟产生</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)){</span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="co"># para 指 alpha,beta</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb36-6"><a href="#cb36-6"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb36-7"><a href="#cb36-7"></a>  dat <span class="ot">=</span> dat_unit <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb36-8"><a href="#cb36-8"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> dat_unit[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb36-9"><a href="#cb36-9"></a>  <span class="co"># dat_unit = numeric()</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb36-11"><a href="#cb36-11"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) {</span>
<span id="cb36-12"><a href="#cb36-12"></a>      dat_unit[j,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],para[<span class="dv">2</span>])</span>
<span id="cb36-13"><a href="#cb36-13"></a>      dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit[,i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb36-14"><a href="#cb36-14"></a>    }</span>
<span id="cb36-15"><a href="#cb36-15"></a>  }</span>
<span id="cb36-16"><a href="#cb36-16"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb36-17"><a href="#cb36-17"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb36-18"><a href="#cb36-18"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb36-19"><a href="#cb36-19"></a>  </span>
<span id="cb36-20"><a href="#cb36-20"></a>  dat_unit <span class="ot">=</span> <span class="fu">data.frame</span>(dat_unit)</span>
<span id="cb36-21"><a href="#cb36-21"></a>  dat_unit1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat_unit) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb36-22"><a href="#cb36-22"></a>  <span class="fu">colnames</span>(dat_unit1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb36-23"><a href="#cb36-23"></a>  </span>
<span id="cb36-24"><a href="#cb36-24"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dat1,dat_unit1)) <span class="co">#dat1是退化量,data_unit1是退化增量</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="绘制退化路径图" class="level5">
<h5 class="anchored" data-anchor-id="绘制退化路径图">绘制退化路径图</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb37-3"><a href="#cb37-3"></a>    <span class="co"># 画图</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb37-5"><a href="#cb37-5"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb37-6"><a href="#cb37-6"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb37-8"><a href="#cb37-8"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb37-9"><a href="#cb37-9"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb37-10"><a href="#cb37-10"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">print</span>(p)</span>
<span id="cb37-14"><a href="#cb37-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb38-5"><a href="#cb38-5"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat[[<span class="dv">1</span>]])) <span class="co">#print table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">Time</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.791423</td>
<td style="text-align: right;">2.717510</td>
<td style="text-align: right;">1.253738</td>
<td style="text-align: right;">1.786299</td>
<td style="text-align: right;">0.7544874</td>
<td style="text-align: right;">0.7572732</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6.281445</td>
<td style="text-align: right;">5.711784</td>
<td style="text-align: right;">3.178593</td>
<td style="text-align: right;">2.861755</td>
<td style="text-align: right;">1.3201696</td>
<td style="text-align: right;">2.0029512</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.068767</td>
<td style="text-align: right;">6.672868</td>
<td style="text-align: right;">5.768493</td>
<td style="text-align: right;">5.222086</td>
<td style="text-align: right;">3.1495223</td>
<td style="text-align: right;">5.6305481</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">10.163552</td>
<td style="text-align: right;">8.946103</td>
<td style="text-align: right;">6.755568</td>
<td style="text-align: right;">6.527556</td>
<td style="text-align: right;">5.1477654</td>
<td style="text-align: right;">6.7169847</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">11.075727</td>
<td style="text-align: right;">9.632637</td>
<td style="text-align: right;">8.726344</td>
<td style="text-align: right;">9.112670</td>
<td style="text-align: right;">8.5439986</td>
<td style="text-align: right;">7.7805742</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">plot_path</span>(dat[[<span class="dv">1</span>]]) <span class="co">#print path plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="参数估计" class="level4">
<h4 class="anchored" data-anchor-id="参数估计">参数估计</h4>
<section id="矩估计" class="level5">
<h5 class="anchored" data-anchor-id="矩估计">矩估计</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>gamma_moment <span class="ot">=</span> <span class="cf">function</span>(data_unit, group , t ){</span>
<span id="cb40-2"><a href="#cb40-2"></a></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="co"># 每组测量次数相同</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb40-5"><a href="#cb40-5"></a>  M <span class="ot">=</span> group<span class="sc">*</span><span class="fu">max</span>(t)</span>
<span id="cb40-6"><a href="#cb40-6"></a>  Rij <span class="ot">=</span> data_unit<span class="sc">/</span>delta_t</span>
<span id="cb40-7"><a href="#cb40-7"></a>  Rbar <span class="ot">=</span> <span class="fu">sum</span>(Rij)<span class="sc">/</span>M</span>
<span id="cb40-8"><a href="#cb40-8"></a>  MSR2 <span class="ot">=</span> <span class="fu">sum</span>((Rij<span class="sc">-</span>Rbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb40-9"><a href="#cb40-9"></a>  tt <span class="ot">=</span> group<span class="sc">*</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>delta_t)</span>
<span id="cb40-10"><a href="#cb40-10"></a>  moment_alp <span class="ot">=</span> Rbar<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>tt<span class="sc">/</span>MSR2</span>
<span id="cb40-11"><a href="#cb40-11"></a>  moment_beta <span class="ot">=</span> MSR2<span class="sc">/</span>(tt<span class="sc">*</span>Rbar)</span>
<span id="cb40-12"><a href="#cb40-12"></a>  </span>
<span id="cb40-13"><a href="#cb40-13"></a>  moment_par <span class="ot">=</span> <span class="fu">c</span>(moment_alp,moment_beta)</span>
<span id="cb40-14"><a href="#cb40-14"></a>  <span class="fu">return</span>(moment_par)</span>
<span id="cb40-15"><a href="#cb40-15"></a>  </span>
<span id="cb40-16"><a href="#cb40-16"></a>}</span>
<span id="cb40-17"><a href="#cb40-17"></a><span class="co"># 这里算出来beta的矩估计跟真值差距很大</span></span>
<span id="cb40-18"><a href="#cb40-18"></a><span class="co"># 注意如果用模拟数据产生的话，只保留增量数据,也要去掉第一行的0</span></span>
<span id="cb40-19"><a href="#cb40-19"></a><span class="co"># ？ 前面加上这么多只是为了画图好看，是不是可以删掉这些东西</span></span>
<span id="cb40-20"><a href="#cb40-20"></a>increment <span class="ot">=</span> dat[[<span class="dv">2</span>]]</span>
<span id="cb40-21"><a href="#cb40-21"></a>increment <span class="ot">=</span> increment[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb40-22"><a href="#cb40-22"></a>degradation <span class="ot">=</span> dat[[<span class="dv">1</span>]]</span>
<span id="cb40-23"><a href="#cb40-23"></a>degradation <span class="ot">=</span> degradation[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb40-24"><a href="#cb40-24"></a>  </span>
<span id="cb40-25"><a href="#cb40-25"></a>moment_par <span class="ot">=</span> <span class="fu">gamma_moment</span>(<span class="at">data_unit =</span> increment, <span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb40-26"><a href="#cb40-26"></a>moment_par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.8677416 0.5094526</code></pre>
</div>
</div>
</section>
<section id="极大似然估计-1" class="level5">
<h5 class="anchored" data-anchor-id="极大似然估计-1">极大似然估计</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">library</span>(BB)</span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a>gamma_alpmle <span class="ot">=</span> <span class="cf">function</span>(x, data_unit, data, t){</span>
<span id="cb42-4"><a href="#cb42-4"></a>    <span class="co">#x is alpha</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>    delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb42-6"><a href="#cb42-6"></a>    l <span class="ot">=</span> <span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">log</span>(data_unit))<span class="sc">-</span><span class="fu">sum</span>(t<span class="sc">*</span><span class="fu">log</span>(data<span class="sc">/</span>(x<span class="sc">*</span>t)))<span class="sc">-</span><span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">digamma</span>(x<span class="sc">*</span>delta_t))</span>
<span id="cb42-7"><a href="#cb42-7"></a>    <span class="fu">return</span>(l)</span>
<span id="cb42-8"><a href="#cb42-8"></a>}</span>
<span id="cb42-9"><a href="#cb42-9"></a></span>
<span id="cb42-10"><a href="#cb42-10"></a>startx <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb42-11"><a href="#cb42-11"></a>mle_re <span class="ot">=</span> <span class="fu">dfsane</span>(startx,gamma_alpmle,<span class="at">data_unit =</span> increment, <span class="at">data =</span> degradation, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span><span class="dv">2500</span>,<span class="at">trace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb42-12"><a href="#cb42-12"></a></span>
<span id="cb42-13"><a href="#cb42-13"></a>mle_re</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 1.759257

$residual
[1] 6.318635e-08

$fn.reduction
[1] 67291

$feval
[1] 8

$iter
[1] 7

$convergence
[1] 0

$message
[1] "Successful convergence"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>mle_alp <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb44-2"><a href="#cb44-2"></a>mle_beta <span class="ot">=</span> <span class="fu">sum</span>(increment)<span class="sc">/</span>(mle_alp<span class="sc">*</span>group<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb44-3"><a href="#cb44-3"></a>mle_par <span class="ot">=</span> <span class="fu">c</span>(mle_alp,mle_beta)</span>
<span id="cb44-4"><a href="#cb44-4"></a></span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co"># mle_re = uniroot(gamma_alpmle, data_unit = increment, data = degradation, t = 1:200, lower = 1, upper = 100, tol = 1e-15, maxiter = 10000)</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># </span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co"># mle_alp = mle_re$root</span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co"># mle_beta = sum(increment)/(mle_alp*group*max(t))</span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co"># mle_par = c(mle_alp,mle_beta)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="do">## 可靠度计算</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>gamma_R <span class="ot">=</span> <span class="cf">function</span>(t, threshold,par){</span>
<span id="cb45-3"><a href="#cb45-3"></a>  alp <span class="ot">=</span> par[<span class="dv">1</span>]</span>
<span id="cb45-4"><a href="#cb45-4"></a>  beta <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb45-5"><a href="#cb45-5"></a>  v <span class="ot">=</span> <span class="fu">sqrt</span>(beta<span class="sc">/</span>threshold)</span>
<span id="cb45-6"><a href="#cb45-6"></a>  u <span class="ot">=</span> threshold<span class="sc">/</span>(alp<span class="sc">*</span>beta)</span>
<span id="cb45-7"><a href="#cb45-7"></a>  R <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>((<span class="fu">sqrt</span>(t<span class="sc">/</span>u)<span class="sc">-</span><span class="fu">sqrt</span>(u<span class="sc">/</span>t))<span class="sc">/</span>v) </span>
<span id="cb45-8"><a href="#cb45-8"></a>  <span class="fu">return</span>(R)</span>
<span id="cb45-9"><a href="#cb45-9"></a>}</span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="dv">70</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.834246</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># plot(gamma_R(t = 1:300, threshold = 150,par = mle_par),type = "l")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="案例分析-1" class="level3">
<h3 class="anchored" data-anchor-id="案例分析-1">4.2 案例分析</h3>
<p>导入数据，数据来源于<a href="https://c3.ndc.nasa.gov/dashlink/resources/133/">NASA Ames Prognostics Center of Excellence (PCoE)</a>，但是找不到数据下载。最后是通过 <a href="https://github.com/psanabriaUC/BatteryDatasetImplementation">Github</a> 获得。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">head</span>(liion_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Voltage_measured Current_measured Temperature_measured Current_charge
1         3.974871        -2.012528             24.38909         1.9982
2         3.951717        -2.013979             24.54475         1.9982
3         3.934352        -2.011144             24.73139         1.9982
4         3.920058        -2.013007             24.90982         1.9982
5         3.907904        -2.014400             25.10588         1.9982
6         3.897036        -2.011603             25.31702         1.9982
  Voltage_charge    Time Capacity id_cycle      type ambient_temperature time
1          3.062  35.703 1.856487        1 discharge                  24 2008
2          3.030  53.781 1.856487        1 discharge                  24 2008
3          3.011  71.922 1.856487        1 discharge                  24 2008
4          2.991  90.094 1.856487        1 discharge                  24 2008
5          2.977 108.281 1.856487        1 discharge                  24 2008
6          2.967 126.453 1.856487        1 discharge                  24 2008
  Battery
1   B0005
2   B0005
3   B0005
4   B0005
5   B0005
6   B0005</code></pre>
</div>
</div>
<p>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即<strong>充电</strong>、<strong>放电</strong>和<strong>测量 EIS</strong>。</p>
<p>充电是以<strong>恒流模</strong>式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以<strong>恒压模式</strong>(CV)继续充电直到电流降到 20mA。</p>
<p>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</p>
<p>重复充电和放电降导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用Gamma来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb52-2"><a href="#cb52-2"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb52-3"><a href="#cb52-3"></a></span>
<span id="cb52-4"><a href="#cb52-4"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb52-5"><a href="#cb52-5"></a></span>
<span id="cb52-6"><a href="#cb52-6"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-7"><a href="#cb52-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb52-8"><a href="#cb52-8"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb52-9"><a href="#cb52-9"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb52-12"><a href="#cb52-12"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb52-13"><a href="#cb52-13"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>前面对数据进行了导入、处理以及可视化。接下来，使用经典的Gamma过程对其进行建模。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb53-4"><a href="#cb53-4"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb53-5"><a href="#cb53-5"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb53-6"><a href="#cb53-6"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">library</span>(BB)</span>
<span id="cb54-2"><a href="#cb54-2"></a>gamma_alpmle <span class="ot">=</span> <span class="cf">function</span>(x, data_unit, data, t){</span>
<span id="cb54-3"><a href="#cb54-3"></a>    <span class="co">#x is alpha</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>    delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb54-5"><a href="#cb54-5"></a>    l <span class="ot">=</span> <span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">log</span>(data_unit))<span class="sc">-</span><span class="fu">sum</span>(t<span class="sc">*</span><span class="fu">log</span>(data<span class="sc">/</span>(x<span class="sc">*</span>t)))<span class="sc">-</span><span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">digamma</span>(x<span class="sc">*</span>delta_t))</span>
<span id="cb54-6"><a href="#cb54-6"></a>    <span class="fu">return</span>(l)</span>
<span id="cb54-7"><a href="#cb54-7"></a>}</span>
<span id="cb54-8"><a href="#cb54-8"></a></span>
<span id="cb54-9"><a href="#cb54-9"></a>degradation <span class="ot">=</span> liion_new[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb54-10"><a href="#cb54-10"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(degradation)</span>
<span id="cb54-11"><a href="#cb54-11"></a>epoch <span class="ot">=</span> <span class="fu">nrow</span>(degradation)</span>
<span id="cb54-12"><a href="#cb54-12"></a>increment <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch<span class="dv">-1</span>,group)</span>
<span id="cb54-13"><a href="#cb54-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb54-14"><a href="#cb54-14"></a>  dd <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(degradation[,i]))</span>
<span id="cb54-15"><a href="#cb54-15"></a>  increment[,i] <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">diff</span>(dd))</span>
<span id="cb54-16"><a href="#cb54-16"></a>}</span>
<span id="cb54-17"><a href="#cb54-17"></a></span>
<span id="cb54-18"><a href="#cb54-18"></a><span class="co"># 这里跟初值影响很大</span></span>
<span id="cb54-19"><a href="#cb54-19"></a>startx <span class="ot">=</span> <span class="fl">1.2</span></span>
<span id="cb54-20"><a href="#cb54-20"></a>mle_re <span class="ot">=</span> <span class="fu">dfsane</span>(startx,gamma_alpmle,<span class="at">data_unit =</span> increment, <span class="at">data =</span> degradation, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>epoch, <span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span><span class="dv">2500</span>,<span class="at">trace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb54-21"><a href="#cb54-21"></a></span>
<span id="cb54-22"><a href="#cb54-22"></a>mle_alp <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb54-23"><a href="#cb54-23"></a>mle_beta <span class="ot">=</span> <span class="fu">sum</span>(increment)<span class="sc">/</span>(mle_alp<span class="sc">*</span>group<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb54-24"><a href="#cb54-24"></a>mle_par <span class="ot">=</span> <span class="fu">c</span>(mle_alp,mle_beta)</span>
<span id="cb54-25"><a href="#cb54-25"></a></span>
<span id="cb54-26"><a href="#cb54-26"></a></span>
<span id="cb54-27"><a href="#cb54-27"></a><span class="co">#这里要先试出这个函数的上下界，并且增量不应该出现复数</span></span>
<span id="cb54-28"><a href="#cb54-28"></a><span class="co"># gamma_alpmle(1, data_unit = increment, data = degradation, t = 1:epoch)</span></span>
<span id="cb54-29"><a href="#cb54-29"></a></span>
<span id="cb54-30"><a href="#cb54-30"></a><span class="co"># mle_re = uniroot(gamma_alpmle, data_unit = increment, data = degradation, t = 1:epoch, lower = 0.0000001, upper = 100, tol = 1e-15, maxiter = 10000)</span></span>
<span id="cb54-31"><a href="#cb54-31"></a><span class="co"># </span></span>
<span id="cb54-32"><a href="#cb54-32"></a><span class="co"># mle_alp = mle_re$root</span></span>
<span id="cb54-33"><a href="#cb54-33"></a><span class="co"># mle_beta = sum(increment)/(mle_alp*group*max(t))</span></span>
<span id="cb54-34"><a href="#cb54-34"></a><span class="co"># mle_par = c(mle_alp,mle_beta)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>计算可靠度并绘图</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># 计算可靠度</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="fl">0.05</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>time_region <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb57-5"><a href="#cb57-5"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb57-6"><a href="#cb57-6"></a>}</span>
<span id="cb57-7"><a href="#cb57-7"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb57-8"><a href="#cb57-8"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb57-9"><a href="#cb57-9"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb57-10"><a href="#cb57-10"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb57-11"><a href="#cb57-11"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb57-12"><a href="#cb57-12"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-13"><a href="#cb57-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb57-15"><a href="#cb57-15"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb58" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb58-1"><a href="#cb58-1"></a><span class="co">---</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="an">title:</span><span class="co"> "退化过程模型综述"</span></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="an">author:</span><span class="co"> "庄亮亮、吴温慧"</span></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="co">  html:</span></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="co">    toc: TRUE</span></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="co">    toc-title: "目录"</span></span>
<span id="cb58-9"><a href="#cb58-9"></a><span class="co">    theme: cerulean</span></span>
<span id="cb58-10"><a href="#cb58-10"></a><span class="co">    code-tools: true</span></span>
<span id="cb58-11"><a href="#cb58-11"></a><span class="co">    highlight-style: cerulean.theme</span></span>
<span id="cb58-12"><a href="#cb58-12"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb58-13"><a href="#cb58-13"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb58-14"><a href="#cb58-14"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb58-15"><a href="#cb58-15"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb58-16"><a href="#cb58-16"></a><span class="co">  chunk_output_type: inline</span></span>
<span id="cb58-17"><a href="#cb58-17"></a><span class="co">---</span></span>
<span id="cb58-18"><a href="#cb58-18"></a></span>
<span id="cb58-19"><a href="#cb58-19"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb58-20"><a href="#cb58-20"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-21"><a href="#cb58-21"></a><span class="in">```</span></span>
<span id="cb58-22"><a href="#cb58-22"></a></span>
<span id="cb58-23"><a href="#cb58-23"></a><span class="fu">## 1. 介绍</span></span>
<span id="cb58-24"><a href="#cb58-24"></a></span>
<span id="cb58-25"><a href="#cb58-25"></a>近年来，基于退化的可靠性技术在模型、方法和应用等方面得到快速发展。其中，在**基于退化的可靠性模型**方面，以随机过程理论为基础，根据工程需要，并考虑模型的简明性、实用性和适用性，已经提出了多种类型的模型，包括：</span>
<span id="cb58-26"><a href="#cb58-26"></a></span>
<span id="cb58-27"><a href="#cb58-27"></a><span class="ss">1.  </span>退化轨道模型（如 Paris 模型、随机斜率/截距模型、幂律模型、反应论模型）</span>
<span id="cb58-28"><a href="#cb58-28"></a></span>
<span id="cb58-29"><a href="#cb58-29"></a><span class="ss">2.  </span>基于 Wiener 过程的模型</span>
<span id="cb58-30"><a href="#cb58-30"></a></span>
<span id="cb58-31"><a href="#cb58-31"></a><span class="ss">3.  </span>基于 Gamma 过程的模型</span>
<span id="cb58-32"><a href="#cb58-32"></a></span>
<span id="cb58-33"><a href="#cb58-33"></a><span class="ss">4.  </span>累积损伤模型(主要是基于混合 Poisson 过程的模型）</span>
<span id="cb58-34"><a href="#cb58-34"></a></span>
<span id="cb58-35"><a href="#cb58-35"></a><span class="ss">5.  </span>更为一般的纯跳过程模型（如Levy.过程模利）和扩散过程模型（如随机微分方程模型）等。</span>
<span id="cb58-36"><a href="#cb58-36"></a></span>
<span id="cb58-37"><a href="#cb58-37"></a>在基于退化的可靠性建模方法，以数理统计理论为基础，针对模型和退化数据的类型，研究**矩估计、极大似估计及 EM 算法、Bayes 估计及 MCMC算法、基于滤波的状态估计方法**，以及**非参数和半参数方法**等，解决模型辨识和修正问题;</span>
<span id="cb58-38"><a href="#cb58-38"></a></span>
<span id="cb58-39"><a href="#cb58-39"></a>采用**似然比检验、Bayes 因子分析**等方法进行模型验证;</span>
<span id="cb58-40"><a href="#cb58-40"></a></span>
<span id="cb58-41"><a href="#cb58-41"></a>采用**均方误差（MSE）、Akaike 信息准则(AIC)、Bayes 信息准则(BIC)、偏差信息准则(DIC)**等进行模型优良性检验。</span>
<span id="cb58-42"><a href="#cb58-42"></a></span>
<span id="cb58-43"><a href="#cb58-43"></a>在基于退化的可靠性技术应用方面，针对**机械零部件（如轴承、润滑系统）、半导体器件（如功率MOS器件）、机电部件（如感应电动机）、光电器件(如太阳电池、激光器、LED)、电子器件（如电容、蓄电池）**等的退化失效过程，开展**退化过程建模、可靠性评估、剩余寿命预测、可靠性试验设计**：特别是加速退化试验方案设计的研究。</span>
<span id="cb58-44"><a href="#cb58-44"></a></span>
<span id="cb58-45"><a href="#cb58-45"></a><span class="fu">## 2. 退化轨道模型</span></span>
<span id="cb58-46"><a href="#cb58-46"></a></span>
<span id="cb58-47"><a href="#cb58-47"></a><span class="at">&gt; 暂时不考虑</span></span>
<span id="cb58-48"><a href="#cb58-48"></a></span>
<span id="cb58-49"><a href="#cb58-49"></a><span class="fu">## 3. Wiener 退化过程模型</span></span>
<span id="cb58-50"><a href="#cb58-50"></a></span>
<span id="cb58-51"><a href="#cb58-51"></a>Wiener 过程由于其简单的结构和比较丰富的研究成果，成为目前退化过程建模中 应用最为广泛的一种模型。</span>
<span id="cb58-52"><a href="#cb58-52"></a></span>
<span id="cb58-53"><a href="#cb58-53"></a>Wiener 退化过程的**首达时间分布具有解析形式**，便于对**产品寿命**和**可靠度**的分析和计算。</span>
<span id="cb58-54"><a href="#cb58-54"></a></span>
<span id="cb58-55"><a href="#cb58-55"></a>Wiener 退化过程可以描述产品退化过程的时间不确定性，而且比较容易处理测量数据存在误差的情况。</span>
<span id="cb58-56"><a href="#cb58-56"></a></span>
<span id="cb58-57"><a href="#cb58-57"></a>通过对经典 Wiener 过程的参数引入**随机性**，使得 Wiener 退化过程能够描述个体差异，并且一般不会给模型参数的估计带来更多的困难。</span>
<span id="cb58-58"><a href="#cb58-58"></a></span>
<span id="cb58-59"><a href="#cb58-59"></a><span class="at">&gt; 对 Wiener 退化过程及其观测过程所构成的**状态空间模型**，可以采用 **Kalman 滤波技术**进行处理，为产品**在线寿命预测、视情维修决策**等提供了可行的算法和实现途径。</span></span>
<span id="cb58-60"><a href="#cb58-60"></a></span>
<span id="cb58-61"><a href="#cb58-61"></a><span class="fu">### 3.1 带漂移的 Wiener 过程</span></span>
<span id="cb58-62"><a href="#cb58-62"></a></span>
<span id="cb58-63"><a href="#cb58-63"></a>称 $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 是漂移参数为 $\mu$ 、扩散参数为 $\sigma$ 的 (一元) Wiener 过程, 若</span>
<span id="cb58-64"><a href="#cb58-64"></a></span>
<span id="cb58-65"><a href="#cb58-65"></a>(1) $X(0)=0$。</span>
<span id="cb58-66"><a href="#cb58-66"></a></span>
<span id="cb58-67"><a href="#cb58-67"></a>(2) $<span class="sc">\{</span>X(t), t \geqslant 0<span class="sc">\}</span>$ 有平稳独立增量。</span>
<span id="cb58-68"><a href="#cb58-68"></a></span>
<span id="cb58-69"><a href="#cb58-69"></a>(3) $X(t)$ 服从均值为 $\mu t$,方差为 $\sigma^2 t$ 的正态分布。</span>
<span id="cb58-70"><a href="#cb58-70"></a></span>
<span id="cb58-71"><a href="#cb58-71"></a>根据上面的定义, 可以将带漂移的 Wiener 过程表示为下面的形式: $$</span>
<span id="cb58-72"><a href="#cb58-72"></a>X(t)=\mu t+\sigma B(t)</span>
<span id="cb58-73"><a href="#cb58-73"></a>$$ 式中: $<span class="sc">\{</span>B(t)<span class="sc">\}</span>, t \geqslant 0$ 是标准 Wiener 过程或标准布朗运动过程。</span>
<span id="cb58-74"><a href="#cb58-74"></a></span>
<span id="cb58-75"><a href="#cb58-75"></a>根据定义, 对带漂移的 Wiener 过程, 显然有如下的性质成立:</span>
<span id="cb58-76"><a href="#cb58-76"></a></span>
<span id="cb58-77"><a href="#cb58-77"></a>（1）时刻 $t \sim t+\Delta t$ 之间的增量服从正态分布, 即 $\Delta X=X(t+\Delta t)-X(t) \sim$ $N\left(\mu \Delta t, \sigma^2 \Delta t\right)$ 。</span>
<span id="cb58-78"><a href="#cb58-78"></a></span>
<span id="cb58-79"><a href="#cb58-79"></a>(2) 对任意两个不相交的时间区间 $\left<span class="co">[</span><span class="ot">t_1, t_2\right</span><span class="co">]</span>,\left<span class="co">[</span><span class="ot">t_3, t_4\right</span><span class="co">]</span>, t_1<span class="kw">&lt;t_2</span> <span class="er">\leqslant</span> <span class="er">t_3&lt;t_4$,</span> <span class="er">增量</span> <span class="er">$X\left(t_4\right)-X$</span> <span class="er">$\left(t_3\right)$</span> <span class="er">与</span> <span class="er">$X\left(t_2\right)-X\left(t_1\right)$</span> <span class="er">相互独立。</span></span>
<span id="cb58-80"><a href="#cb58-80"></a></span>
<span id="cb58-81"><a href="#cb58-81"></a><span class="er">如果产品的性能退化过程是一元</span> <span class="er">Wiener</span> <span class="er">过程,假设其运行到时刻</span> <span class="er">$\tau$</span> <span class="er">仍末失效,</span> <span class="er">且</span> <span class="er">当前性能退化量为</span> <span class="er">$x_\tau\left(x_\tau&lt;l\right)$,</span> <span class="er">则产品的剩余寿命</span> <span class="er">$T_1$</span> <span class="er">可以表示为</span> <span class="er">$$</span></span>
<span id="cb58-82"><a href="#cb58-82"></a><span class="ot">T_1=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)</span> <span class="er">\geqslant</span> <span class="er">l,</span> <span class="er">X(\tau)</span><span class="ot">=</span><span class="st">x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb58-83"><a href="#cb58-83"></a><span class="er">$$</span> <span class="er">由一元</span> <span class="er">Wiener</span> <span class="er">过程的独立增量性质和齐次马尔可夫性得到</span> <span class="er">$$</span></span>
<span id="cb58-84"><a href="#cb58-84"></a><span class="er">\begin{aligned}</span></span>
<span id="cb58-85"><a href="#cb58-85"></a><span class="ot">T_1</span> <span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t+\tau)-X(\tau)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span> <span class="er">\\</span></span>
<span id="cb58-86"><a href="#cb58-86"></a><span class="er">&amp;</span><span class="ot">=</span><span class="st">\inf</span> <span class="er">\left\{t</span> <span class="er">\mid</span> <span class="er">X(t)</span> <span class="er">\geqslant</span> <span class="er">l-x_\tau,</span> <span class="er">t</span> <span class="er">\geqslant</span> <span class="er">0\right\}</span></span>
<span id="cb58-87"><a href="#cb58-87"></a><span class="er">\end{aligned}</span></span>
<span id="cb58-88"><a href="#cb58-88"></a><span class="er">$$</span> <span class="er">可知剩余寿命</span> <span class="er">$T_1$</span> <span class="er">也是逆</span> <span class="er">Gaussian</span> <span class="er">分布,</span> <span class="er">其密度函数只需将寿命</span> <span class="er">$T$</span> <span class="er">密度函数中的失效阈值</span> <span class="er">$l$</span> <span class="er">替换为</span> <span class="er">$l-x_\tau$,</span> <span class="er">即</span> <span class="er">$$f_{T_1}(t)</span><span class="ot">=</span><span class="st">\frac{l-x_\tau}{\sqrt{2</span> <span class="er">\pi</span> <span class="er">\sigma^2</span> <span class="er">t^3}}</span> <span class="er">\exp</span> <span class="er">\left[-\frac{\left(l-x_\tau-\mu</span> <span class="er">t\right)^2}{2</span> <span class="er">\sigma^2</span> <span class="er">t}\right]$$</span></span>
<span id="cb58-89"><a href="#cb58-89"></a></span>
<span id="cb58-92"><a href="#cb58-92"></a><span class="in">```{r}</span></span>
<span id="cb58-93"><a href="#cb58-93"></a><span class="ot">library</span><span class="er">(ggplot2)</span></span>
<span id="cb58-94"><a href="#cb58-94"></a><span class="ot">library</span><span class="er">(tidyverse)</span></span>
<span id="cb58-95"><a href="#cb58-95"></a><span class="ot">library</span><span class="er">(viridis)</span></span>
<span id="cb58-96"><a href="#cb58-96"></a><span class="er">```</span></span>
<span id="cb58-97"><a href="#cb58-97"></a></span>
<span id="cb58-98"><a href="#cb58-98"></a><span class="ot">#</span><span class="er">###</span> <span class="er">3.1.1</span> <span class="er">数据模拟产生</span></span>
<span id="cb58-99"><a href="#cb58-99"></a></span>
<span id="cb58-102"><a href="#cb58-102"></a><span class="in">```{r}</span></span>
<span id="cb58-103"><a href="#cb58-103"></a><span class="ot">#</span> <span class="er">数据模拟产生</span></span>
<span id="cb58-104"><a href="#cb58-104"></a><span class="ot">sim_dat</span> <span class="ot">=</span> <span class="st">function(group</span> <span class="ot">=</span> <span class="st">6,</span> <span class="er">t</span> <span class="ot">=</span> <span class="st">1:200,</span> <span class="er">para</span> <span class="ot">=</span> <span class="st">c(1,0.1)){</span></span>
<span id="cb58-105"><a href="#cb58-105"></a><span class="ot">  #</span> <span class="er">para</span> <span class="er">指</span> <span class="er">mu,sigma</span></span>
<span id="cb58-106"><a href="#cb58-106"></a><span class="ot">  #</span> <span class="er">epoch</span> <span class="er">指测量次数，</span> <span class="er">group</span> <span class="er">指组数</span></span>
<span id="cb58-107"><a href="#cb58-107"></a><span class="ot">  delta_t</span> <span class="ot">=</span> <span class="st">diff(t)</span></span>
<span id="cb58-108"><a href="#cb58-108"></a><span class="ot">  epoch</span> <span class="ot">=</span> <span class="st">length(delta_t)</span></span>
<span id="cb58-109"><a href="#cb58-109"></a><span class="ot">  dat</span> <span class="ot">=</span> <span class="st">matrix(NA,epoch,group+1)</span></span>
<span id="cb58-110"><a href="#cb58-110"></a><span class="ot">  dat</span><span class="er">[,1]</span> <span class="ot">=</span> <span class="st">seq(1,epoch)</span></span>
<span id="cb58-111"><a href="#cb58-111"></a><span class="ot">  dat_unit</span> <span class="ot">=</span> <span class="st">numeric()</span></span>
<span id="cb58-112"><a href="#cb58-112"></a><span class="ot">  for</span><span class="er">(i</span> <span class="er">in</span> <span class="er">1:group){</span></span>
<span id="cb58-113"><a href="#cb58-113"></a><span class="ot">    for</span><span class="er">(j</span> <span class="er">in</span> <span class="er">1:epoch)</span> <span class="er">dat_unit[j]</span> <span class="ot">=</span> <span class="st">rnorm(1,para[1]*delta_t[j],sqrt(para[2]^2*delta_t[j]))</span></span>
<span id="cb58-114"><a href="#cb58-114"></a><span class="ot">    dat</span><span class="er">[,i+1]</span> <span class="ot">=</span> <span class="st">cumsum(dat_unit)</span></span>
<span id="cb58-115"><a href="#cb58-115"></a>  <span class="er">}</span></span>
<span id="cb58-116"><a href="#cb58-116"></a><span class="ot">  dat</span> <span class="ot">=</span> <span class="st">data.frame(dat)</span></span>
<span id="cb58-117"><a href="#cb58-117"></a><span class="ot">  dat1</span> <span class="ot">=</span> <span class="st">rbind(rep(0,group+1),dat)</span> <span class="er">#</span> <span class="er">加入初始值绘制点</span></span>
<span id="cb58-118"><a href="#cb58-118"></a><span class="ot">  colnames</span><span class="er">(dat1)</span> <span class="ot">=</span> <span class="st">c(</span><span class="er">"Time",paste(1:group,sep</span><span class="ot">=</span><span class="st">''</span><span class="er">))</span></span>
<span id="cb58-119"><a href="#cb58-119"></a><span class="ot">  return</span><span class="er">(dat1)</span></span>
<span id="cb58-120"><a href="#cb58-120"></a><span class="er">}</span></span>
<span id="cb58-121"><a href="#cb58-121"></a><span class="er">```</span></span>
<span id="cb58-122"><a href="#cb58-122"></a></span>
<span id="cb58-123"><a href="#cb58-123"></a><span class="er">绘制退化路径图</span></span>
<span id="cb58-124"><a href="#cb58-124"></a></span>
<span id="cb58-127"><a href="#cb58-127"></a><span class="in">```{r}</span></span>
<span id="cb58-128"><a href="#cb58-128"></a><span class="ot">#</span> <span class="er">绘制退化路径图</span></span>
<span id="cb58-129"><a href="#cb58-129"></a><span class="ot">plot_path</span> <span class="ot">=</span> <span class="st">function(data</span> <span class="ot">=</span> <span class="st">dat1){</span></span>
<span id="cb58-130"><a href="#cb58-130"></a><span class="ot">    #</span> <span class="er">画图</span></span>
<span id="cb58-131"><a href="#cb58-131"></a><span class="ot">  p</span> <span class="ot">=</span> <span class="st">data</span> <span class="er">%</span><span class="kw">&gt;</span>% pivot_longer(paste(1:group), </span>
<span id="cb58-132"><a href="#cb58-132"></a>                       names_to = "Group", </span>
<span id="cb58-133"><a href="#cb58-133"></a>                       values_to = "y") %&gt;% </span>
<span id="cb58-134"><a href="#cb58-134"></a>    ggplot(aes(Time,y,color = Group)) + </span>
<span id="cb58-135"><a href="#cb58-135"></a>    geom_line() + </span>
<span id="cb58-136"><a href="#cb58-136"></a>    scale_color_viridis(discrete = T) + </span>
<span id="cb58-137"><a href="#cb58-137"></a>    ylab("Degradation") #+</span>
<span id="cb58-138"><a href="#cb58-138"></a>    #theme_bw() +</span>
<span id="cb58-139"><a href="#cb58-139"></a>    #theme(panel.grid = element_blank())</span>
<span id="cb58-140"><a href="#cb58-140"></a>  print(p)</span>
<span id="cb58-141"><a href="#cb58-141"></a>}</span>
<span id="cb58-142"><a href="#cb58-142"></a><span class="in">```</span></span>
<span id="cb58-143"><a href="#cb58-143"></a></span>
<span id="cb58-146"><a href="#cb58-146"></a><span class="in">```{r}</span></span>
<span id="cb58-147"><a href="#cb58-147"></a><span class="in">group = 6</span></span>
<span id="cb58-148"><a href="#cb58-148"></a><span class="in">t = 1:200</span></span>
<span id="cb58-149"><a href="#cb58-149"></a><span class="in">para = c(1,1)</span></span>
<span id="cb58-150"><a href="#cb58-150"></a><span class="in">dat = sim_dat(group = group, t = t, para = para)</span></span>
<span id="cb58-151"><a href="#cb58-151"></a><span class="in">knitr::kable(head(dat))</span></span>
<span id="cb58-152"><a href="#cb58-152"></a><span class="in">plot_path(dat)</span></span>
<span id="cb58-153"><a href="#cb58-153"></a><span class="in">```</span></span>
<span id="cb58-154"><a href="#cb58-154"></a></span>
<span id="cb58-155"><a href="#cb58-155"></a><span class="fu">#### 3.1.2 统计推断</span></span>
<span id="cb58-156"><a href="#cb58-156"></a></span>
<span id="cb58-157"><a href="#cb58-157"></a>假设共有 $n$ 个样品进行性能退化试验。样品 $i$ 初始时刻 $t_{i 0}$ 退化量取值为 $X_{i 0}=0$, 在 时刻 $t_{i 1}, \cdots, t_{i m_i}$ 样品 $i$ 退化量为 $X_{i 1}, \cdots, X_{i m_i}$ 。记 $\Delta X_{i j}=X_{i j}-X_{i, j-1}$ 是样品 $i$ 在时刻 $t_{i, j-1} \sim t_{i j}$ 之间的退化增量, $\Delta t_{i j}=t_{i j}-t_{i j-1}, j=1,2, \cdots, m_i, i=1,2, \cdots, n$ 为各样品的测量间隔。</span>
<span id="cb58-158"><a href="#cb58-158"></a></span>
<span id="cb58-159"><a href="#cb58-159"></a><span class="fu">##### 3.1.2.1 极大似然估计</span></span>
<span id="cb58-160"><a href="#cb58-160"></a></span>
<span id="cb58-161"><a href="#cb58-161"></a>在简单情形, 认为退化数据的测量不存在误差, 并且总体退化过程不存在随机效应。由 Wiener 过程的性质, 容易知道 $$</span>
<span id="cb58-162"><a href="#cb58-162"></a>\Delta X_{i j} \sim N\left(\mu \Delta t_{i j}, \sigma^2 \Delta t_{i j}\right)</span>
<span id="cb58-163"><a href="#cb58-163"></a>$$</span>
<span id="cb58-164"><a href="#cb58-164"></a></span>
<span id="cb58-165"><a href="#cb58-165"></a>于是由退化数据 $X_{i j}=x_{i j}$ (等价的, $\Delta X_{i j}=\Delta x_{i j}$ ) $, j=1,2, \cdots, m_i, i=1,2, \cdots, n$, 得到模型参数的似然函数为 $$</span>
<span id="cb58-166"><a href="#cb58-166"></a>L\left(\mu, \sigma^2\right)=\prod_{i=1}^n \prod_{j=1}^{m_i} \frac{1}{\sqrt{2 \sigma^2 \pi \Delta t_{i j}}} \exp \left<span class="co">[</span><span class="ot">-\frac{\left(\Delta x_{i j}-\mu \Delta t_{i j}\right)^2}{2 \sigma^2 \Delta t_{i j}}\right</span><span class="co">]</span></span>
<span id="cb58-167"><a href="#cb58-167"></a>$$ 由式可以直接求得漂移参数 $\mu$ 和扩散参数 $\sigma^2$ 的极大似然估计如下: $$</span>
<span id="cb58-168"><a href="#cb58-168"></a>\hat{\mu}=\frac{\sum_{i=1}^n X_{i m_i}}{\sum_{i=1}^n t_{i m_i}}, \hat{\sigma}^2=\frac{1}{\sum_{i=1}^n m_i}\left<span class="co">[</span><span class="ot">\sum_{i=1}^n \sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{\left(\sum_{i=1}^n X_{i m_i}\right)^2}{\sum_{i=1}^n t_{i m_i}}\right</span><span class="co">]</span></span>
<span id="cb58-169"><a href="#cb58-169"></a>$$</span>
<span id="cb58-170"><a href="#cb58-170"></a></span>
<span id="cb58-173"><a href="#cb58-173"></a><span class="in">```{r}</span></span>
<span id="cb58-174"><a href="#cb58-174"></a>cumsub <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb58-175"><a href="#cb58-175"></a>  <span class="co">#完成逐个相减功能，类似cumsum</span></span>
<span id="cb58-176"><a href="#cb58-176"></a>  re <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb58-177"><a href="#cb58-177"></a>  re[<span class="dv">1</span>] <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb58-178"><a href="#cb58-178"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb58-179"><a href="#cb58-179"></a>    re[i] <span class="ot">=</span> x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb58-180"><a href="#cb58-180"></a>  }</span>
<span id="cb58-181"><a href="#cb58-181"></a>  <span class="fu">return</span>(re)</span>
<span id="cb58-182"><a href="#cb58-182"></a>}</span>
<span id="cb58-183"><a href="#cb58-183"></a><span class="in">```</span></span>
<span id="cb58-184"><a href="#cb58-184"></a></span>
<span id="cb58-187"><a href="#cb58-187"></a><span class="in">```{r}</span></span>
<span id="cb58-188"><a href="#cb58-188"></a>Weiner_mle <span class="ot">=</span> <span class="cf">function</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">data =</span> dat){</span>
<span id="cb58-189"><a href="#cb58-189"></a>  <span class="co"># 输入：mu，sigma，数据</span></span>
<span id="cb58-190"><a href="#cb58-190"></a>  <span class="co"># 输出：负对数似然函数</span></span>
<span id="cb58-191"><a href="#cb58-191"></a>  mu <span class="ot">=</span> par[<span class="dv">1</span>]; sigma <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb58-192"><a href="#cb58-192"></a>  group <span class="ot">=</span> <span class="fu">ncol</span>(data) <span class="sc">-</span> <span class="dv">1</span>;time <span class="ot">=</span> data[,<span class="dv">1</span>];y <span class="ot">=</span> data[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb58-193"><a href="#cb58-193"></a>  <span class="co"># 差分得到delta_time和delta_y</span></span>
<span id="cb58-194"><a href="#cb58-194"></a>  delta_time <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">diff</span>(time),group),<span class="fu">length</span>(<span class="fu">diff</span>(time)),group)</span>
<span id="cb58-195"><a href="#cb58-195"></a>  delta_y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(delta_time),group)</span>
<span id="cb58-196"><a href="#cb58-196"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group) delta_y[,i] <span class="ot">=</span> <span class="fu">cumsub</span>(y[,i])</span>
<span id="cb58-197"><a href="#cb58-197"></a></span>
<span id="cb58-198"><a href="#cb58-198"></a>  logl <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(delta_time)) <span class="sc">-</span> group<span class="sc">*</span><span class="fu">nrow</span>(delta_time)<span class="sc">*</span><span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>((delta_y <span class="sc">-</span> mu <span class="sc">*</span> delta_time)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>delta_time),<span class="at">na.rm =</span>T)</span>
<span id="cb58-199"><a href="#cb58-199"></a></span>
<span id="cb58-200"><a href="#cb58-200"></a>  <span class="fu">return</span>(<span class="sc">-</span>logl)</span>
<span id="cb58-201"><a href="#cb58-201"></a>}</span>
<span id="cb58-202"><a href="#cb58-202"></a></span>
<span id="cb58-203"><a href="#cb58-203"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb58-204"><a href="#cb58-204"></a>      <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-205"><a href="#cb58-205"></a><span class="co"># mle_re</span></span>
<span id="cb58-206"><a href="#cb58-206"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb58-207"><a href="#cb58-207"></a><span class="co"># 区间估计</span></span>
<span id="cb58-208"><a href="#cb58-208"></a>mle_up <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb58-209"><a href="#cb58-209"></a>mle_low <span class="ot">=</span> mle_re<span class="sc">$</span>par <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mle_re<span class="sc">$</span>hessian)))<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="co">#hessian 和协方差矩阵存在逆的关系：https://blog.csdn.net/anruoxi3236/article/details/102005217</span></span>
<span id="cb58-210"><a href="#cb58-210"></a>mle_summary <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(mle_low,mle_re<span class="sc">$</span>par,mle_up),<span class="dv">3</span>)</span>
<span id="cb58-211"><a href="#cb58-211"></a><span class="fu">colnames</span>(mle_summary) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mean"</span>,<span class="st">"up"</span>)</span>
<span id="cb58-212"><a href="#cb58-212"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mle_summary) </span>
<span id="cb58-213"><a href="#cb58-213"></a><span class="in">```</span></span>
<span id="cb58-214"><a href="#cb58-214"></a></span>
<span id="cb58-215"><a href="#cb58-215"></a>为了得到产品可靠度的估计, 只要将 $\hat{\mu} 、 \hat{\sigma}^2$ 代人任务时间 $t$ 的可靠度的表达式, 即 可得到可靠度的点估计为 $$</span>
<span id="cb58-216"><a href="#cb58-216"></a>R(t)=1-F(t ; \hat{\mu}, \hat{\sigma})=\Phi\left(\frac{l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)-\exp \left(\frac{2 \hat{\mu} l}{\hat{\sigma}^2}\right) \Phi\left(\frac{-l-\hat{\mu} t}{\hat{\sigma} \sqrt{t}}\right)</span>
<span id="cb58-217"><a href="#cb58-217"></a>$$</span>
<span id="cb58-218"><a href="#cb58-218"></a></span>
<span id="cb58-219"><a href="#cb58-219"></a><span class="in">```{r,collapse=TRUE}</span></span>
<span id="cb58-220"><a href="#cb58-220"></a><span class="do">## 可靠度计算</span></span>
<span id="cb58-221"><a href="#cb58-221"></a>Wiener_R <span class="ot">=</span> <span class="cf">function</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par){</span>
<span id="cb58-222"><a href="#cb58-222"></a>  R <span class="ot">=</span> <span class="fu">pnorm</span>((threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>par[<span class="dv">1</span>]<span class="sc">*</span>threshold<span class="sc">/</span>par[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">pnorm</span>((<span class="sc">-</span>threshold <span class="sc">-</span> par[<span class="dv">1</span>]<span class="sc">*</span>t)<span class="sc">/</span>(par[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(t))) </span>
<span id="cb58-223"><a href="#cb58-223"></a>  <span class="fu">return</span>(R)</span>
<span id="cb58-224"><a href="#cb58-224"></a>}</span>
<span id="cb58-225"><a href="#cb58-225"></a><span class="co"># 给个简单例子</span></span>
<span id="cb58-226"><a href="#cb58-226"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span>
<span id="cb58-227"><a href="#cb58-227"></a><span class="co"># 绘制带区间估计的可靠度函数（需要优化为 ggplot 绘制）</span></span>
<span id="cb58-228"><a href="#cb58-228"></a><span class="fu">plot</span>(<span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par),<span class="at">type =</span> <span class="st">"l"</span>,<span class="at">ylab =</span> <span class="st">'Reliability'</span>,<span class="at">xlab =</span> <span class="st">"time"</span>)</span>
<span id="cb58-229"><a href="#cb58-229"></a><span class="fu">lines</span>(<span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_up))</span>
<span id="cb58-230"><a href="#cb58-230"></a><span class="fu">lines</span>(<span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_low))</span>
<span id="cb58-231"><a href="#cb58-231"></a><span class="in">```</span></span>
<span id="cb58-232"><a href="#cb58-232"></a></span>
<span id="cb58-233"><a href="#cb58-233"></a><span class="at">&gt; 为什么 mle_up 绘制出来的结果这么奇怪？</span></span>
<span id="cb58-234"><a href="#cb58-234"></a></span>
<span id="cb58-235"><a href="#cb58-235"></a><span class="fu">##### 3.1.2.2 客观贝叶斯分析</span></span>
<span id="cb58-236"><a href="#cb58-236"></a></span>
<span id="cb58-237"><a href="#cb58-237"></a>来源于：He, L., et al. (2016). "Objective Bayesian analysis of degradation model with respect to a Wiener process." Journal of Systems Science and Complexity 29(6): 1737-1751.</span>
<span id="cb58-238"><a href="#cb58-238"></a></span>
<span id="cb58-239"><a href="#cb58-239"></a><span class="fu">###### 先验确定</span></span>
<span id="cb58-240"><a href="#cb58-240"></a></span>
<span id="cb58-241"><a href="#cb58-241"></a>The Fisher information matrix of the parameter $\theta = (\mu,\sigma^2_\mu,\sigma^2_\omega)$ is given by $$</span>
<span id="cb58-242"><a href="#cb58-242"></a>H(\theta)=\left(\begin{array}{ccc}</span>
<span id="cb58-243"><a href="#cb58-243"></a>\frac{n t_m}{\frac{\sigma_\omega^2+m_m}{} \sigma_\mu^2} &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb58-244"><a href="#cb58-244"></a>0 &amp; \frac{n t_m^2}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2} &amp; \frac{n t_m}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2} <span class="sc">\\</span></span>
<span id="cb58-245"><a href="#cb58-245"></a>0 &amp; \frac{n t_m}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2} &amp; \frac{n(m-1)}{2 \sigma_\omega^4}+\frac{n}{2\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^2}</span>
<span id="cb58-246"><a href="#cb58-246"></a>\end{array}\right).$$</span>
<span id="cb58-247"><a href="#cb58-247"></a></span>
<span id="cb58-248"><a href="#cb58-248"></a>**The Jeffreys prior** for $\theta$ is given by $$\pi_J(\theta) \propto \sigma_\omega^{-2}\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^{-\frac{3}{2}}.$$</span>
<span id="cb58-249"><a href="#cb58-249"></a></span>
<span id="cb58-250"><a href="#cb58-250"></a>**The reference priors** in Table 1 can be rewritten in the unified form $$\pi_{R_1}(\theta) \propto \sigma_\omega^{-p}\left(t_m \sigma_\mu^2+\sigma_\omega^2\right)^{-q}$$ or $$\pi_{R_2}(\theta) \propto \sigma_\omega^{-r}\left(\frac{\sigma_\mu^2}{\sigma_\omega^2}\right)^{-t}\left(1+\frac{t_m \sigma_\mu^2}{\sigma_\omega^2}\right)^{-\frac{s}{2}} \psi\left(\frac{\sigma_\mu^2}{\sigma_\omega^2}\right)$$ for certain constants $p, q, r$ and $t$, and $s$ is either 0 or 1.</span>
<span id="cb58-251"><a href="#cb58-251"></a></span>
<span id="cb58-252"><a href="#cb58-252"></a><span class="al">![](images/paste-344BAEA9.png)</span></span>
<span id="cb58-253"><a href="#cb58-253"></a></span>
<span id="cb58-254"><a href="#cb58-254"></a><span class="fu">###### 后验计算</span></span>
<span id="cb58-255"><a href="#cb58-255"></a></span>
<span id="cb58-256"><a href="#cb58-256"></a><span class="ss">1.  </span>Under the priors $\pi_{R_1}(\theta)$</span>
<span id="cb58-257"><a href="#cb58-257"></a></span>
<span id="cb58-258"><a href="#cb58-258"></a>the joint posterior densities of $\left(\mu, \sigma_\mu^2, \sigma_\omega^2\right)$ are given by $$</span>
<span id="cb58-259"><a href="#cb58-259"></a>\begin{aligned}</span>
<span id="cb58-260"><a href="#cb58-260"></a>\pi_{R_1}\left(\mu, \sigma_\mu^2, \sigma_\omega^2 \mid y\right) \propto &amp;\left(\sigma_\omega^2\right)^{-\frac{m n-n+p}{2}}\left(\sigma_\omega^2+t_m \sigma_\mu^2\right)^{-\frac{n+2 q}{2}} <span class="sc">\\</span></span>
<span id="cb58-261"><a href="#cb58-261"></a>&amp; \cdot \exp \left<span class="sc">\{</span>-\frac{1}{2}\left<span class="co">[</span><span class="ot">\frac{a}{\sigma_\omega^2}+\frac{b}{\sigma_\omega^2+t_m \sigma_\mu^2}+x^{\prime} \Lambda^{-1} x(\mu-\widehat{\mu})^2\right</span><span class="co">]</span>\right<span class="sc">\}</span></span>
<span id="cb58-262"><a href="#cb58-262"></a>\end{aligned}</span>
<span id="cb58-263"><a href="#cb58-263"></a>$$ where $$</span>
<span id="cb58-264"><a href="#cb58-264"></a>\begin{aligned}</span>
<span id="cb58-265"><a href="#cb58-265"></a>&amp;a=\operatorname{tr}\left(Y^{\prime} \Psi^{-1} Y\right)-\frac{1}{t_m} \tau^{\prime} \Psi^{-1} Y Y^{\prime} \Psi^{-1} \tau <span class="sc">\\</span></span>
<span id="cb58-266"><a href="#cb58-266"></a>&amp;b=\frac{1}{t_m} \tau^{\prime} \Psi^{-1} Y Y^{\prime} \Psi^{-1} \tau-\frac{1}{n t_m} \tau^{\prime} \Psi^{-1} Y 1_n 1_n^{\prime} Y^{\prime} \Psi^{-1} \tau</span>
<span id="cb58-267"><a href="#cb58-267"></a>\end{aligned}</span>
<span id="cb58-268"><a href="#cb58-268"></a>$$</span>
<span id="cb58-269"><a href="#cb58-269"></a></span>
<span id="cb58-270"><a href="#cb58-270"></a><span class="at">&gt; Theorem 1 the priors $\pi_{R1}(\theta)$, the posterior distributions $\pi_{R_1}(\mu,\sigma^2_\mu, \sigma_\omegaω ^2|y)$ are proper when $m, n &gt; 1$.</span></span>
<span id="cb58-271"><a href="#cb58-271"></a></span>
<span id="cb58-272"><a href="#cb58-272"></a>------------------------------------------------------------------------</span>
<span id="cb58-273"><a href="#cb58-273"></a></span>
<span id="cb58-274"><a href="#cb58-274"></a><span class="ss">2.  </span>Under the priors $\pi_{R_2}(\theta)$</span>
<span id="cb58-275"><a href="#cb58-275"></a></span>
<span id="cb58-276"><a href="#cb58-276"></a>Denote $\eta=\frac{\sigma_\mu^2}{\sigma_\omega^2}$, then the joint posterior density of $\left(\mu, \sigma_\omega^2, \eta\right)$ under the priors $\pi_{R_2}(\theta)$ can be written as $$</span>
<span id="cb58-277"><a href="#cb58-277"></a>\begin{aligned}</span>
<span id="cb58-278"><a href="#cb58-278"></a>\pi_{R_2}\left(\mu, \sigma_\omega^2, \eta \mid y\right) \propto &amp;\left(\sigma_\omega^2\right)^{-\frac{m n+r-2}{2}} \eta^{-t}\left(1+\eta t_m\right)^{-\frac{n+s}{2}} \psi(\eta) <span class="sc">\\</span></span>
<span id="cb58-279"><a href="#cb58-279"></a>&amp; \cdot \exp \left<span class="sc">\{</span>-\frac{1}{2}\left<span class="co">[</span><span class="ot">\frac{1}{\sigma_\omega^2}\left(a+\frac{b}{1+\eta t_m}\right)+x^{\prime} \Lambda^{-1} x(\mu-\widehat{\mu})^2\right</span><span class="co">]</span>\right<span class="sc">\}</span> .</span>
<span id="cb58-280"><a href="#cb58-280"></a>\end{aligned}</span>
<span id="cb58-281"><a href="#cb58-281"></a>$$</span>
<span id="cb58-282"><a href="#cb58-282"></a></span>
<span id="cb58-283"><a href="#cb58-283"></a><span class="at">&gt; Theorem 2: when $n&gt;3$, then the posterior distributions $\pi_{R_2}\left(\mu, \sigma_\omega^2\right.$, $\eta \mid y)$ are proper.</span></span>
<span id="cb58-284"><a href="#cb58-284"></a></span>
<span id="cb58-285"><a href="#cb58-285"></a><span class="ss">3.  </span>Under the priors $\pi_{J}(\theta)$</span>
<span id="cb58-286"><a href="#cb58-286"></a></span>
<span id="cb58-287"><a href="#cb58-287"></a><span class="at">&gt; Corollary 3 For the model (1), under the Jefferys prior $\pi_J(\theta)$, the posterior distribution is proper.</span></span>
<span id="cb58-288"><a href="#cb58-288"></a></span>
<span id="cb58-289"><a href="#cb58-289"></a><span class="ss">-   </span>后验分布抽样</span>
<span id="cb58-290"><a href="#cb58-290"></a></span>
<span id="cb58-291"><a href="#cb58-291"></a><span class="ss">1.  </span>$\pi_{R_1}(\theta)$ 后验分布抽样</span>
<span id="cb58-292"><a href="#cb58-292"></a></span>
<span id="cb58-293"><a href="#cb58-293"></a>A Monte Carlo (MC) simulation algorithm is employed to generate the samples from the joint posterior distribution. However, only the marginal density of $\delta$ and $\gamma$ can be written in analytic form, where $\delta$ and $\gamma$ are defined in (A.4). So a two-step rejection sampling procedure in <span class="sc">\[</span>18<span class="sc">\]</span> is used here, which is a straightforward strategy to generate samples for parameters $\sigma_\mu^2$ and $\sigma_\omega^2$. The algorithm is summarized as follows:</span>
<span id="cb58-294"><a href="#cb58-294"></a></span>
<span id="cb58-295"><a href="#cb58-295"></a>**Step 1**: Generate values of $\delta$ and $\gamma$ from two inverse gamma distributions, which are $$</span>
<span id="cb58-296"><a href="#cb58-296"></a>\begin{aligned}</span>
<span id="cb58-297"><a href="#cb58-297"></a>&amp;{<span class="co">[</span><span class="ot">\delta \mid y</span><span class="co">]</span> \sim I G\left(\frac{m n-n+p-2}{2}, \frac{a}{2}\right)} <span class="sc">\\</span></span>
<span id="cb58-298"><a href="#cb58-298"></a>&amp;{<span class="co">[</span><span class="ot">\gamma \mid y</span><span class="co">]</span> \sim I G\left(\frac{n+2 q-3}{2}, \frac{b}{2}\right)}</span>
<span id="cb58-299"><a href="#cb58-299"></a>\end{aligned}</span>
<span id="cb58-300"><a href="#cb58-300"></a>$$</span>
<span id="cb58-301"><a href="#cb58-301"></a></span>
<span id="cb58-302"><a href="#cb58-302"></a>**Step 2**: Retain those sets of values that obey the restricted parameter space of $\delta$ and $\gamma$.</span>
<span id="cb58-303"><a href="#cb58-303"></a></span>
<span id="cb58-304"><a href="#cb58-304"></a>**Step 3**: Generate a value of $\mu$ from the normal distribution $N\left(\widehat{\mu}, \frac{\sigma_\omega^2+t_m \sigma_\mu^2}{n t_m}\right)$ by using the values $\sigma_\mu^2$ and $\sigma_\omega^2$ obtained, where $\widehat{\mu}$ is defined in (5).</span>
<span id="cb58-305"><a href="#cb58-305"></a></span>
<span id="cb58-306"><a href="#cb58-306"></a><span class="ss">-   </span>$\pi_{R_2}(\theta)$ 后验分布抽样</span>
<span id="cb58-307"><a href="#cb58-307"></a></span>
<span id="cb58-308"><a href="#cb58-308"></a>It's quite obvious that the conditional distributions for the parameters $\mu$ and $\sigma_\omega^2$ is easily simulated, since they are normal distribution and inverse-Gamma distribution respectively. However, due to the complexity of the conditional distribution of the parameter $\eta$, we suggest taking the Metropolis-Hasting ${ }^{<span class="co">[</span><span class="ot">19</span><span class="co">]</span>}$ sampling scheme for $\eta$. The sampling process is as follows:</span>
<span id="cb58-309"><a href="#cb58-309"></a></span>
<span id="cb58-310"><a href="#cb58-310"></a>**Step 1**: Under $\pi_{R_2}$, the marginal posterior distribution of $\eta, \pi(\eta \mid y)$, is proportional to $$</span>
<span id="cb58-311"><a href="#cb58-311"></a>\eta^{-t}\left(1+\eta t_m\right)^{-\frac{n+s-1}{2}} \psi(\eta)\left(a+\frac{b}{1+\eta t_m}\right)^{-\frac{m n+r-5}{2}} .</span>
<span id="cb58-312"><a href="#cb58-312"></a>$$</span>
<span id="cb58-313"><a href="#cb58-313"></a></span>
<span id="cb58-314"><a href="#cb58-314"></a>**Step 2**: For the current $\eta$, sample a value of $\sigma_\omega^2$ from its conditional posterior distribution $\pi_{R_2}\left(\sigma_\omega^2 \mid \eta, y\right)$, which is an inverse-Gamma distribution with the shape parameter $\frac{m n+r-5}{2}$ and the scale parameter $\frac{1}{2}\left(a+\frac{b}{1+\eta t_m}\right)$.</span>
<span id="cb58-315"><a href="#cb58-315"></a></span>
<span id="cb58-316"><a href="#cb58-316"></a>**Step 3**: Given $\eta$ and $\sigma_\omega^2$, generate a value of $\mu$ from its conditional posterior distribution $\pi_{R_2}\left(\mu \mid \eta, \sigma_\omega^2, y\right)$, which is a normal distribution with the mean $\widehat{\mu}$ and the variance $\frac{\sigma_\omega^2\left(1+\eta t_m\right)}{n t_m}$.</span>
<span id="cb58-317"><a href="#cb58-317"></a></span>
<span id="cb58-318"><a href="#cb58-318"></a>For Step 1, a random-walk Metropolis algorithm can be used to sample for $\eta$. Considering the new candidate parameter value, labeled $v$, which is drawn from a normal distribution $N\left(\eta, \rho^2\right)$ truncated on the interval $(0, \infty)$, where $\rho^2$ is a tuning parameter. Truncated normal random numbers can be readily generated by using the function rtnorm in the $m s m$ package of $R$ software. Then the candidate value is accepted with probability $$</span>
<span id="cb58-319"><a href="#cb58-319"></a>\min \left<span class="sc">\{</span>1, \frac{\pi_{R_2}(v \mid y) \Phi\left(\frac{\eta}{\rho}\right)}{\pi_{R_2}(\eta \mid y) \Phi\left(\frac{v}{\rho}\right)}\right<span class="sc">\}</span>,</span>
<span id="cb58-320"><a href="#cb58-320"></a>$$ where $\Phi(\cdot)$ is the cumulative distribution function of the standard normal.</span>
<span id="cb58-321"><a href="#cb58-321"></a></span>
<span id="cb58-322"><a href="#cb58-322"></a>Here, one may care about the choice of the tuning parameter $\rho^2$ in Step 1. Obviously, small values of $\rho^2$ will lead to large autocorrelations and result in high acceptance rates but slow convergence, while the opposite conclusion holds for high values of $\rho^2$. Albert commented that the range of acceptance rates between $25\%$ and $45\%$ is good for random walk chains with normal proposal densities. Thus, one can try several values of $\rho^2$ until the desired acceptance rate is achieved in practice.</span>
<span id="cb58-323"><a href="#cb58-323"></a></span>
<span id="cb58-324"><a href="#cb58-324"></a><span class="fu">##### 3.1.2.3 广义推断方法</span></span>
<span id="cb58-325"><a href="#cb58-325"></a></span>
<span id="cb58-326"><a href="#cb58-326"></a>暂时还未找到，最经典的维纳过程的广义推断方法论文。其他类似的论文整理如下：</span>
<span id="cb58-327"><a href="#cb58-327"></a></span>
<span id="cb58-328"><a href="#cb58-328"></a><span class="ss">-   </span>维纳（线性） + 随机效应：</span>
<span id="cb58-329"><a href="#cb58-329"></a></span>
<span id="cb58-330"><a href="#cb58-330"></a>Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety 193.</span>
<span id="cb58-331"><a href="#cb58-331"></a></span>
<span id="cb58-332"><a href="#cb58-332"></a><span class="ss">-   </span>维纳（线性）+ 加速寿命试验 + 随机效应：</span>
<span id="cb58-333"><a href="#cb58-333"></a></span>
<span id="cb58-334"><a href="#cb58-334"></a>Wang, X. F., et al. (2020). "Reliability analysis for accelerated degradation data based on the Wiener process with random effects." Quality and Reliability Engineering International 36(6): 1969-1981.</span>
<span id="cb58-335"><a href="#cb58-335"></a></span>
<span id="cb58-336"><a href="#cb58-336"></a>Hong, L., et al. (2018). "Interval estimation for Wiener processes based on accelerated degradation test data." IISE Transactions 50(12): 1043-1057.</span>
<span id="cb58-337"><a href="#cb58-337"></a></span>
<span id="cb58-338"><a href="#cb58-338"></a><span class="ss">-   </span>伽马 + 随机过程</span>
<span id="cb58-339"><a href="#cb58-339"></a></span>
<span id="cb58-340"><a href="#cb58-340"></a>Wang, X. F., et al. (2021). "Degradation data analysis based on gamma process with random effects." European Journal of Operational Research 292(3): 1200-1208.</span>
<span id="cb58-341"><a href="#cb58-341"></a></span>
<span id="cb58-342"><a href="#cb58-342"></a><span class="ss">-   </span>伽马 + 加速寿命试验</span>
<span id="cb58-343"><a href="#cb58-343"></a></span>
<span id="cb58-344"><a href="#cb58-344"></a>Jiang, P. H., et al. (2019). "Inference for constant-stress accelerated degradation test based on Gamma process." Applied Mathematical Modelling 67: 123-134.</span>
<span id="cb58-345"><a href="#cb58-345"></a></span>
<span id="cb58-346"><a href="#cb58-346"></a><span class="fu">### 3.2 多应力和动态环境情形</span></span>
<span id="cb58-347"><a href="#cb58-347"></a></span>
<span id="cb58-348"><a href="#cb58-348"></a>**1. 多应力情形**</span>
<span id="cb58-349"><a href="#cb58-349"></a></span>
<span id="cb58-350"><a href="#cb58-350"></a>某些产品的性能退化过程较慢, 要在较短时间获得较多性能退化数据较为困难,通 常需要提高试验应力加快其退化过程。下面给出基于加速退化试验数据的模型参数估计方法。</span>
<span id="cb58-351"><a href="#cb58-351"></a></span>
<span id="cb58-352"><a href="#cb58-352"></a>假设在不同应力下, 一元 Wiener 过程模型的参数是应力 $S$ 的函数 $$</span>
<span id="cb58-353"><a href="#cb58-353"></a>\mu=\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma=\sigma\left(S ; \boldsymbol{\theta}_\sigma\right)</span>
<span id="cb58-354"><a href="#cb58-354"></a>$$ 式中: $\theta_\mu 、 \theta_\sigma$ 是末知参数向量。</span>
<span id="cb58-355"><a href="#cb58-355"></a></span>
<span id="cb58-356"><a href="#cb58-356"></a>对不同类型应力, $\mu\left(S ; \boldsymbol{\theta}_\mu\right), \sigma\left(S ; \boldsymbol{\theta}_\sigma\right)$ 的形式和参数不同。比如对漂移参数 $\mu$, 应力 为温度时通常采用阿伦尼斯模型进行描述 $$</span>
<span id="cb58-357"><a href="#cb58-357"></a>\mu(S)=a \mathrm{e}^{-b / S}</span>
<span id="cb58-358"><a href="#cb58-358"></a>$$</span>
<span id="cb58-359"><a href="#cb58-359"></a></span>
<span id="cb58-360"><a href="#cb58-360"></a>如果应力是电压、功率等, 则通常采用幂律模型 $$</span>
<span id="cb58-361"><a href="#cb58-361"></a>\mu(S)=a S^b</span>
<span id="cb58-362"><a href="#cb58-362"></a>$$</span>
<span id="cb58-363"><a href="#cb58-363"></a></span>
<span id="cb58-364"><a href="#cb58-364"></a>根据加速退化试验中应力的变化情况,加速退化试验又分别为**恒定应力加速退化试验**、**步进应力加速退化试验**和**序进应力加速退化试验**。</span>
<span id="cb58-365"><a href="#cb58-365"></a></span>
<span id="cb58-366"><a href="#cb58-366"></a>恒定应力加速退化试验是目前应用最广、研究最多的, 这里考虑由恒定应力加速退化试验得到的加速退化数据。</span>
<span id="cb58-367"><a href="#cb58-367"></a></span>
<span id="cb58-368"><a href="#cb58-368"></a>设产品在 $S_0, S_1, \cdots, S_s$ 共 $s+1$ 个应力下进行退化试验, 其中应力 $S_0$ 为正常工作应 力。应力 $S_i$ 下共得到 $n_i$ 个产品的性能退化数据, 其中对产品 $j$, 初始时刻 $t_{i j 0}$ 的退化量 为 $X_{i j 0}=0$, 分别在时刻 $t_{i j 1}, \cdots, t_{i j m_{i j}}$ 测量其性能退化量 $X_{i j 1}, \cdots, X_{i j m_{i j}}$, 其中 $i=0,1, \cdots, s, j=$ $1,2, \cdots, n_i$ 记 $\Delta t_{i j k}=t_{i j k}-t_{i j(k-1)}, \Delta X_{i j k}=X_{i j k}-X_{i j(k-1)}$, 其中 $k=1,2, \cdots, m_{i j}$ 。由各应力下 的退化数据 $\left<span class="sc">\{</span>\Delta x_{i j k}\right<span class="sc">\}</span>$ 得到模型参数的似然函数为 $$</span>
<span id="cb58-369"><a href="#cb58-369"></a>L\left(\boldsymbol{\theta}_\mu, \boldsymbol{\theta}_\sigma\right)=\prod_{i=0}^3 \prod_{j=1}^{n_i} \prod_{k=1}^{m_{i j}} \frac{1}{\sqrt{2 \pi \sigma^2\left(S_i\right) \Delta t_{i j k}}} \exp \left[-\frac{\left(\Delta x_{i j k}-\mu\left(S_i\right) \Delta t_{i j k}\right)^2}{2 \sigma^2\left(S_i\right) \Delta t_{i j k}}\right]</span>
<span id="cb58-370"><a href="#cb58-370"></a>$$</span>
<span id="cb58-371"><a href="#cb58-371"></a></span>
<span id="cb58-372"><a href="#cb58-372"></a>则参数 $\boldsymbol{\theta}_\mu 、 \boldsymbol{\theta}_\sigma$ 的极大似然估计 $\hat{\boldsymbol{\theta}}_\mu 、 \hat{\boldsymbol{\theta}}_\sigma$ 可以采用数值方法求式 (3.49) 的极大值得到。则 常应力 $S_0$ 下参数 $\mu 、 \sigma^2$ 为 $$</span>
<span id="cb58-373"><a href="#cb58-373"></a>\mu=\mu\left(S_0 ; \hat{\boldsymbol{\theta}}_\mu\right), \sigma^2=\sigma^2\left(S_0 ; \hat{\boldsymbol{\theta}}_\sigma\right)</span>
<span id="cb58-374"><a href="#cb58-374"></a>$$ 产品可靠度点估计可由式 (3.42)得到。</span>
<span id="cb58-375"><a href="#cb58-375"></a></span>
<span id="cb58-376"><a href="#cb58-376"></a>**2. 动态环境情形**</span>
<span id="cb58-377"><a href="#cb58-377"></a></span>
<span id="cb58-378"><a href="#cb58-378"></a>与基于失效的可靠性建模方法相比, 退化过程模型的优点在于可以直接描述应力 对产品退化过程 (如退化速率) 的影响, 为解释产品失效过程、利用各种可能的数据提 供了可能。下面考虑动态环境下的参数估计问题。设动态环境下的应力过程为 $<span class="sc">\{</span>S$ $(t), t \geqslant 0<span class="sc">\}</span>$, 并且假设应力对退化速率的影响函数为 $\beta_0 \cdot h(S(t) ; b)$, 其中 $\beta_0$ 是基准应 力下的退化速率, 以 $b$ 为参数的函数 $h(S(t) ; b)$ 表示应力的影响, $b$ 是待估参数。认为 应力对退化速率的影响是立即发生的, 即没有时间延迟, 并且退化符合累计损伤规律, 则可知时刻 $t$ 产品退化量取值为 $$</span>
<span id="cb58-379"><a href="#cb58-379"></a>X(t \mid T(\tau), 0 \leqslant \tau \leqslant t)=\beta_0 \int_0^t h(S(\tau) ; b) \mathrm{d} \tau+\sigma_B B(t)</span>
<span id="cb58-380"><a href="#cb58-380"></a>$$ 式中: $<span class="sc">\{</span>S(\tau), 0 \leqslant \tau \leqslant t<span class="sc">\}</span>$ 为 $<span class="co">[</span><span class="ot">0, \tau</span><span class="co">]</span>$ 内的应力; $<span class="sc">\{</span>B(t), t \geqslant 0<span class="sc">\}</span>$ 为标准 Wiener 过程; 模型待估 参数为 $$</span>
<span id="cb58-381"><a href="#cb58-381"></a>\boldsymbol{\theta}=\left(\beta_0, b, \sigma_B^2\right)</span>
<span id="cb58-382"><a href="#cb58-382"></a>$$</span>
<span id="cb58-383"><a href="#cb58-383"></a></span>
<span id="cb58-384"><a href="#cb58-384"></a>设有 $n$ 个产品进行退化试验, 不失一般性, 考虑规则型连续测量情形。对产品 $i$, 设 时刻 $t_{i k}$ 观测到的退化量为 $X_i\left(t_{i k}\right), k=0,1,2, \cdots, m\left(t_{i 0}=0\right)$; 对环境进行连续观测, 时刻 $j$ 观测到应力取值为 $S_{i j}, j=1,2, \cdots$ 。需要注意的是,退化量的测量间隔与环境监测时间 间隔可能是不同的,这里假设后者的监测更频繁。不失一般性, 假设环境监测间隔为 1 个时间单位, 则 $t_{i k}-t_{i, k-1} \geqslant 1, k=1,2, \cdots$ 。下面基于动态环境下的退化试验数据, 给出 模型参数的**极大似然估计**方法。</span>
<span id="cb58-385"><a href="#cb58-385"></a></span>
<span id="cb58-386"><a href="#cb58-386"></a>根据模型式 $(3.51)$, 记 $\nu_{i k}=\sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)$, 对产品 $i$ 以及时刻 $t_{i k}$ 近似的有 $$</span>
<span id="cb58-387"><a href="#cb58-387"></a>X_i\left(t_{i k}\right)=\beta_0 \int_0^{t_{i k}} h\left(S_i(\tau) ; b\right) \mathrm{d} \tau+\sigma_B B\left(t_{i k}\right) \approx \beta_0 \sum_{j=1}^{t_{i k}} h\left(S_{i j} ; b\right)+\sigma_B B\left(t_{i k}\right)</span>
<span id="cb58-388"><a href="#cb58-388"></a>$$ 且有 $$</span>
<span id="cb58-389"><a href="#cb58-389"></a>\begin{gathered}</span>
<span id="cb58-390"><a href="#cb58-390"></a>E\left<span class="co">[</span><span class="ot">X_i\left(t_{i k}\right)\right</span><span class="co">]</span>=\beta_0 \nu_{i k} <span class="sc">\\</span></span>
<span id="cb58-391"><a href="#cb58-391"></a>\operatorname{Cov}\left<span class="co">[</span><span class="ot">X_i\left(t_{i k_1}\right), X_i\left(t_{i i_2}\right)\right</span><span class="co">]</span>=\sigma_B^2 \cdot \min \left<span class="sc">\{</span>t_{i k_1}, t_{i k_2}\right<span class="sc">\}</span></span>
<span id="cb58-392"><a href="#cb58-392"></a>\end{gathered}</span>
<span id="cb58-393"><a href="#cb58-393"></a>$$ 如果考虑退化增量 $\boldsymbol{Y}_i=\left(Y_i\left(t_{i 1}\right), \cdots, Y_i\left(t_{i m}\right)\right)$, 其中 $$</span>
<span id="cb58-394"><a href="#cb58-394"></a>Y_i\left(t_{i k}\right)=X_i\left(t_{i k}\right)-X_i\left(t_{i, k-1}\right), \quad k=1,2, \cdots, m</span>
<span id="cb58-395"><a href="#cb58-395"></a>$$ 记 $\Delta t_{i k}=t_{i k}-t_{i, k-1}, \Delta \nu_{i k}=\nu_{i k}-\nu_{i, k-1}$ 。容易知道 $\boldsymbol{Y}_i \sim N\left(\mu_i, \Sigma_i\right)$, 其中 $$</span>
<span id="cb58-396"><a href="#cb58-396"></a>\mu_i=\beta_0 \Delta \nu_i, \Sigma_i=\sigma_B^2 \cdot \operatorname{diag}\left(\Delta t_i\right)</span>
<span id="cb58-397"><a href="#cb58-397"></a>$$</span>
<span id="cb58-398"><a href="#cb58-398"></a></span>
<span id="cb58-399"><a href="#cb58-399"></a>其中 $$</span>
<span id="cb58-400"><a href="#cb58-400"></a>\Delta \boldsymbol{\nu}_i=\left(\Delta \nu_{i 1}, \Delta \nu_{i 2}, \cdots, \Delta \nu_{i m}\right)^{\mathrm{T}}, \quad \Delta t_i=\left(\Delta t_{i 1}, \Delta t_{i 2}, \cdots, \Delta t_{i m}\right)^{\mathrm{T}}</span>
<span id="cb58-401"><a href="#cb58-401"></a>$$ 设退化试验数据为 $\boldsymbol{y}_i, i=1,2, \cdots, n$, 则似然函数为 $$</span>
<span id="cb58-402"><a href="#cb58-402"></a>L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left<span class="sc">\{</span>-\frac{1}{2}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)^{\mathrm{T}} \boldsymbol{\Sigma}_i^{-1}\left(\boldsymbol{y}_i-\beta_0 \boldsymbol{\nu}_i\right)\right<span class="sc">\}</span></span>
<span id="cb58-403"><a href="#cb58-403"></a>$$ 对数似然函数为 $$</span>
<span id="cb58-404"><a href="#cb58-404"></a>l(\boldsymbol{\theta})=\text { Const }-n m \ln \sigma_B-\frac{1}{2 \sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}</span>
<span id="cb58-405"><a href="#cb58-405"></a>$$ 取对数似然函数关 $\sigma_B$ 和 $\beta_0$ 的一阶偏导数,得到 $$</span>
<span id="cb58-406"><a href="#cb58-406"></a>\frac{\partial}{\partial \sigma_B} l(\boldsymbol{\theta})=-n m \frac{1}{\sigma_B}+\frac{1}{\sigma_B^3} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}</span>
<span id="cb58-407"><a href="#cb58-407"></a>$$ 与 $$</span>
<span id="cb58-408"><a href="#cb58-408"></a>\frac{\partial l(\boldsymbol{\theta})}{\partial \beta_0}=\frac{1}{\sigma_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\Delta \nu_{i j}\left(y_{i j}-\beta_0 \Delta \nu_{i j}\right)}{\Delta t_{i j}}</span>
<span id="cb58-409"><a href="#cb58-409"></a>$$ 这样, 对特定的 $\sigma_B$ 和 $\beta_0$, 置这两个导数为 0 , 得到 将其代人对数似然函数, 得到截面对数似然函数如下: $$</span>
<span id="cb58-410"><a href="#cb58-410"></a>l(b)=\text { Const }-n m \ln \hat{\sigma}_B-\frac{1}{2 \hat{\sigma}_B^2} \sum_{i=1}^n \sum_{j=1}^m \frac{\left(y_{i j}-\hat{\beta}_0 \Delta \nu_{i j}\right)^2}{\Delta t_{i j}}</span>
<span id="cb58-411"><a href="#cb58-411"></a>$$ 通过搜索得到 $b$ 的极大似然估计 $\hat{b}$, 并将其代人式 (3.52) 或式 (3.53), 就得到 $\sigma_B$ 和 $\beta_0$ 的极大似然估计。</span>
<span id="cb58-412"><a href="#cb58-412"></a></span>
<span id="cb58-413"><a href="#cb58-413"></a><span class="fu">### 3.3 含随机效应情形</span></span>
<span id="cb58-414"><a href="#cb58-414"></a></span>
<span id="cb58-415"><a href="#cb58-415"></a>考虑漂移参数和扩散参数服从正态 - 逆 Gamma 分布的情形, 利用 $n$ 个样品的退化 试验数据对随机效应的分布参数 $\nu 、 \eta 、 \alpha 、 \beta$ 进行估计。这里采用两阶段法, 即首先估计 个体产品的固定效应退化过程的参数, 再利用估计的参数值来得到随机效应分布参数 的估计。</span>
<span id="cb58-416"><a href="#cb58-416"></a></span>
<span id="cb58-417"><a href="#cb58-417"></a>对产品 $i$, 分别在时刻 $t_{i 0}=0, t_{i 1}, t_{i 2}, \cdots, t_{i m_i}$ 对其进行 $m_i+1$ 次测量, $i=1,2, \cdots, n$, 得 到的测量数据为 $x_{i j}$ 。记 $\Delta x_{i j}=x_{i j}-x_{i, j-1}$, 即 $\Delta x_{i j}$ 为产品 $i$ 在 $t_{i j-1}$ 到 $t_{i j}$ 之间的退化量增量, 由式 (3.41), 给定试验数据 $\Delta x_{i j}$ 的情况下, 样品 $i$ 的退化过程模型参数 $\mu_i, \sigma_i^2$ 的极大似然估计为 $$</span>
<span id="cb58-418"><a href="#cb58-418"></a>\hat{\mu}_i=\frac{X_{i m_i}}{t_{i m_i}}, \hat{\sigma}_i^2=\frac{1}{m_i}\left[\sum_{j=1}^{m_i} \frac{\left(\Delta X_{i j}\right)^2}{\Delta t_{i j}}-\frac{X_{i m_i}^2}{t_{i m_i}}\right]</span>
<span id="cb58-419"><a href="#cb58-419"></a>$$ 式中 : $\Delta t_{i j}=t_{i j}-t_{i(j-1)}, j=1,2, \cdots, m_i$ 。</span>
<span id="cb58-420"><a href="#cb58-420"></a></span>
<span id="cb58-421"><a href="#cb58-421"></a>由式 (3.56) 得到各产品的退化过程参数的估计 $\hat{\mu}_i 、 \hat{\sigma}_i^2$ 后, 可以拟合得到 $\mu$ 和 $D$ 的 分布参数。令 $\hat{D}_i=\hat{\sigma}_i^2$, 由于 $D^{-1}$ 服从参数为 $(\alpha, \beta)$ 的 $\mathrm{Gamma}$ 分布, 则根据极大似然估 计, $D$ 的分布参数 $\alpha \sqrt{ } \beta$ 可以通过求解下面的方程组得到: $$</span>
<span id="cb58-422"><a href="#cb58-422"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb58-423"><a href="#cb58-423"></a>\ln \beta-\psi(\beta)=\ln \frac{1}{n} \sum_{i=1}^n \frac{1}{\hat{D}_i}-\frac{1}{n} \ln \left(\prod_{i=1}^n \frac{1}{\hat{D}_i}\right) <span class="sc">\\</span></span>
<span id="cb58-424"><a href="#cb58-424"></a>\alpha=\frac{n \beta}{\sum_{i=1}^n \hat{D}_i^{-1}}</span>
<span id="cb58-425"><a href="#cb58-425"></a>\end{array}\right.</span>
<span id="cb58-426"><a href="#cb58-426"></a>$$ 式中: $\psi(x)=\frac{\mathrm{d} \ln \Gamma(x)}{\mathrm{d} x}=\Gamma(x) / \Gamma^{\prime}(x)$ 为 Digamma 函数, 文献 $<span class="co">[</span><span class="ot">47</span><span class="co">]</span>$ 给出了其准确计算方法。</span>
<span id="cb58-427"><a href="#cb58-427"></a></span>
<span id="cb58-428"><a href="#cb58-428"></a>由于 $\mu \sim N(\nu, \eta D)$, 对单元 $i$, 近似认为参数 $\nu 、 \eta$ 的似然函数为 $$</span>
<span id="cb58-429"><a href="#cb58-429"></a>l\left(\nu, \eta \mid \hat{\mu}_i, \hat{D}_i\right)=\frac{1}{\sqrt{2 \pi \eta \hat{D}_i}} \exp \left(-\frac{\left(\hat{\mu}_i-\nu\right)^2}{2 \eta \hat{D}_i}\right)</span>
<span id="cb58-430"><a href="#cb58-430"></a>$$ 于是总的似然函数为 $$</span>
<span id="cb58-431"><a href="#cb58-431"></a>l(\nu, \eta)=-\frac{n}{2} \ln 2 \pi-\frac{1}{2} \sum_{i=1}^n \hat{D}_i-\frac{n}{2} \ln \eta-\frac{1}{2 \eta}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)</span>
<span id="cb58-432"><a href="#cb58-432"></a>$$ 由极大似然方法得到 $$</span>
<span id="cb58-433"><a href="#cb58-433"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb58-434"><a href="#cb58-434"></a>-\frac{1}{\eta}\left(-\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+\mu \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0 <span class="sc">\\</span></span>
<span id="cb58-435"><a href="#cb58-435"></a>-\frac{n}{2 \eta}+\frac{1}{2 \eta^2}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-2 v \sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}+v^2 \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)=0</span>
<span id="cb58-436"><a href="#cb58-436"></a>\end{array}\right.</span>
<span id="cb58-437"><a href="#cb58-437"></a>$$ 解上面的方程组得到 $$</span>
<span id="cb58-438"><a href="#cb58-438"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb58-439"><a href="#cb58-439"></a>\hat{\nu}=\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i} / \sum_{i=1}^n \frac{1}{\hat{D}_i} <span class="sc">\\</span></span>
<span id="cb58-440"><a href="#cb58-440"></a>\hat{\eta}=\frac{1}{n}\left(\sum_{i=1}^n \frac{\hat{\mu}_i^2}{\hat{D}_i}-\left(\sum_{i=1}^n \frac{\hat{\mu}_i}{\hat{D}_i}\right)^2 / \sum_{i=1}^n \frac{1}{\hat{D}_i}\right)</span>
<span id="cb58-441"><a href="#cb58-441"></a>\end{array}\right.</span>
<span id="cb58-442"><a href="#cb58-442"></a>$$</span>
<span id="cb58-443"><a href="#cb58-443"></a></span>
<span id="cb58-444"><a href="#cb58-444"></a><span class="fu">### 3.4 有测量误差情形</span></span>
<span id="cb58-445"><a href="#cb58-445"></a></span>
<span id="cb58-446"><a href="#cb58-446"></a>假设 $Y(t)$ 和 $X(t)$ 分别表示观测的退化过程和真实退化过程在时刻 $t, t \geqslant 0$ 的退化水平, $X(t)$ 和 $Y(t)$ 可用下面的模型描述: $$</span>
<span id="cb58-447"><a href="#cb58-447"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb58-448"><a href="#cb58-448"></a>X(t)=\beta \cdot t+\sigma_B \cdot B(t) <span class="sc">\\</span></span>
<span id="cb58-449"><a href="#cb58-449"></a>Y(t)=X(t)+\sigma_R \cdot \varepsilon(t)</span>
<span id="cb58-450"><a href="#cb58-450"></a>\end{array}\right.</span>
<span id="cb58-451"><a href="#cb58-451"></a>$$ 式中: $\beta$ 对个体产品是恒定不变的退化强度即退化速率: 假设不同个体平均退化速率存 在差异, 并可用正态分布描述, 即 $\beta \sim N\left(\mu_\beta, \sigma_\beta^2\right) ; B(t)$ 是标准 Wiener 过程, $\sigma_B$ 为扩散参 数; $\varepsilon(t)$ 表示测量误差, 是均值为 0 、方差为 1 的 Gaussian 白噪声。</span>
<span id="cb58-452"><a href="#cb58-452"></a></span>
<span id="cb58-453"><a href="#cb58-453"></a>因此, 式 (3.61) 模型共有 4 个待估参数, 即 $$</span>
<span id="cb58-454"><a href="#cb58-454"></a>\boldsymbol{\theta}=\left(\mu_\beta, \sigma_\beta, \sigma_B^2, \sigma_R^2\right)^{\mathrm{T}}</span>
<span id="cb58-455"><a href="#cb58-455"></a>$$</span>
<span id="cb58-456"><a href="#cb58-456"></a></span>
<span id="cb58-457"><a href="#cb58-457"></a>假设对 $n$ 个产品进行退化试验。对单元 $i(i=1, \cdots, n)$ 进行 $m_i$ 次测量, 时刻 $t_{i j}$ 的测量值为 $$</span>
<span id="cb58-458"><a href="#cb58-458"></a>Y_i\left(t_{i j}\right)=X_i\left(t_{i j}\right)+\sigma_e \varepsilon\left(t_{i j}\right)=\beta_i t_{i j}+\sigma_B B\left(t_{i j}\right)+\sigma_R \varepsilon\left(t_{i j}\right), j=1, \cdots, m_i</span>
<span id="cb58-459"><a href="#cb58-459"></a>$$ 式中 : $\beta_i$ 是单元 $i$ 的平均退化速率, 对单元 $i$ 的所有测量是恒定不变的。</span>
<span id="cb58-460"><a href="#cb58-460"></a></span>
<span id="cb58-461"><a href="#cb58-461"></a>定义时间间隔 $\Delta t_{i j}=t_{i j}-t_{i j-1}$, 观测的退化增量为 $\Delta Y_{i j}=Y_i\left(t_{i j}\right)-Y_i\left(t_{i j-1}\right), j=1$, $2, \cdots, m_i$; 根据 Wiener 过程定义, $t_{i 0}=0, Y_i\left(t_{i 0}\right)=0$ 。为叙述方便, 令 $$</span>
<span id="cb58-462"><a href="#cb58-462"></a>\Delta t_i=\left(\Delta t_{i 1}, \cdots, \Delta t_{i m_i}\right)^{\mathrm{T}}, \Delta \boldsymbol{Y}_i=\left(\Delta Y_{i 1}, \cdots, \Delta Y_{i m_i}\right)^{\mathrm{T}}</span>
<span id="cb58-463"><a href="#cb58-463"></a>$$</span>
<span id="cb58-464"><a href="#cb58-464"></a></span>
<span id="cb58-465"><a href="#cb58-465"></a>根据 Wiener 过程的独立增量性质, 得到 $$</span>
<span id="cb58-466"><a href="#cb58-466"></a>\begin{gathered}</span>
<span id="cb58-467"><a href="#cb58-467"></a>E\left<span class="co">[</span><span class="ot">\Delta \boldsymbol{Y}_i\right</span><span class="co">]</span>=\mu_\beta \Delta \boldsymbol{t}_i <span class="sc">\\</span></span>
<span id="cb58-468"><a href="#cb58-468"></a>\operatorname{Cov}\left(\Delta \boldsymbol{Y}_i\right) \triangleq \Sigma_i=\sigma_\beta^2 \Delta \boldsymbol{t}_i \Delta t_i^{\mathrm{T}}+\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i <span class="sc">\\</span></span>
<span id="cb58-469"><a href="#cb58-469"></a>\end{gathered}</span>
<span id="cb58-470"><a href="#cb58-470"></a>$$ 其中， $$</span>
<span id="cb58-471"><a href="#cb58-471"></a>\boldsymbol{K}_i=\operatorname{diag}\left(\Delta \boldsymbol{t}_i\right), \boldsymbol{P}_i=\left[\begin{array}{ccccc}</span>
<span id="cb58-472"><a href="#cb58-472"></a>2 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 <span class="sc">\\</span></span>
<span id="cb58-473"><a href="#cb58-473"></a>-1 &amp; 2 &amp; -1 &amp; \cdots &amp; 0 <span class="sc">\\</span></span>
<span id="cb58-474"><a href="#cb58-474"></a>0 &amp; -1 &amp; 2 &amp; \cdots &amp; 0 <span class="sc">\\</span></span>
<span id="cb58-475"><a href="#cb58-475"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb58-476"><a href="#cb58-476"></a>0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2</span>
<span id="cb58-477"><a href="#cb58-477"></a>\end{array}\right]</span>
<span id="cb58-478"><a href="#cb58-478"></a>$$</span>
<span id="cb58-479"><a href="#cb58-479"></a></span>
<span id="cb58-480"><a href="#cb58-480"></a>设退化数据为 $\Delta \boldsymbol{Y}_i=\Delta \boldsymbol{y}_i, i=1,2, \cdots, n$, 则参数 $\boldsymbol{\theta}$ 的似然函数为 $$</span>
<span id="cb58-481"><a href="#cb58-481"></a>L(\boldsymbol{\theta})=\prod_{i=1}^n \frac{1}{(2 \pi)^{\frac{m_i}{2}} \sqrt{\left|\Sigma_i\right|}} \exp \left<span class="sc">\{</span>-\frac{1}{2}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \Sigma_i^{-1}\left(\Delta \boldsymbol{y}_i-\mu_\beta \Delta \boldsymbol{t}_i\right)\right<span class="sc">\}</span></span>
<span id="cb58-482"><a href="#cb58-482"></a>$$ 令 $\Sigma_i=\sigma_\beta^2 \Delta t_i \Delta t_i^{\mathrm{T}}+\boldsymbol{\Omega}_i$, 其中 $\boldsymbol{\Omega}_i=\sigma_B^2 \boldsymbol{K}_i+\sigma_R^2 \boldsymbol{P}_i$ 定义 $$</span>
<span id="cb58-483"><a href="#cb58-483"></a>\phi_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{y}_i, \rho_i=\Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta t_i</span>
<span id="cb58-484"><a href="#cb58-484"></a>$$ 取对数似然函数关于 $\mu_\beta$ 和 $\sigma_\beta^2$ 的一阶偏导数, 并利用下面的公式 $$</span>
<span id="cb58-485"><a href="#cb58-485"></a>\begin{aligned}</span>
<span id="cb58-486"><a href="#cb58-486"></a>\left|\boldsymbol{\Sigma}_i\right| &amp;=\left|\boldsymbol{\Omega}_i\right|\left(1+\sigma_\beta^2 \Delta t_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i\right)=\left(\boldsymbol{\Omega}_i \mid\left(1+\sigma_\beta^2 \rho_i\right)\right.<span class="sc">\\</span></span>
<span id="cb58-487"><a href="#cb58-487"></a>\boldsymbol{\Sigma}_i^{-1} &amp;=\boldsymbol{\Omega}_i^{-1}-\frac{\sigma_\beta^2}{1+\sigma_\beta^2 \rho_i} \boldsymbol{\Omega}_i^{-1} \Delta \boldsymbol{t}_i \Delta \boldsymbol{t}_i^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}(\text { Woodbury 公式 })</span>
<span id="cb58-488"><a href="#cb58-488"></a>\end{aligned}</span>
<span id="cb58-489"><a href="#cb58-489"></a>$$</span>
<span id="cb58-490"><a href="#cb58-490"></a></span>
<span id="cb58-491"><a href="#cb58-491"></a>得到 $$</span>
<span id="cb58-492"><a href="#cb58-492"></a>\frac{\partial}{\partial \mu_\beta} l(\boldsymbol{\theta})=\sum_{i=1}^n \frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}</span>
<span id="cb58-493"><a href="#cb58-493"></a>$$ 和 $$</span>
<span id="cb58-494"><a href="#cb58-494"></a>\frac{\partial}{\partial \sigma_\beta^2} l(\boldsymbol{\theta})=\sum_{i=1}^n\left(\frac{\phi_i-\mu_\beta \rho_i}{1+\sigma_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\sigma_\beta^2 \rho_i}</span>
<span id="cb58-495"><a href="#cb58-495"></a>$$ 于是, 对特定的 $\left(\sigma_B, \sigma_R\right)$ 取值, 置式 (3.62) 和式 (3.63) 等于 0 , 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的如下限制极大似然估计: $$</span>
<span id="cb58-496"><a href="#cb58-496"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb58-497"><a href="#cb58-497"></a>\hat{\mu}_\beta=\sum_{i=1}^n \frac{\phi_i}{1+\hat{\sigma}_\beta^2 \rho_i} / \sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i} <span class="sc">\\</span></span>
<span id="cb58-498"><a href="#cb58-498"></a>\sum_{i=1}^n\left(\frac{\phi_i-\hat{\mu}_\beta \rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}\right)^2-\sum_{i=1}^n \frac{\rho_i}{1+\hat{\sigma}_\beta^2 \rho_i}=0</span>
<span id="cb58-499"><a href="#cb58-499"></a>\end{array}\right.</span>
<span id="cb58-500"><a href="#cb58-500"></a>$$ 将上式代人 $\theta$ 的对数似然函数,则得到如下的截面似然函数: $$</span>
<span id="cb58-501"><a href="#cb58-501"></a>\begin{aligned}</span>
<span id="cb58-502"><a href="#cb58-502"></a>l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{1}{2} \sum_{i=1}^n m_i \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^n \ln \left|\boldsymbol{\Omega}_i\right|-\frac{1}{2} \sum_{i=1}^n \ln \left(1+\hat{\sigma}_\beta^2 \rho_i\right) <span class="sc">\\</span></span>
<span id="cb58-503"><a href="#cb58-503"></a>&amp;-\frac{1}{2} \sum_{i=1}^n\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right)^{\mathrm{T}} \boldsymbol{\Omega}_i^{-1}\left(\Delta \boldsymbol{y}_i-\hat{\mu}_\beta \Delta \boldsymbol{t}_i\right) <span class="sc">\\</span></span>
<span id="cb58-504"><a href="#cb58-504"></a>&amp;+\frac{1}{2} \sum_{i=1}^n \frac{\hat{\sigma}_\beta^2\left(\phi_i-\hat{\mu}_\beta \rho_i\right)^2}{1+\hat{\sigma}_\beta^2 \rho_i}</span>
<span id="cb58-505"><a href="#cb58-505"></a>\end{aligned}</span>
<span id="cb58-506"><a href="#cb58-506"></a>$$ 通过最大化上述截面似然函数, 得到 $\sigma_B$ 和 $\sigma_R$ 的极大似然估计 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$, 这可通过 2 维搜索算法实现。最后将 $\left(\hat{\sigma}_B, \hat{\sigma}_R\right)$ 代人式 (3.64), 得到 $\mu_\beta$ 和 $\sigma_\beta$ 的极大似然估计。</span>
<span id="cb58-507"><a href="#cb58-507"></a></span>
<span id="cb58-508"><a href="#cb58-508"></a>当所有观测时间相同时, 诸 $\rho_i$ 相同, 记为 $\rho$, 可以得到 $\hat{\mu}_\beta$ 和 $\hat{\sigma}_\beta^2$ 的解析形式, 即 $$</span>
<span id="cb58-509"><a href="#cb58-509"></a>\begin{gathered}</span>
<span id="cb58-510"><a href="#cb58-510"></a>\hat{\mu}_\beta=\frac{1}{n \rho} \sum_{i=1}^n \phi_i=\frac{1}{n} \sum_{i=1}^n \frac{\phi_i}{\rho} \triangleq \frac{1}{n} \sum_{i=1}^n \hat{\mu}_{\beta, i} <span class="sc">\\</span></span>
<span id="cb58-511"><a href="#cb58-511"></a>\hat{\sigma}_\beta^2=\frac{1}{n \rho^2} \sum_{i=1}^n\left(\phi_i-\hat{\mu}_\beta \rho\right)^2-\frac{1}{\rho}=\frac{1}{n} \sum_{i=1}^n\left(\hat{\mu}_{\beta, i}-\hat{\mu}_\beta\right)^2-\frac{1}{\rho}</span>
<span id="cb58-512"><a href="#cb58-512"></a>\end{gathered}</span>
<span id="cb58-513"><a href="#cb58-513"></a>$$ 容易看出, $\hat{\mu}_{\beta, i}$ 实际上是单元 $i$ 的退化速率的加权最小二乘估计, $\hat{\sigma}_\beta^2$ 的第一项是估 计的退化速率的方差。此时, 可以得到截面似然函数的比较简单的形式, 如下所示: $$</span>
<span id="cb58-514"><a href="#cb58-514"></a>\begin{aligned}</span>
<span id="cb58-515"><a href="#cb58-515"></a>l\left(\sigma_B, \sigma_R\right)=&amp;-\frac{n m}{2} \ln (2 \pi)-\frac{n}{2}-\frac{n}{2} \ln |\boldsymbol{\Omega}| <span class="sc">\\</span></span>
<span id="cb58-516"><a href="#cb58-516"></a>&amp;-\frac{1}{2}\left<span class="sc">\{</span>\sum_{i=1}^n \Delta \boldsymbol{y}_i^{\mathrm{T}} \boldsymbol{\Omega}^{-1} \Delta \boldsymbol{y}_i-\frac{1}{\rho} \sum_{i=1}^n \phi_i^2\right<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb58-517"><a href="#cb58-517"></a>&amp;-\frac{n}{2} \ln \left(\frac{1}{n \rho} \sum_{i=1}^n \phi_i^2-\frac{1}{n^2 \rho}\left(\sum_{i=1}^n \phi_i\right)^2\right)</span>
<span id="cb58-518"><a href="#cb58-518"></a>\end{aligned}</span>
<span id="cb58-519"><a href="#cb58-519"></a>$$</span>
<span id="cb58-520"><a href="#cb58-520"></a></span>
<span id="cb58-521"><a href="#cb58-521"></a><span class="fu">### 3.3 案例分析</span></span>
<span id="cb58-522"><a href="#cb58-522"></a></span>
<span id="cb58-523"><a href="#cb58-523"></a><span class="fu">#### 3.3.1 NASA 锂电池数据</span></span>
<span id="cb58-524"><a href="#cb58-524"></a></span>
<span id="cb58-525"><a href="#cb58-525"></a><span class="at">&gt; 数据来源于</span><span class="co">[</span><span class="ot">NASA Ames Prognostics Center of Excellence (PCoE)</span><span class="co">](https://c3.ndc.nasa.gov/dashlink/resources/133/)</span><span class="at">，但是找不到数据下载。最后是通过 </span><span class="co">[</span><span class="ot">Github</span><span class="co">](https://github.com/psanabriaUC/BatteryDatasetImplementation)</span><span class="at"> 获得。</span></span>
<span id="cb58-526"><a href="#cb58-526"></a></span>
<span id="cb58-527"><a href="#cb58-527"></a>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即**充电**、**放电**和**测量 EIS**。</span>
<span id="cb58-528"><a href="#cb58-528"></a></span>
<span id="cb58-529"><a href="#cb58-529"></a>充电是以**恒流模**式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以**恒压模式**(CV)继续充电直到电流降到 20mA。</span>
<span id="cb58-530"><a href="#cb58-530"></a></span>
<span id="cb58-531"><a href="#cb58-531"></a>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</span>
<span id="cb58-532"><a href="#cb58-532"></a></span>
<span id="cb58-533"><a href="#cb58-533"></a>重复充电和放电将导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</span>
<span id="cb58-534"><a href="#cb58-534"></a></span>
<span id="cb58-537"><a href="#cb58-537"></a><span class="in">```{r}</span></span>
<span id="cb58-538"><a href="#cb58-538"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb58-539"><a href="#cb58-539"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(liion_data))</span>
<span id="cb58-540"><a href="#cb58-540"></a><span class="in">```</span></span>
<span id="cb58-541"><a href="#cb58-541"></a></span>
<span id="cb58-544"><a href="#cb58-544"></a><span class="in">```{r}</span></span>
<span id="cb58-545"><a href="#cb58-545"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb58-546"><a href="#cb58-546"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb58-547"><a href="#cb58-547"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-548"><a href="#cb58-548"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-549"><a href="#cb58-549"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span>
<span id="cb58-550"><a href="#cb58-550"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span>
<span id="cb58-551"><a href="#cb58-551"></a><span class="in">```</span></span>
<span id="cb58-552"><a href="#cb58-552"></a></span>
<span id="cb58-553"><a href="#cb58-553"></a>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用维纳过程来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</span>
<span id="cb58-554"><a href="#cb58-554"></a></span>
<span id="cb58-557"><a href="#cb58-557"></a><span class="in">```{r}</span></span>
<span id="cb58-558"><a href="#cb58-558"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb58-559"><a href="#cb58-559"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb58-560"><a href="#cb58-560"></a></span>
<span id="cb58-561"><a href="#cb58-561"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb58-562"><a href="#cb58-562"></a></span>
<span id="cb58-563"><a href="#cb58-563"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb58-564"><a href="#cb58-564"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb58-565"><a href="#cb58-565"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-566"><a href="#cb58-566"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-567"><a href="#cb58-567"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb58-568"><a href="#cb58-568"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb58-569"><a href="#cb58-569"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb58-570"><a href="#cb58-570"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-571"><a href="#cb58-571"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-572"><a href="#cb58-572"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-573"><a href="#cb58-573"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span>
<span id="cb58-574"><a href="#cb58-574"></a><span class="in">```</span></span>
<span id="cb58-575"><a href="#cb58-575"></a></span>
<span id="cb58-576"><a href="#cb58-576"></a>前面对数据进行了导入、处理以及可视化。接下来，使用经典的线性维纳过程对其进行建模。</span>
<span id="cb58-577"><a href="#cb58-577"></a></span>
<span id="cb58-580"><a href="#cb58-580"></a><span class="in">```{r}</span></span>
<span id="cb58-581"><a href="#cb58-581"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb58-582"><a href="#cb58-582"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb58-583"><a href="#cb58-583"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb58-584"><a href="#cb58-584"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb58-585"><a href="#cb58-585"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb58-586"><a href="#cb58-586"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span>
<span id="cb58-587"><a href="#cb58-587"></a><span class="in">```</span></span>
<span id="cb58-588"><a href="#cb58-588"></a></span>
<span id="cb58-591"><a href="#cb58-591"></a><span class="in">```{r}</span></span>
<span id="cb58-592"><a href="#cb58-592"></a>mle_re <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb58-593"><a href="#cb58-593"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(liion_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-594"><a href="#cb58-594"></a>mle_par <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb58-595"><a href="#cb58-595"></a>mle_par</span>
<span id="cb58-596"><a href="#cb58-596"></a><span class="in">```</span></span>
<span id="cb58-597"><a href="#cb58-597"></a></span>
<span id="cb58-598"><a href="#cb58-598"></a>计算可靠度并绘图</span>
<span id="cb58-599"><a href="#cb58-599"></a></span>
<span id="cb58-602"><a href="#cb58-602"></a><span class="in">```{r}</span></span>
<span id="cb58-603"><a href="#cb58-603"></a><span class="co"># 计算可靠度</span></span>
<span id="cb58-604"><a href="#cb58-604"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span>
<span id="cb58-605"><a href="#cb58-605"></a>time_region <span class="ot">=</span> <span class="dv">400</span></span>
<span id="cb58-606"><a href="#cb58-606"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb58-607"><a href="#cb58-607"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb58-608"><a href="#cb58-608"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb58-609"><a href="#cb58-609"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb58-610"><a href="#cb58-610"></a>}</span>
<span id="cb58-611"><a href="#cb58-611"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb58-612"><a href="#cb58-612"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb58-613"><a href="#cb58-613"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb58-614"><a href="#cb58-614"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb58-615"><a href="#cb58-615"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb58-616"><a href="#cb58-616"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-617"><a href="#cb58-617"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb58-618"><a href="#cb58-618"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-619"><a href="#cb58-619"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-620"><a href="#cb58-620"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span>
<span id="cb58-621"><a href="#cb58-621"></a><span class="in">```</span></span>
<span id="cb58-622"><a href="#cb58-622"></a></span>
<span id="cb58-623"><a href="#cb58-623"></a><span class="fu">#### 3.3.2 激光器件 Laser 数据集</span></span>
<span id="cb58-624"><a href="#cb58-624"></a></span>
<span id="cb58-625"><a href="#cb58-625"></a><span class="at">&gt; 数据集来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。</span></span>
<span id="cb58-626"><a href="#cb58-626"></a></span>
<span id="cb58-627"><a href="#cb58-627"></a>激光器件的质量特征是其**工作电流**。当工作电流达到预定义的阈值水平ω = 10时，该设备被认为是故障。其电流的测量频率为每250小时一次，实验在4000小时时终止。图1(a)显示了15个被测试单元的降解路径及其拟合的平均趋势。</span>
<span id="cb58-628"><a href="#cb58-628"></a></span>
<span id="cb58-631"><a href="#cb58-631"></a><span class="in">```{r}</span></span>
<span id="cb58-632"><a href="#cb58-632"></a>Laser_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/GaAsLaser.csv"</span>)</span>
<span id="cb58-633"><a href="#cb58-633"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Laser_dat))</span>
<span id="cb58-634"><a href="#cb58-634"></a>Laser_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(Laser_dat<span class="sc">$</span>Unit)</span>
<span id="cb58-635"><a href="#cb58-635"></a><span class="in">```</span></span>
<span id="cb58-636"><a href="#cb58-636"></a></span>
<span id="cb58-639"><a href="#cb58-639"></a><span class="in">```{r}</span></span>
<span id="cb58-640"><a href="#cb58-640"></a>Laser_dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb58-641"><a href="#cb58-641"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb58-642"><a href="#cb58-642"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb58-643"><a href="#cb58-643"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb58-644"><a href="#cb58-644"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb58-645"><a href="#cb58-645"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb58-646"><a href="#cb58-646"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb58-647"><a href="#cb58-647"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Hours"</span>, <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb58-648"><a href="#cb58-648"></a><span class="in">```</span></span>
<span id="cb58-649"><a href="#cb58-649"></a></span>
<span id="cb58-652"><a href="#cb58-652"></a><span class="in">```{r}</span></span>
<span id="cb58-653"><a href="#cb58-653"></a>Laser_dat <span class="sc">%&gt;%</span> </span>
<span id="cb58-654"><a href="#cb58-654"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb58-655"><a href="#cb58-655"></a>    <span class="at">names_from =</span> <span class="st">"Unit"</span>,</span>
<span id="cb58-656"><a href="#cb58-656"></a>    <span class="at">values_from =</span> <span class="st">"Value"</span>)  <span class="ot">-&gt;</span> Laser_new</span>
<span id="cb58-657"><a href="#cb58-657"></a><span class="in">```</span></span>
<span id="cb58-658"><a href="#cb58-658"></a></span>
<span id="cb58-661"><a href="#cb58-661"></a><span class="in">```{r}</span></span>
<span id="cb58-662"><a href="#cb58-662"></a>mle_Laser <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">fn =</span> Weiner_mle, </span>
<span id="cb58-663"><a href="#cb58-663"></a>      <span class="at">data =</span> <span class="fu">data.frame</span>(Laser_new), <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-664"><a href="#cb58-664"></a>mle_par <span class="ot">=</span> mle_Laser<span class="sc">$</span>par</span>
<span id="cb58-665"><a href="#cb58-665"></a>mle_par</span>
<span id="cb58-666"><a href="#cb58-666"></a><span class="in">```</span></span>
<span id="cb58-667"><a href="#cb58-667"></a></span>
<span id="cb58-668"><a href="#cb58-668"></a>计算可靠度并绘图，阈值设置参考 Wang, X., et al. (2020). "Accurate reliability inference based on Wiener process with random effects for degradation data." Reliability Engineering &amp; System Safety **193**. 第6节案例分析</span>
<span id="cb58-669"><a href="#cb58-669"></a></span>
<span id="cb58-670"><a href="#cb58-670"></a>这里将每个测试单元的可靠度进行绘制，但是由于类似，所以重复在一条线上了。</span>
<span id="cb58-671"><a href="#cb58-671"></a></span>
<span id="cb58-672"><a href="#cb58-672"></a><span class="at">&gt; 可拓展：加入90%，95%的 R（计算参数的区间估计）；所有测试单元求平均得到可靠度。</span></span>
<span id="cb58-673"><a href="#cb58-673"></a></span>
<span id="cb58-676"><a href="#cb58-676"></a><span class="in">```{r}</span></span>
<span id="cb58-677"><a href="#cb58-677"></a><span class="co"># 计算可靠度</span></span>
<span id="cb58-678"><a href="#cb58-678"></a><span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">5000</span>, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb58-679"><a href="#cb58-679"></a>time_region <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb58-680"><a href="#cb58-680"></a><span class="co"># 绘制15个测试单元的可靠度图</span></span>
<span id="cb58-681"><a href="#cb58-681"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb58-682"><a href="#cb58-682"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Laser_new)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb58-683"><a href="#cb58-683"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">Wiener_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> <span class="dv">10</span>, <span class="at">par =</span> mle_par)</span>
<span id="cb58-684"><a href="#cb58-684"></a>}</span>
<span id="cb58-685"><a href="#cb58-685"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb58-686"><a href="#cb58-686"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb58-687"><a href="#cb58-687"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">colnames</span>(Laser_new)</span>
<span id="cb58-688"><a href="#cb58-688"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">colnames</span>(Laser_new)[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb58-689"><a href="#cb58-689"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb58-690"><a href="#cb58-690"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-691"><a href="#cb58-691"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,y,<span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb58-692"><a href="#cb58-692"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-693"><a href="#cb58-693"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>) <span class="sc">+</span> </span>
<span id="cb58-694"><a href="#cb58-694"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb58-695"><a href="#cb58-695"></a></span>
<span id="cb58-696"><a href="#cb58-696"></a><span class="in">```</span></span>
<span id="cb58-697"><a href="#cb58-697"></a></span>
<span id="cb58-698"><a href="#cb58-698"></a><span class="fu">#### 3.3.3 炭膜电阻器 carbon-film resistors</span></span>
<span id="cb58-699"><a href="#cb58-699"></a></span>
<span id="cb58-700"><a href="#cb58-700"></a><span class="at">&gt; 退化数据来自 Meeker, W. Q. (1998). Statistical Methods for Reliability Data。（常应力下的加速退化数据）。</span></span>
<span id="cb58-701"><a href="#cb58-701"></a></span>
<span id="cb58-702"><a href="#cb58-702"></a>在某些电阻器的操作过程中，退化会导致电阻的增加。当电阻的增加百分比达到退化阈值水平时，电阻就失效了。</span>
<span id="cb58-703"><a href="#cb58-703"></a></span>
<span id="cb58-704"><a href="#cb58-704"></a>Zhou2022 只使用了 83 摄氏度下的测试数据。数据中有10个碳膜电阻的测试样品，在83C温度下，在相同的检测时间点452 h, 1030 h, 4341 h, 8084 h测量。10个碳膜电阻的电阻百分比递增路径如下图所示。</span>
<span id="cb58-705"><a href="#cb58-705"></a></span>
<span id="cb58-708"><a href="#cb58-708"></a><span class="in">```{r}</span></span>
<span id="cb58-709"><a href="#cb58-709"></a>resistor_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/Resistor.csv"</span>)</span>
<span id="cb58-710"><a href="#cb58-710"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(resistor_dat))</span>
<span id="cb58-711"><a href="#cb58-711"></a><span class="fu">colnames</span>(resistor_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Value"</span>,<span class="st">"Unit"</span>,<span class="st">"Degree"</span>,<span class="st">"Hours"</span>)</span>
<span id="cb58-712"><a href="#cb58-712"></a>resistor_dat<span class="sc">$</span>Unit <span class="ot">=</span> <span class="fu">as.factor</span>(resistor_dat<span class="sc">$</span>Unit)</span>
<span id="cb58-713"><a href="#cb58-713"></a><span class="in">```</span></span>
<span id="cb58-714"><a href="#cb58-714"></a></span>
<span id="cb58-717"><a href="#cb58-717"></a><span class="in">```{r}</span></span>
<span id="cb58-718"><a href="#cb58-718"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb58-719"><a href="#cb58-719"></a>resistor_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Degree <span class="sc">==</span> <span class="dv">83</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-720"><a href="#cb58-720"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Hours,Value,<span class="at">fill =</span> Unit)) <span class="sc">+</span></span>
<span id="cb58-721"><a href="#cb58-721"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb58-722"><a href="#cb58-722"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb58-723"><a href="#cb58-723"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb58-724"><a href="#cb58-724"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb58-725"><a href="#cb58-725"></a>  <span class="co"># scale_color_viridis(discrete = T) + </span></span>
<span id="cb58-726"><a href="#cb58-726"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb58-727"><a href="#cb58-727"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Hours($10^3$))"</span>), <span class="at">y =</span> <span class="st">"Degradation characteristic"</span>)</span>
<span id="cb58-728"><a href="#cb58-728"></a><span class="in">```</span></span>
<span id="cb58-729"><a href="#cb58-729"></a></span>
<span id="cb58-730"><a href="#cb58-730"></a>后续参数估计和可靠度估计就先不做了。</span>
<span id="cb58-731"><a href="#cb58-731"></a></span>
<span id="cb58-732"><a href="#cb58-732"></a>类似的数据集还包括：</span>
<span id="cb58-733"><a href="#cb58-733"></a></span>
<span id="cb58-734"><a href="#cb58-734"></a><span class="fu">#### 3.3.4 惯导平台 interial navigition 数据</span></span>
<span id="cb58-735"><a href="#cb58-735"></a></span>
<span id="cb58-736"><a href="#cb58-736"></a><span class="at">&gt; 数据来自于文献：Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability **61**(1): 50-67.</span></span>
<span id="cb58-737"><a href="#cb58-737"></a></span>
<span id="cb58-738"><a href="#cb58-738"></a>惯导平台是武器系统、空间设备等的惯性导航系统的关键部件，其运行状态直接影响导航精度。惯导平台中的传感器主要包括3个陀螺仪、3 个加速度计，分别用于测量角速度和线加速度。统计分析表明，惯性平台几乎70%的失效来自于陀螺漂移。</span>
<span id="cb58-739"><a href="#cb58-739"></a></span>
<span id="cb58-740"><a href="#cb58-740"></a>下面的例子中,安装在惯导平台中的陀螺是在驱动和传感两个轴上具有两个自由度的机械结构。当惯性平台运行时，陀螺的转子以很高的速度转动，将导致旋转轴的磨损，并最终导致陀螺漂移。随着磨损的累积,漂移也逐渐增大，最终导致陀螺的失效。因此，陀螺漂移是用于评估惯性平台健康状态的一个性能指标。</span>
<span id="cb58-741"><a href="#cb58-741"></a></span>
<span id="cb58-742"><a href="#cb58-742"></a>图给出的是传感轴的漂移退化测量数据，与驱动轴相比,传感轴的漂移在评价陀螺退化时占主要地位。退化试验数据包括5个试验样品，每个产品进行9次测量，试验条件与现场条件相似。</span>
<span id="cb58-743"><a href="#cb58-743"></a></span>
<span id="cb58-744"><a href="#cb58-744"></a><span class="al">![](images/paste-40CEA295.png)</span></span>
<span id="cb58-745"><a href="#cb58-745"></a></span>
<span id="cb58-748"><a href="#cb58-748"></a><span class="in">```{r}</span></span>
<span id="cb58-749"><a href="#cb58-749"></a>interial_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/interial_navigition.csv"</span>)</span>
<span id="cb58-750"><a href="#cb58-750"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(interial_dat))</span>
<span id="cb58-751"><a href="#cb58-751"></a><span class="in">```</span></span>
<span id="cb58-752"><a href="#cb58-752"></a></span>
<span id="cb58-753"><a href="#cb58-753"></a>该数据需要用非线性的漂移参数的维纳过程来刻画。暂时按下不表。</span>
<span id="cb58-754"><a href="#cb58-754"></a></span>
<span id="cb58-757"><a href="#cb58-757"></a><span class="in">```{r}</span></span>
<span id="cb58-758"><a href="#cb58-758"></a>interial_new <span class="ot">=</span> interial_dat <span class="sc">%&gt;%</span> </span>
<span id="cb58-759"><a href="#cb58-759"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item5</span><span class="st">`</span>, </span>
<span id="cb58-760"><a href="#cb58-760"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb58-761"><a href="#cb58-761"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb58-762"><a href="#cb58-762"></a></span>
<span id="cb58-763"><a href="#cb58-763"></a>interial_new <span class="sc">%&gt;%</span> </span>
<span id="cb58-764"><a href="#cb58-764"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,Value)) <span class="sc">+</span> </span>
<span id="cb58-765"><a href="#cb58-765"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb58-766"><a href="#cb58-766"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb58-767"><a href="#cb58-767"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb58-768"><a href="#cb58-768"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb58-769"><a href="#cb58-769"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb58-770"><a href="#cb58-770"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb58-771"><a href="#cb58-771"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb58-772"><a href="#cb58-772"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-773"><a href="#cb58-773"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span>
<span id="cb58-774"><a href="#cb58-774"></a><span class="in">```</span></span>
<span id="cb58-775"><a href="#cb58-775"></a></span>
<span id="cb58-776"><a href="#cb58-776"></a><span class="fu">#### 3.3.5 铝合金疲劳裂纹长度 2017-T4 Aluminum Alloy</span></span>
<span id="cb58-777"><a href="#cb58-777"></a></span>
<span id="cb58-778"><a href="#cb58-778"></a><span class="at">&gt; 数据来自： (Si, X. S., et al. (2012). "Remaining Useful Life Estimation Based on a Nonlinear Diffusion Degradation Process." IEEE Transactions on Reliability 61(1): 50-67).</span></span>
<span id="cb58-779"><a href="#cb58-779"></a></span>
<span id="cb58-780"><a href="#cb58-780"></a>它是飞机上常用的金属材料，这种材料的完整性通过**疲劳裂纹的长度**来评估。当疲劳裂纹的长度等于或大于预先设定的阈值6mm时，这种材料制成的结构被认为处于非常临界的状态，并被定义为失效。得到的数据代表了2017-T4铝合金4个试件在200 MPa应力水平下的裂纹长度扩展，模拟了实际操作条件。</span>
<span id="cb58-781"><a href="#cb58-781"></a></span>
<span id="cb58-782"><a href="#cb58-782"></a>对于每个项目，疲劳裂纹长度记录在增加100,000循环，直到实验结束。在测试过程中，为每个项目记录了十个裂缝级别。**退化过程存在非线性**。</span>
<span id="cb58-783"><a href="#cb58-783"></a></span>
<span id="cb58-786"><a href="#cb58-786"></a><span class="in">```{r}</span></span>
<span id="cb58-787"><a href="#cb58-787"></a>Alloy_dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/2017-T4 Aluminum Alloy.csv"</span>)</span>
<span id="cb58-788"><a href="#cb58-788"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Alloy_dat))</span>
<span id="cb58-789"><a href="#cb58-789"></a><span class="in">```</span></span>
<span id="cb58-790"><a href="#cb58-790"></a></span>
<span id="cb58-793"><a href="#cb58-793"></a><span class="in">```{r}</span></span>
<span id="cb58-794"><a href="#cb58-794"></a>Alloy_new <span class="ot">=</span> Alloy_dat <span class="sc">%&gt;%</span> </span>
<span id="cb58-795"><a href="#cb58-795"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">Item1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Item4</span><span class="st">`</span>, </span>
<span id="cb58-796"><a href="#cb58-796"></a>    <span class="at">names_to =</span> <span class="st">"Product"</span>, </span>
<span id="cb58-797"><a href="#cb58-797"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb58-798"><a href="#cb58-798"></a></span>
<span id="cb58-799"><a href="#cb58-799"></a>Alloy_new <span class="sc">%&gt;%</span> </span>
<span id="cb58-800"><a href="#cb58-800"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cycle,Value)) <span class="sc">+</span> </span>
<span id="cb58-801"><a href="#cb58-801"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product)) <span class="sc">+</span></span>
<span id="cb58-802"><a href="#cb58-802"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Product,<span class="at">shape =</span> Product)) <span class="sc">+</span> </span>
<span id="cb58-803"><a href="#cb58-803"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"D"</span>,<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-804"><a href="#cb58-804"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb58-805"><a href="#cb58-805"></a>  <span class="fu">ylab</span>(<span class="st">"Condition monitoring time (hours)"</span>) <span class="sc">+</span></span>
<span id="cb58-806"><a href="#cb58-806"></a>  <span class="fu">xlab</span>(<span class="st">"Gyropic drift (/h)"</span>) <span class="sc">+</span> </span>
<span id="cb58-807"><a href="#cb58-807"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-808"><a href="#cb58-808"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) </span>
<span id="cb58-809"><a href="#cb58-809"></a><span class="in">```</span></span>
<span id="cb58-810"><a href="#cb58-810"></a></span>
<span id="cb58-811"><a href="#cb58-811"></a><span class="fu">## 4. Gamma退化过程模型</span></span>
<span id="cb58-812"><a href="#cb58-812"></a></span>
<span id="cb58-813"><a href="#cb58-813"></a>Gamma 过程描述的退化过程是严格单调非负的，并且Gamma 过程是纯跳过程，其样本路径不连续，既可描述连续的微小冲击导致的缓慢退化，也可以描述大的冲击导致的大的损伤。</span>
<span id="cb58-814"><a href="#cb58-814"></a></span>
<span id="cb58-815"><a href="#cb58-815"></a><span class="fu">### 4.1 经典 Gamma 过程</span></span>
<span id="cb58-816"><a href="#cb58-816"></a></span>
<span id="cb58-817"><a href="#cb58-817"></a><span class="fu">#### 似然函数</span></span>
<span id="cb58-818"><a href="#cb58-818"></a></span>
<span id="cb58-819"><a href="#cb58-819"></a>假设共有 $\mathrm{n}$ 个样品进行性能退化试验. 对于样品 $i$, 初始时刻 $t_0$ 性 能退化量为 $X_{i 0}=0$, 在时刻 $t_1, \cdots, t_{m_i}$ 测量产品的性能退化量, 得到 其测量值为 $X_{i 1}, \cdots, X_{i m_i}$. 记 $\Delta x_{i j}=X_{i j}-X_{i(j-1)}$ 是样品 $i$ 在时刻 $t_{j-1}$ 和 $t_j$ 之间的性能退化量, 由 Gamma 过程的独立增量性得到$\Delta X(t) \sim Ga(\alpha \Delta t_{ij},\beta)$。则似然函数为</span>
<span id="cb58-820"><a href="#cb58-820"></a></span>
<span id="cb58-821"><a href="#cb58-821"></a>$$</span>
<span id="cb58-822"><a href="#cb58-822"></a>l(\alpha, \beta)=\sum_{i=1}^n\left(\sum_{j=1}^{m_i}\left(\alpha \Delta t_{i j}-1\right) \ln \Delta x_{i j}-\alpha t_{i m_i} \ln \beta-\sum_{j=1}^{m_i} \ln \Gamma\left(\alpha \Delta t_{i j}\right)-\frac{x_{i m_i}}{\beta}\right)</span>
<span id="cb58-823"><a href="#cb58-823"></a>$$</span>
<span id="cb58-824"><a href="#cb58-824"></a></span>
<span id="cb58-825"><a href="#cb58-825"></a><span class="fu">#### 产品寿命</span></span>
<span id="cb58-826"><a href="#cb58-826"></a></span>
<span id="cb58-827"><a href="#cb58-827"></a>因为Gamma 过程的退化是单调递增的，即$X(t) \sim Ga(\alpha t,\beta)$ ,因此**产品寿命**的分布可以通过退化量的转变关系获得。当给定产品退化失效阈值 $\ell$ 时，产品寿命 $T$ 的CDF和PDF为</span>
<span id="cb58-828"><a href="#cb58-828"></a></span>
<span id="cb58-829"><a href="#cb58-829"></a>$$</span>
<span id="cb58-830"><a href="#cb58-830"></a>\begin{aligned}</span>
<span id="cb58-831"><a href="#cb58-831"></a>\mathrm{F}_{\mathrm{T}}(t) &amp;=\mathrm{P}(\mathrm{T} \leqslant \mathrm{t})=\mathrm{P}(\mathrm{X}(\mathrm{t}) \geqslant \ell) <span class="sc">\\</span></span>
<span id="cb58-832"><a href="#cb58-832"></a>&amp;=\int_{\ell}^{\infty} \frac{1}{\Gamma(\alpha \mathrm{t}) \beta^{\alpha \mathrm{t}}} \mathrm{x}^{\alpha \mathrm{t}-1} \mathrm{e}^{-\frac{\mathrm{x}}{\beta}} \mathrm{dx} <span class="sc">\\</span></span>
<span id="cb58-833"><a href="#cb58-833"></a>&amp;=\frac{1}{\Gamma(\alpha \mathrm{t})} \int_{\frac{\ell}{\beta}}^{\infty} \xi^{\alpha \mathrm{t}-1} \mathrm{e}^{-\xi} \mathrm{d} \xi ,<span class="sc">\\</span></span>
<span id="cb58-834"><a href="#cb58-834"></a>\mathrm{f}_{\mathrm{T}}(t) &amp;=\frac{\mathrm{d}}{\mathrm{dt}} \frac{\Gamma(\alpha \mathrm{t}, 1 / \beta)}{\Gamma(\alpha \mathrm{t})} <span class="sc">\\</span></span>
<span id="cb58-835"><a href="#cb58-835"></a>&amp;=\frac{\alpha}{\Gamma(\alpha \mathrm{t})} \int_0^{\nu / \beta}\left<span class="co">[</span><span class="ot">\ln (\xi)-\frac{\Gamma^{\prime}(\alpha \mathrm{t})}{\Gamma(\alpha \mathrm{t})}\right</span><span class="co">]</span> \xi^{\alpha \mathrm{t}-1} \mathrm{e}^{-\xi} \mathrm{d} \xi.</span>
<span id="cb58-836"><a href="#cb58-836"></a>\end{aligned}</span>
<span id="cb58-837"><a href="#cb58-837"></a>$$</span>
<span id="cb58-838"><a href="#cb58-838"></a></span>
<span id="cb58-839"><a href="#cb58-839"></a>由于$\mathrm{f}_{\mathrm{T}}(\mathrm{t})$ 相当复杂，因此一般用B-S分布来逼近：</span>
<span id="cb58-840"><a href="#cb58-840"></a></span>
<span id="cb58-841"><a href="#cb58-841"></a>$$</span>
<span id="cb58-842"><a href="#cb58-842"></a>\mathrm{F}(t ; \ell)=\Phi\left<span class="co">[</span><span class="ot">\frac{1}{\mathrm{v}}\left(\sqrt{\frac{\mathrm{t}}{\mathrm{u}}}-\sqrt{\frac{\mathrm{u}}{\mathrm{t}}}\right)\right</span><span class="co">]</span>, \quad \mathrm{t}&gt;0</span>
<span id="cb58-843"><a href="#cb58-843"></a>$$ 其中, $\Phi(\cdot)$ 为标准正态分布, $v=\sqrt{\frac{\beta}{\ell}}, u=\frac{\ell}{\beta \alpha}$. 相应的 PDF 为 $$</span>
<span id="cb58-844"><a href="#cb58-844"></a>\mathrm{f}(t ; \ell)=\frac{1}{2 \sqrt{2 \pi} \mathrm{uv}}\left<span class="co">[</span><span class="ot">\left(\frac{\mathrm{u}}{\mathrm{t}}\right)^{\frac{1}{2}}+\left(\frac{\mathrm{u}}{\mathrm{t}}\right)^{\frac{3}{2}}\right</span><span class="co">]</span> \exp \left<span class="co">[</span><span class="ot">-\frac{1}{2 \mathrm{v}^2}\left(\frac{\mathrm{t}}{\mathrm{u}}-2+\frac{\mathrm{u}}{\mathrm{t}}\right)\right</span><span class="co">]</span>, \mathrm{t}&gt;0</span>
<span id="cb58-845"><a href="#cb58-845"></a>$$</span>
<span id="cb58-846"><a href="#cb58-846"></a></span>
<span id="cb58-847"><a href="#cb58-847"></a><span class="fu">#### 剩余寿命</span></span>
<span id="cb58-848"><a href="#cb58-848"></a></span>
<span id="cb58-849"><a href="#cb58-849"></a>根据Gamma 过程的增量独立性，可以得到剩余寿命的分布 $$</span>
<span id="cb58-850"><a href="#cb58-850"></a>\begin{aligned}</span>
<span id="cb58-851"><a href="#cb58-851"></a>\mathrm{F}(t \mid s) &amp;=\mathrm{P}\left(\mathrm{T} \leqslant t \mid \mathrm{X}(s)=\mathrm{x}_{s}\right) <span class="sc">\\</span></span>
<span id="cb58-852"><a href="#cb58-852"></a>&amp;=\mathrm{P}\left(X(t)-X(s) \geqslant \ell-x_{s}\right) <span class="sc">\\</span></span>
<span id="cb58-853"><a href="#cb58-853"></a>&amp;=\frac{\Gamma\left(\alpha(t-s),\left(\ell-x_{s}\right) / \beta\right)}{\Gamma(\alpha(t-s))} .</span>
<span id="cb58-854"><a href="#cb58-854"></a>\end{aligned}</span>
<span id="cb58-855"><a href="#cb58-855"></a>$$ 这与将失效阈值由 $\ell$ 变为 $\ell-{x_s}$ 、时间 $t$ 变为 $t-s$ 情形的寿命分 布是一样的. 因此, 在给定当前状态情况下, 可以按照类似的途径更新剩余寿命.</span>
<span id="cb58-856"><a href="#cb58-856"></a></span>
<span id="cb58-859"><a href="#cb58-859"></a><span class="in">```{r}</span></span>
<span id="cb58-860"><a href="#cb58-860"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-861"><a href="#cb58-861"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb58-862"><a href="#cb58-862"></a><span class="fu">library</span>(viridis)</span>
<span id="cb58-863"><a href="#cb58-863"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-864"><a href="#cb58-864"></a><span class="in">```</span></span>
<span id="cb58-865"><a href="#cb58-865"></a></span>
<span id="cb58-866"><a href="#cb58-866"></a><span class="fu">#### 数据模拟产生</span></span>
<span id="cb58-867"><a href="#cb58-867"></a></span>
<span id="cb58-870"><a href="#cb58-870"></a><span class="in">```{r}</span></span>
<span id="cb58-871"><a href="#cb58-871"></a><span class="co"># 数据模拟产生</span></span>
<span id="cb58-872"><a href="#cb58-872"></a>sim_dat <span class="ot">=</span> <span class="cf">function</span>(<span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">para =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)){</span>
<span id="cb58-873"><a href="#cb58-873"></a>  <span class="co"># para 指 alpha,beta</span></span>
<span id="cb58-874"><a href="#cb58-874"></a>  <span class="co"># epoch 指测量次数， group 指组数</span></span>
<span id="cb58-875"><a href="#cb58-875"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb58-876"><a href="#cb58-876"></a>  epoch <span class="ot">=</span> <span class="fu">length</span>(delta_t)</span>
<span id="cb58-877"><a href="#cb58-877"></a>  dat <span class="ot">=</span> dat_unit <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch,group<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb58-878"><a href="#cb58-878"></a>  dat[,<span class="dv">1</span>] <span class="ot">=</span> dat_unit[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,epoch)</span>
<span id="cb58-879"><a href="#cb58-879"></a>  <span class="co"># dat_unit = numeric()</span></span>
<span id="cb58-880"><a href="#cb58-880"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb58-881"><a href="#cb58-881"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epoch) {</span>
<span id="cb58-882"><a href="#cb58-882"></a>      dat_unit[j,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,para[<span class="dv">1</span>]<span class="sc">*</span>delta_t[j],para[<span class="dv">2</span>])</span>
<span id="cb58-883"><a href="#cb58-883"></a>      dat[,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">cumsum</span>(dat_unit[,i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb58-884"><a href="#cb58-884"></a>    }</span>
<span id="cb58-885"><a href="#cb58-885"></a>  }</span>
<span id="cb58-886"><a href="#cb58-886"></a>  dat <span class="ot">=</span> <span class="fu">data.frame</span>(dat)</span>
<span id="cb58-887"><a href="#cb58-887"></a>  dat1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb58-888"><a href="#cb58-888"></a>  <span class="fu">colnames</span>(dat1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb58-889"><a href="#cb58-889"></a>  </span>
<span id="cb58-890"><a href="#cb58-890"></a>  dat_unit <span class="ot">=</span> <span class="fu">data.frame</span>(dat_unit)</span>
<span id="cb58-891"><a href="#cb58-891"></a>  dat_unit1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,group<span class="sc">+</span><span class="dv">1</span>),dat_unit) <span class="co"># 加入初始值绘制点</span></span>
<span id="cb58-892"><a href="#cb58-892"></a>  <span class="fu">colnames</span>(dat_unit1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Time"</span>,<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group,<span class="at">sep=</span><span class="st">''</span>))</span>
<span id="cb58-893"><a href="#cb58-893"></a>  </span>
<span id="cb58-894"><a href="#cb58-894"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dat1,dat_unit1)) <span class="co">#dat1是退化量,data_unit1是退化增量</span></span>
<span id="cb58-895"><a href="#cb58-895"></a>}</span>
<span id="cb58-896"><a href="#cb58-896"></a><span class="in">```</span></span>
<span id="cb58-897"><a href="#cb58-897"></a></span>
<span id="cb58-898"><a href="#cb58-898"></a><span class="fu">##### 绘制退化路径图</span></span>
<span id="cb58-899"><a href="#cb58-899"></a></span>
<span id="cb58-902"><a href="#cb58-902"></a><span class="in">```{r}</span></span>
<span id="cb58-903"><a href="#cb58-903"></a><span class="co"># 绘制退化路径图</span></span>
<span id="cb58-904"><a href="#cb58-904"></a>plot_path <span class="ot">=</span> <span class="cf">function</span>(<span class="at">data =</span> dat1){</span>
<span id="cb58-905"><a href="#cb58-905"></a>    <span class="co"># 画图</span></span>
<span id="cb58-906"><a href="#cb58-906"></a>  p <span class="ot">=</span> data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>group), </span>
<span id="cb58-907"><a href="#cb58-907"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb58-908"><a href="#cb58-908"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-909"><a href="#cb58-909"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time,y,<span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb58-910"><a href="#cb58-910"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-911"><a href="#cb58-911"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span> </span>
<span id="cb58-912"><a href="#cb58-912"></a>    <span class="fu">ylab</span>(<span class="st">"Degradation"</span>) <span class="co">#+</span></span>
<span id="cb58-913"><a href="#cb58-913"></a>    <span class="co">#theme_bw() +</span></span>
<span id="cb58-914"><a href="#cb58-914"></a>    <span class="co">#theme(panel.grid = element_blank())</span></span>
<span id="cb58-915"><a href="#cb58-915"></a>  <span class="fu">print</span>(p)</span>
<span id="cb58-916"><a href="#cb58-916"></a>}</span>
<span id="cb58-917"><a href="#cb58-917"></a><span class="in">```</span></span>
<span id="cb58-918"><a href="#cb58-918"></a></span>
<span id="cb58-921"><a href="#cb58-921"></a><span class="in">```{r}</span></span>
<span id="cb58-922"><a href="#cb58-922"></a>group <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb58-923"><a href="#cb58-923"></a>t <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb58-924"><a href="#cb58-924"></a>para <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb58-925"><a href="#cb58-925"></a>dat <span class="ot">=</span> <span class="fu">sim_dat</span>(<span class="at">group =</span> group, <span class="at">t =</span> t, <span class="at">para =</span> para)</span>
<span id="cb58-926"><a href="#cb58-926"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat[[<span class="dv">1</span>]])) <span class="co">#print table</span></span>
<span id="cb58-927"><a href="#cb58-927"></a><span class="fu">plot_path</span>(dat[[<span class="dv">1</span>]]) <span class="co">#print path plot</span></span>
<span id="cb58-928"><a href="#cb58-928"></a><span class="in">```</span></span>
<span id="cb58-929"><a href="#cb58-929"></a></span>
<span id="cb58-930"><a href="#cb58-930"></a><span class="fu">#### 参数估计</span></span>
<span id="cb58-931"><a href="#cb58-931"></a></span>
<span id="cb58-932"><a href="#cb58-932"></a><span class="fu">##### 矩估计</span></span>
<span id="cb58-933"><a href="#cb58-933"></a></span>
<span id="cb58-936"><a href="#cb58-936"></a><span class="in">```{r}</span></span>
<span id="cb58-937"><a href="#cb58-937"></a>gamma_moment <span class="ot">=</span> <span class="cf">function</span>(data_unit, group , t ){</span>
<span id="cb58-938"><a href="#cb58-938"></a></span>
<span id="cb58-939"><a href="#cb58-939"></a>  <span class="co"># 每组测量次数相同</span></span>
<span id="cb58-940"><a href="#cb58-940"></a>  delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb58-941"><a href="#cb58-941"></a>  M <span class="ot">=</span> group<span class="sc">*</span><span class="fu">max</span>(t)</span>
<span id="cb58-942"><a href="#cb58-942"></a>  Rij <span class="ot">=</span> data_unit<span class="sc">/</span>delta_t</span>
<span id="cb58-943"><a href="#cb58-943"></a>  Rbar <span class="ot">=</span> <span class="fu">sum</span>(Rij)<span class="sc">/</span>M</span>
<span id="cb58-944"><a href="#cb58-944"></a>  MSR2 <span class="ot">=</span> <span class="fu">sum</span>((Rij<span class="sc">-</span>Rbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb58-945"><a href="#cb58-945"></a>  tt <span class="ot">=</span> group<span class="sc">*</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>delta_t)</span>
<span id="cb58-946"><a href="#cb58-946"></a>  moment_alp <span class="ot">=</span> Rbar<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>tt<span class="sc">/</span>MSR2</span>
<span id="cb58-947"><a href="#cb58-947"></a>  moment_beta <span class="ot">=</span> MSR2<span class="sc">/</span>(tt<span class="sc">*</span>Rbar)</span>
<span id="cb58-948"><a href="#cb58-948"></a>  </span>
<span id="cb58-949"><a href="#cb58-949"></a>  moment_par <span class="ot">=</span> <span class="fu">c</span>(moment_alp,moment_beta)</span>
<span id="cb58-950"><a href="#cb58-950"></a>  <span class="fu">return</span>(moment_par)</span>
<span id="cb58-951"><a href="#cb58-951"></a>  </span>
<span id="cb58-952"><a href="#cb58-952"></a>}</span>
<span id="cb58-953"><a href="#cb58-953"></a><span class="co"># 这里算出来beta的矩估计跟真值差距很大</span></span>
<span id="cb58-954"><a href="#cb58-954"></a><span class="co"># 注意如果用模拟数据产生的话，只保留增量数据,也要去掉第一行的0</span></span>
<span id="cb58-955"><a href="#cb58-955"></a><span class="co"># ？ 前面加上这么多只是为了画图好看，是不是可以删掉这些东西</span></span>
<span id="cb58-956"><a href="#cb58-956"></a>increment <span class="ot">=</span> dat[[<span class="dv">2</span>]]</span>
<span id="cb58-957"><a href="#cb58-957"></a>increment <span class="ot">=</span> increment[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb58-958"><a href="#cb58-958"></a>degradation <span class="ot">=</span> dat[[<span class="dv">1</span>]]</span>
<span id="cb58-959"><a href="#cb58-959"></a>degradation <span class="ot">=</span> degradation[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb58-960"><a href="#cb58-960"></a>  </span>
<span id="cb58-961"><a href="#cb58-961"></a>moment_par <span class="ot">=</span> <span class="fu">gamma_moment</span>(<span class="at">data_unit =</span> increment, <span class="at">group =</span> <span class="dv">6</span>, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb58-962"><a href="#cb58-962"></a>moment_par</span>
<span id="cb58-963"><a href="#cb58-963"></a></span>
<span id="cb58-964"><a href="#cb58-964"></a><span class="in">```</span></span>
<span id="cb58-965"><a href="#cb58-965"></a></span>
<span id="cb58-966"><a href="#cb58-966"></a><span class="fu">##### 极大似然估计</span></span>
<span id="cb58-967"><a href="#cb58-967"></a></span>
<span id="cb58-970"><a href="#cb58-970"></a><span class="in">```{r}</span></span>
<span id="cb58-971"><a href="#cb58-971"></a><span class="fu">library</span>(BB)</span>
<span id="cb58-972"><a href="#cb58-972"></a></span>
<span id="cb58-973"><a href="#cb58-973"></a>gamma_alpmle <span class="ot">=</span> <span class="cf">function</span>(x, data_unit, data, t){</span>
<span id="cb58-974"><a href="#cb58-974"></a>    <span class="co">#x is alpha</span></span>
<span id="cb58-975"><a href="#cb58-975"></a>    delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb58-976"><a href="#cb58-976"></a>    l <span class="ot">=</span> <span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">log</span>(data_unit))<span class="sc">-</span><span class="fu">sum</span>(t<span class="sc">*</span><span class="fu">log</span>(data<span class="sc">/</span>(x<span class="sc">*</span>t)))<span class="sc">-</span><span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">digamma</span>(x<span class="sc">*</span>delta_t))</span>
<span id="cb58-977"><a href="#cb58-977"></a>    <span class="fu">return</span>(l)</span>
<span id="cb58-978"><a href="#cb58-978"></a>}</span>
<span id="cb58-979"><a href="#cb58-979"></a></span>
<span id="cb58-980"><a href="#cb58-980"></a>startx <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb58-981"><a href="#cb58-981"></a>mle_re <span class="ot">=</span> <span class="fu">dfsane</span>(startx,gamma_alpmle,<span class="at">data_unit =</span> increment, <span class="at">data =</span> degradation, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span><span class="dv">2500</span>,<span class="at">trace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb58-982"><a href="#cb58-982"></a></span>
<span id="cb58-983"><a href="#cb58-983"></a>mle_re</span>
<span id="cb58-984"><a href="#cb58-984"></a>mle_alp <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb58-985"><a href="#cb58-985"></a>mle_beta <span class="ot">=</span> <span class="fu">sum</span>(increment)<span class="sc">/</span>(mle_alp<span class="sc">*</span>group<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb58-986"><a href="#cb58-986"></a>mle_par <span class="ot">=</span> <span class="fu">c</span>(mle_alp,mle_beta)</span>
<span id="cb58-987"><a href="#cb58-987"></a></span>
<span id="cb58-988"><a href="#cb58-988"></a></span>
<span id="cb58-989"><a href="#cb58-989"></a><span class="co"># mle_re = uniroot(gamma_alpmle, data_unit = increment, data = degradation, t = 1:200, lower = 1, upper = 100, tol = 1e-15, maxiter = 10000)</span></span>
<span id="cb58-990"><a href="#cb58-990"></a><span class="co"># </span></span>
<span id="cb58-991"><a href="#cb58-991"></a><span class="co"># mle_alp = mle_re$root</span></span>
<span id="cb58-992"><a href="#cb58-992"></a><span class="co"># mle_beta = sum(increment)/(mle_alp*group*max(t))</span></span>
<span id="cb58-993"><a href="#cb58-993"></a><span class="co"># mle_par = c(mle_alp,mle_beta)</span></span>
<span id="cb58-994"><a href="#cb58-994"></a></span>
<span id="cb58-995"><a href="#cb58-995"></a><span class="in">```</span></span>
<span id="cb58-996"><a href="#cb58-996"></a></span>
<span id="cb58-999"><a href="#cb58-999"></a><span class="in">```{r}</span></span>
<span id="cb58-1000"><a href="#cb58-1000"></a><span class="do">## 可靠度计算</span></span>
<span id="cb58-1001"><a href="#cb58-1001"></a>gamma_R <span class="ot">=</span> <span class="cf">function</span>(t, threshold,par){</span>
<span id="cb58-1002"><a href="#cb58-1002"></a>  alp <span class="ot">=</span> par[<span class="dv">1</span>]</span>
<span id="cb58-1003"><a href="#cb58-1003"></a>  beta <span class="ot">=</span> par[<span class="dv">2</span>]</span>
<span id="cb58-1004"><a href="#cb58-1004"></a>  v <span class="ot">=</span> <span class="fu">sqrt</span>(beta<span class="sc">/</span>threshold)</span>
<span id="cb58-1005"><a href="#cb58-1005"></a>  u <span class="ot">=</span> threshold<span class="sc">/</span>(alp<span class="sc">*</span>beta)</span>
<span id="cb58-1006"><a href="#cb58-1006"></a>  R <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>((<span class="fu">sqrt</span>(t<span class="sc">/</span>u)<span class="sc">-</span><span class="fu">sqrt</span>(u<span class="sc">/</span>t))<span class="sc">/</span>v) </span>
<span id="cb58-1007"><a href="#cb58-1007"></a>  <span class="fu">return</span>(R)</span>
<span id="cb58-1008"><a href="#cb58-1008"></a>}</span>
<span id="cb58-1009"><a href="#cb58-1009"></a><span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="dv">70</span>, <span class="at">threshold =</span> <span class="dv">150</span>,<span class="at">par =</span> mle_par)</span>
<span id="cb58-1010"><a href="#cb58-1010"></a></span>
<span id="cb58-1011"><a href="#cb58-1011"></a><span class="co"># plot(gamma_R(t = 1:300, threshold = 150,par = mle_par),type = "l")</span></span>
<span id="cb58-1012"><a href="#cb58-1012"></a><span class="in">```</span></span>
<span id="cb58-1013"><a href="#cb58-1013"></a></span>
<span id="cb58-1014"><a href="#cb58-1014"></a><span class="fu">### 4.2 案例分析</span></span>
<span id="cb58-1015"><a href="#cb58-1015"></a></span>
<span id="cb58-1016"><a href="#cb58-1016"></a>导入数据，数据来源于<span class="co">[</span><span class="ot">NASA Ames Prognostics Center of Excellence (PCoE)</span><span class="co">](https://c3.ndc.nasa.gov/dashlink/resources/133/)</span>，但是找不到数据下载。最后是通过 <span class="co">[</span><span class="ot">Github</span><span class="co">](https://github.com/psanabriaUC/BatteryDatasetImplementation)</span> 获得。</span>
<span id="cb58-1017"><a href="#cb58-1017"></a></span>
<span id="cb58-1020"><a href="#cb58-1020"></a><span class="in">```{r}</span></span>
<span id="cb58-1021"><a href="#cb58-1021"></a>liion_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"dataset/li-ion_battery_aging.csv"</span>)</span>
<span id="cb58-1022"><a href="#cb58-1022"></a><span class="fu">head</span>(liion_data)</span>
<span id="cb58-1023"><a href="#cb58-1023"></a><span class="in">```</span></span>
<span id="cb58-1024"><a href="#cb58-1024"></a></span>
<span id="cb58-1025"><a href="#cb58-1025"></a>该数据是 NASA Ames Prognostics Center of Fxcellence (PCoF）对商用锂离子 18650 电池进行充、放电试验获得的一组蓄电池容量变化数据。试验过程中，锂离子在室温下 经历 3 种不同的运行剖面，即**充电**、**放电**和**测量 EIS**。</span>
<span id="cb58-1026"><a href="#cb58-1026"></a></span>
<span id="cb58-1027"><a href="#cb58-1027"></a>充电是以**恒流模**式(CC)进行，在 1.5A 电流下直到电池电压达到4.2V，然后以**恒压模式**(CV)继续充电直到电流降到 20mA。</span>
<span id="cb58-1028"><a href="#cb58-1028"></a></span>
<span id="cb58-1029"><a href="#cb58-1029"></a>放电也以恒流模式进行，放电电流为2A，直到电池电压降低到2.7V。</span>
<span id="cb58-1030"><a href="#cb58-1030"></a></span>
<span id="cb58-1031"><a href="#cb58-1031"></a>重复充电和放电降导致蓄电池老化。对应的四个产品电池容量变化如下图所示：</span>
<span id="cb58-1032"><a href="#cb58-1032"></a></span>
<span id="cb58-1035"><a href="#cb58-1035"></a><span class="in">```{r}</span></span>
<span id="cb58-1036"><a href="#cb58-1036"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb58-1037"><a href="#cb58-1037"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb58-1038"><a href="#cb58-1038"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-1039"><a href="#cb58-1039"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-1040"><a href="#cb58-1040"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="co">#+</span></span>
<span id="cb58-1041"><a href="#cb58-1041"></a>  <span class="co">#theme_bw() + theme(panel.grid = element_blank())</span></span>
<span id="cb58-1042"><a href="#cb58-1042"></a><span class="in">```</span></span>
<span id="cb58-1043"><a href="#cb58-1043"></a></span>
<span id="cb58-1044"><a href="#cb58-1044"></a>我们直接使用充放电循环次数作为时间刻度。由于随着时间的推移，电池容量呈下降趋势。而用Gamma来进行 RUL 预测方法是建立在退化过程有增加趋势的基础上的。为了应用该模型，对原始数据进行转换：用初始容量减去每个电池的所有容量数据。此时，失效阈值更改为初始容量减去 1.4 Ahr。</span>
<span id="cb58-1045"><a href="#cb58-1045"></a></span>
<span id="cb58-1048"><a href="#cb58-1048"></a><span class="in">```{r}</span></span>
<span id="cb58-1049"><a href="#cb58-1049"></a>max_battery <span class="ot">=</span> <span class="fu">aggregate</span>(liion_data<span class="sc">$</span>Capacity,<span class="at">by =</span> <span class="fu">list</span>(liion_data<span class="sc">$</span>Battery),max)</span>
<span id="cb58-1050"><a href="#cb58-1050"></a>max_battery<span class="sc">$</span>threshold <span class="ot">=</span> max_battery<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">1.4</span></span>
<span id="cb58-1051"><a href="#cb58-1051"></a></span>
<span id="cb58-1052"><a href="#cb58-1052"></a>liion_data<span class="sc">$</span>Capacity_new <span class="ot">=</span> <span class="sc">-</span>liion_data<span class="sc">$</span>Capacity <span class="sc">+</span> <span class="fu">rep</span>(max_battery[,<span class="dv">2</span>],<span class="fu">as.numeric</span>(<span class="fu">table</span>(liion_data<span class="sc">$</span>Battery)))</span>
<span id="cb58-1053"><a href="#cb58-1053"></a></span>
<span id="cb58-1054"><a href="#cb58-1054"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb58-1055"><a href="#cb58-1055"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(id_cycle,Capacity_new,<span class="at">color =</span> Battery)) <span class="sc">+</span> </span>
<span id="cb58-1056"><a href="#cb58-1056"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-1057"><a href="#cb58-1057"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-1058"><a href="#cb58-1058"></a>  <span class="fu">xlab</span>(<span class="st">"Cycle"</span>) <span class="sc">+</span></span>
<span id="cb58-1059"><a href="#cb58-1059"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb58-1060"><a href="#cb58-1060"></a>  <span class="co">#theme(panel.grid = element_blank()) + #添加失效阈值</span></span>
<span id="cb58-1061"><a href="#cb58-1061"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-1062"><a href="#cb58-1062"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-1063"><a href="#cb58-1063"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">3</span>],<span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-1064"><a href="#cb58-1064"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_battery<span class="sc">$</span>threshold[<span class="dv">4</span>],<span class="at">lty =</span> <span class="dv">2</span>) </span>
<span id="cb58-1065"><a href="#cb58-1065"></a><span class="in">```</span></span>
<span id="cb58-1066"><a href="#cb58-1066"></a></span>
<span id="cb58-1067"><a href="#cb58-1067"></a>前面对数据进行了导入、处理以及可视化。接下来，使用经典的Gamma过程对其进行建模。</span>
<span id="cb58-1068"><a href="#cb58-1068"></a></span>
<span id="cb58-1071"><a href="#cb58-1071"></a><span class="in">```{r}</span></span>
<span id="cb58-1072"><a href="#cb58-1072"></a>liion_data <span class="sc">%&gt;%</span> </span>
<span id="cb58-1073"><a href="#cb58-1073"></a>  <span class="fu">select</span>(Capacity_new,Battery,id_cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb58-1074"><a href="#cb58-1074"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb58-1075"><a href="#cb58-1075"></a>    <span class="at">names_from =</span> <span class="st">"Battery"</span>,</span>
<span id="cb58-1076"><a href="#cb58-1076"></a>    <span class="at">values_from =</span> <span class="st">"Capacity_new"</span>,</span>
<span id="cb58-1077"><a href="#cb58-1077"></a>    <span class="at">values_fn =</span> mean) <span class="ot">-&gt;</span> liion_new</span>
<span id="cb58-1078"><a href="#cb58-1078"></a><span class="in">```</span></span>
<span id="cb58-1079"><a href="#cb58-1079"></a></span>
<span id="cb58-1082"><a href="#cb58-1082"></a><span class="in">```{r}</span></span>
<span id="cb58-1083"><a href="#cb58-1083"></a><span class="fu">library</span>(BB)</span>
<span id="cb58-1084"><a href="#cb58-1084"></a>gamma_alpmle <span class="ot">=</span> <span class="cf">function</span>(x, data_unit, data, t){</span>
<span id="cb58-1085"><a href="#cb58-1085"></a>    <span class="co">#x is alpha</span></span>
<span id="cb58-1086"><a href="#cb58-1086"></a>    delta_t <span class="ot">=</span> <span class="fu">diff</span>(t)</span>
<span id="cb58-1087"><a href="#cb58-1087"></a>    l <span class="ot">=</span> <span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">log</span>(data_unit))<span class="sc">-</span><span class="fu">sum</span>(t<span class="sc">*</span><span class="fu">log</span>(data<span class="sc">/</span>(x<span class="sc">*</span>t)))<span class="sc">-</span><span class="fu">sum</span>(delta_t<span class="sc">*</span><span class="fu">digamma</span>(x<span class="sc">*</span>delta_t))</span>
<span id="cb58-1088"><a href="#cb58-1088"></a>    <span class="fu">return</span>(l)</span>
<span id="cb58-1089"><a href="#cb58-1089"></a>}</span>
<span id="cb58-1090"><a href="#cb58-1090"></a></span>
<span id="cb58-1091"><a href="#cb58-1091"></a>degradation <span class="ot">=</span> liion_new[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb58-1092"><a href="#cb58-1092"></a>group <span class="ot">=</span> <span class="fu">ncol</span>(degradation)</span>
<span id="cb58-1093"><a href="#cb58-1093"></a>epoch <span class="ot">=</span> <span class="fu">nrow</span>(degradation)</span>
<span id="cb58-1094"><a href="#cb58-1094"></a>increment <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,epoch<span class="dv">-1</span>,group)</span>
<span id="cb58-1095"><a href="#cb58-1095"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>group){</span>
<span id="cb58-1096"><a href="#cb58-1096"></a>  dd <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(degradation[,i]))</span>
<span id="cb58-1097"><a href="#cb58-1097"></a>  increment[,i] <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">diff</span>(dd))</span>
<span id="cb58-1098"><a href="#cb58-1098"></a>}</span>
<span id="cb58-1099"><a href="#cb58-1099"></a></span>
<span id="cb58-1100"><a href="#cb58-1100"></a><span class="co"># 这里跟初值影响很大</span></span>
<span id="cb58-1101"><a href="#cb58-1101"></a>startx <span class="ot">=</span> <span class="fl">1.2</span></span>
<span id="cb58-1102"><a href="#cb58-1102"></a>mle_re <span class="ot">=</span> <span class="fu">dfsane</span>(startx,gamma_alpmle,<span class="at">data_unit =</span> increment, <span class="at">data =</span> degradation, <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>epoch, <span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span><span class="dv">2500</span>,<span class="at">trace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb58-1103"><a href="#cb58-1103"></a></span>
<span id="cb58-1104"><a href="#cb58-1104"></a>mle_alp <span class="ot">=</span> mle_re<span class="sc">$</span>par</span>
<span id="cb58-1105"><a href="#cb58-1105"></a>mle_beta <span class="ot">=</span> <span class="fu">sum</span>(increment)<span class="sc">/</span>(mle_alp<span class="sc">*</span>group<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb58-1106"><a href="#cb58-1106"></a>mle_par <span class="ot">=</span> <span class="fu">c</span>(mle_alp,mle_beta)</span>
<span id="cb58-1107"><a href="#cb58-1107"></a></span>
<span id="cb58-1108"><a href="#cb58-1108"></a></span>
<span id="cb58-1109"><a href="#cb58-1109"></a><span class="co">#这里要先试出这个函数的上下界，并且增量不应该出现复数</span></span>
<span id="cb58-1110"><a href="#cb58-1110"></a><span class="co"># gamma_alpmle(1, data_unit = increment, data = degradation, t = 1:epoch)</span></span>
<span id="cb58-1111"><a href="#cb58-1111"></a></span>
<span id="cb58-1112"><a href="#cb58-1112"></a><span class="co"># mle_re = uniroot(gamma_alpmle, data_unit = increment, data = degradation, t = 1:epoch, lower = 0.0000001, upper = 100, tol = 1e-15, maxiter = 10000)</span></span>
<span id="cb58-1113"><a href="#cb58-1113"></a><span class="co"># </span></span>
<span id="cb58-1114"><a href="#cb58-1114"></a><span class="co"># mle_alp = mle_re$root</span></span>
<span id="cb58-1115"><a href="#cb58-1115"></a><span class="co"># mle_beta = sum(increment)/(mle_alp*group*max(t))</span></span>
<span id="cb58-1116"><a href="#cb58-1116"></a><span class="co"># mle_par = c(mle_alp,mle_beta)</span></span>
<span id="cb58-1117"><a href="#cb58-1117"></a></span>
<span id="cb58-1118"><a href="#cb58-1118"></a></span>
<span id="cb58-1119"><a href="#cb58-1119"></a><span class="in">```</span></span>
<span id="cb58-1120"><a href="#cb58-1120"></a></span>
<span id="cb58-1121"><a href="#cb58-1121"></a>计算可靠度并绘图</span>
<span id="cb58-1122"><a href="#cb58-1122"></a></span>
<span id="cb58-1125"><a href="#cb58-1125"></a><span class="in">```{r}</span></span>
<span id="cb58-1126"><a href="#cb58-1126"></a><span class="co"># 计算可靠度</span></span>
<span id="cb58-1127"><a href="#cb58-1127"></a><span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="fl">0.05</span>, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold, <span class="at">par =</span> mle_par)</span>
<span id="cb58-1128"><a href="#cb58-1128"></a>time_region <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb58-1129"><a href="#cb58-1129"></a><span class="co"># 绘制四个电池的可靠度图</span></span>
<span id="cb58-1130"><a href="#cb58-1130"></a>R_re <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,time_region,<span class="dv">4</span>)</span>
<span id="cb58-1131"><a href="#cb58-1131"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb58-1132"><a href="#cb58-1132"></a>  R_re[,i] <span class="ot">=</span> <span class="fu">gamma_R</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>time_region, <span class="at">threshold =</span> max_battery<span class="sc">$</span>threshold[i],<span class="at">par =</span> mle_par)</span>
<span id="cb58-1133"><a href="#cb58-1133"></a>}</span>
<span id="cb58-1134"><a href="#cb58-1134"></a>R_re <span class="ot">=</span> <span class="fu">as.data.frame</span>(R_re)</span>
<span id="cb58-1135"><a href="#cb58-1135"></a>R_re <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>time_region,R_re)</span>
<span id="cb58-1136"><a href="#cb58-1136"></a><span class="fu">colnames</span>(R_re) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"time"</span>,max_battery[,<span class="dv">1</span>])</span>
<span id="cb58-1137"><a href="#cb58-1137"></a>R_re <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(max_battery[,<span class="dv">1</span>], </span>
<span id="cb58-1138"><a href="#cb58-1138"></a>                       <span class="at">names_to =</span> <span class="st">"Group"</span>, </span>
<span id="cb58-1139"><a href="#cb58-1139"></a>                       <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-1140"><a href="#cb58-1140"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time,y,<span class="at">color =</span> Group,<span class="at">shape =</span> Group)) <span class="sc">+</span></span>
<span id="cb58-1141"><a href="#cb58-1141"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb58-1142"><a href="#cb58-1142"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> T) <span class="sc">+</span></span>
<span id="cb58-1143"><a href="#cb58-1143"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Reliability"</span>)</span>
<span id="cb58-1144"><a href="#cb58-1144"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>